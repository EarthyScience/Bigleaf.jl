var documenterSearchIndex = {"docs":
[{"location":"metorological_variables/#Meteorological-variables","page":"-","title":"Meteorological variables","text":"","category":"section"},{"location":"metorological_variables/","page":"-","title":"-","text":"Pages = [\"metorological_variables.md\",]","category":"page"},{"location":"metorological_variables/","page":"-","title":"-","text":"latent_heat_vaporization\nvirtual_temp\nEsat_from_Tair\nair_density\npressure_from_elevation\npsychrometric_constant\nkinematic_viscosity\ndew_point\nwetbulb_temp","category":"page"},{"location":"metorological_variables/#Bigleaf.latent_heat_vaporization","page":"-","title":"Bigleaf.latent_heat_vaporization","text":"latent_heat_vaporization(Tair)\n\nLatent heat of vaporization as a function of air temperature using \n\nlambda = (2501 - 000237  Tair) 10^6.\n\nArguments:\n\nTair:  Air temperature (deg C)\n\nValue\n\nlambda: Latent heat of vaporization (J kg-1) \n\nReferences\n\nStull, B, 1988: An Introduction to Boundary Layer Meteorology (p641)           Kluwer Academic Publishers, Dordrecht, Netherlands            \nFoken, T, 2008: Micrometeorology_ Springer, Berlin, Germany\n\nlatent_heat_vaporization.(5:5:45)        \n\n\n\n\n\n","category":"function"},{"location":"metorological_variables/#Bigleaf.virtual_temp","page":"-","title":"Bigleaf.virtual_temp","text":"virtual_temp(Tair,pressure,VPD; ...)\n\nVirtual temperature, defined as the temperature at which dry air would have the same              density as moist air at its actual temperature.\n\nArguments\n\nTair:      Air temperature (deg C)\npressure:  Atmospheric pressure (kPa)\nVPD:       Vapor pressure deficit (kPa)\nEsat_formula: formula used in Esat_from_Tair\n\noptional \n\nconstants=bigleaf_constants(): Dictionary with entries \n:Kelvin - conversion degree Celsius to Kelvin\n:eps - ratio of the molecular weight of water vapor to dry air (-) \n\nDetails\n\nThe virtual temperature is given by:\n\nTv = Tair / (1 - (1 - eps) e/pressure)\n\nwhere Tair is in Kelvin (converted internally)_ Likewise, VPD is converted   to actual vapor pressure (e in kPa) with VPD_to_e internally.\n\nValue\n\nvirtual temperature (deg C)\n\nReferences\n\nMonteith J.L., Unsworth M.H., 2008: Principles of Environmental Physics.           3rd edition. Academic Press, London.\n\nExamples\n\nTair,pressure,VPD = 25,100,1.5\nvt = virtual_temp(Tair,pressure,VPD)  \n≈(vt, 26.9, atol =0.1)\n\n\n\n\n\n","category":"function"},{"location":"metorological_variables/#Bigleaf.Esat_from_Tair","page":"-","title":"Bigleaf.Esat_from_Tair","text":"Esat_slope(Tair; formula, constants) \nEsat_from_Tair(Tair; formula, constants) \nEsat_from_Tair_deriv(Tair; formula, constants)\n\nSaturation Vapor Pressure (Esat) and Slope of the Esat Curve\n\nArguemtns\n\nTair:      Air temperature (deg C)\nformula=Val(:Sonntag_1990):   Formula to be used. Either   Val(:Sonntag_1990) (Default), Val(:Alduchov_1996, or Val(:Allen_1998).\nconstants=bigleaf_constants(): Dictionary with entry  :Pa2kPa \n\nDetails\n\nEsat (kPa) is calculated using the Magnus equation:\n\nEsat = a * exp((b * Tair) / (c + Tair)) / 1000 where the coefficients a, b, c take different values depending on the formula use The default values are from Sonntag 1990 (a=611.2, b=17.62, c=243.12). This versi of the Magnus equation is recommended by the WMO (WMO 2008; p1.4-29). Alternativel parameter values determined by Alduchov & Eskridge 1996 or Allen et al. 1998 can b used (see references). The slope of the Esat curve (Delta) is calculated as the first derivative of the function:\n\nDelta = dEsat over dTair\n\nValue\n\nEsat_from_Tair: Saturation vapor pressure (kPa)\nEsat_from_Tair_deriv: Slope of the saturation vapor pressure curve (kPa K-1)\nEsat_slope: A tuple of the two above values\n\nReferences\n\nSonntag D. 1990: Important new values of the physical constants of 1986, vapor  pressure formulations based on the ITS-90 and psychrometric formulae.  Zeitschrift fuer Meteorologie 70, 340-344.\n\nWorld Meteorological Organization 2008: Guide to Meteorological Instruments and Methods of Observation (WMO-No.8). World Meteorological Organization, Geneva. 7th Edition,\n\nAlduchov, O. A. & Eskridge, R. E., 1996: Improved Magnus form approximation of  saturation vapor pressure. Journal of Applied Meteorology, 35, 601-609\n\nAllen, R.G., Pereira, L.S., Raes, D., Smith, M., 1998: Crop evapotranspiration - Guidelines for computing crop water requirements - FAO irrigation and drainage paper 56, FAO, Rome.\n\nEsat_from_Tair(20.0)          # Esat in kPa\nEsat_from_Tair_deriv(20.0)    # its derivative to temperature in kPa K-1\nEsat_slope(20.0)              # both as a tuple\n\n\n\n\n\n","category":"function"},{"location":"metorological_variables/#Bigleaf.air_density","page":"-","title":"Bigleaf.air_density","text":"air_density(Tair,pressure; ...)\n\nAir density of moist air from air temperature and pressure_\n\nArguments\n\nTair:      Air temperature (deg C)\npressure:  Atmospheric pressure (kPa)\n\noptional \n\nconstants=bigleaf_constants(): Dictionary with entries   Kelvin, kPa2Pa\n\nDetails\n\nAir density rho is calculated as:\n\nrho = pressure over Rd * Tair\n\nValue\n\nair density (kg m-3)\n\nExamples\n\n# air density at 25degC and standard pressure (101.325kPa)\nair_density(25,101.325)\n\nReferences\n\nFoken, T, 2008: Micrometeorology. Springer, Berlin, Germany.\n\n\n\n\n\n","category":"function"},{"location":"metorological_variables/#Bigleaf.pressure_from_elevation","page":"-","title":"Bigleaf.pressure_from_elevation","text":"pressure_from_elevation(elev,Tair,VPD=missing;...)\n\nAn estimate of mean pressure at a given elevation as predicted by the              hypsometric equation.\n\nArguments\n\nelev:      Elevation asl_ (m)\nTair:      Air temperature (deg C)\nVPD:       Vapor pressure deficit (kPa); optional\n\noptional \n\nconstants=bigleaf_constants(): Dictionary with entries    Kelvin, pressure0, Rd, g, Pa2kPa\n\nDetails\n\nAtmospheric pressure is approximated by the hypsometric equation:\n\npressure = pressure_0  (exp(g * elevation  (Rd Temp)))\n\nThe hypsometric equation gives an estimate of the standard pressure       at a given altitude.       If VPD is provided, humidity correction is applied and the       virtual temperature instead of air temperature is used_ VPD is        internally converted to specific humidity.\n\nValue\n\nAtmospheric pressure (kPa)\n\nReferences\n\nStull B_, 1988: An Introduction to Boundary Layer Meteorology.             Kluwer Academic Publishers, Dordrecht, Netherlands.\n\nExamples\n\n# mean pressure at 500m altitude at 25 deg C and VPD of 1 kPa\npressure_from_elevation(500,25,1)\n\n\n\n\n\n","category":"function"},{"location":"metorological_variables/#Bigleaf.psychrometric_constant","page":"-","title":"Bigleaf.psychrometric_constant","text":"psychrometric_constant(Tair,pressure; ...)\n\nComputes the psychrometric 'constant'.\n\nArgumens\n\nTair:      Air temperature (deg C)\npressure:  Atmospheric pressure (kPa)\n\noptional \n\nconstants=bigleaf_constants(): Dictionary with entries    cp, eps\n\nDetails\n\nThe psychrometric constant (gamma) is given as:\n\ngamma = cp * pressure  (eps * lambda)\n\nwhere lambda is the latent heat of vaporization (J kg-1),   as calculated from latent_heat_vaporization.\n\nValue\n\nthe psychrometric constant (kPa K-1)\n\nReferences\n\nMonteith J.L., Unsworth M.H., 2008: Principles of Environmental Physics.             3rd Edition. Academic Press, London.\n\nExamples\n\npsychrometric_constant.(5.0:5.0:25.0, 100)\n\n\n\n\n\n","category":"function"},{"location":"metorological_variables/#Bigleaf.kinematic_viscosity","page":"-","title":"Bigleaf.kinematic_viscosity","text":"kinematic_viscosity(Tair,pressure; ...)\n\nCalculate the kinematic viscosity of air.\n\nParameters\n\nTair      Air temperature (deg C)\npressure  Atmospheric pressure (kPa)\n\noptional \n\nconstants=bigleaf_constants(): Dictionary with entries    Kelvin, pressure0, Tair0, kPa2Pa\n\nDetails\n\nEq where v is the kinematic viscosity of the air (m2 s-1),           given by (Massman 1999b):\n\nv = 1327 * 10^-5(pressure0pressure)(TairTair0)^181\n\nValue\n\nkinematic viscosity of air (m2 s-1)\n\nReferences\n\nMassman, W.J., 1999b: Molecular diffusivities of Hg vapor in air,              O2 and N2 near STP and the kinematic viscosity and thermal diffusivity             of air near STP. Atmospheric Environment 33, 453-457.      \n\nExamples\n\nTair,pressure = 25,100\nvis = kinematic_viscosity(Tair,pressure)\n≈(vis, 1.58e-5, atol =1e-7)\n\n\n\n\n\n","category":"function"},{"location":"metorological_variables/#Bigleaf.dew_point","page":"-","title":"Bigleaf.dew_point","text":"dew_point(Tair,VPD; ...)\ndew_point_from_e(ea; ...)\n\nCalculate the dew point, the temperature to which air must be               cooled to become saturated (ie e = Esat(Td))\n\nArguments\n\nTair:     Air temperature (degC)\nVPD:      Vapor pressure deficit (kPa)\nea:       actual water vapor pressure (kPa)\n\noptional\n\naccuracy = 1e-03: Accuracy of the result (deg C)\nEsat_formula: formula used in Esat_from_Tair\nconstants=bigleaf_constants(): Dictionary with entries    Pa2kPa \n\nDetails\n\nDew point temperature (Td) is defined by the temperature for which saturaed vapour pressure equals current vapour pressure, i.e. below which  water would start to condensate.\n\ne = Esat(Td)\n\nwhere e is vapor pressure of the air and Esat is the vapor pressure deficit.          This equation is solved for Td by optimization.\n\nValue\n\ndew point temperature (degC)\n\nReferences\n\nMonteith J.L., Unsworth M.H., 2008: Principles of Environmental Physics.             3rd edition. Academic Press, London.\n\nExamples\n\nTair = 20.0\nVPD = 1.5\nTd = dew_point(Tair, VPD; accuracy = 1e-2)                \n(e = VPD_to_e(VPD,Tair), esat_Td = Esat_from_Tair(Td))\n\n\n\n\n\n","category":"function"},{"location":"metorological_variables/#Bigleaf.wetbulb_temp","page":"-","title":"Bigleaf.wetbulb_temp","text":"wetbulb_temp(Tair, pressure, VPD; ...)\n\nCalculate the wet bulb temperature, ie the temperature              that the air would have if it was saturated\n\nArguments\n\nTair:      Air temperature (deg C)\npressure:  Atmospheric pressure (kPa)\nVPD:       Vapor pressure deficit (kPa)\n\noptional\n\naccuracy:  Accuracy of the result (deg C)\nEsat_formula: formula used in Esat_from_Tair\nconstants=bigleaf_constants(): Dictionary with entries     cp, eps,Pa2kPa\n\nDetails\n\nWet-bulb temperature (Tw) is calculated from the following expression:\n\ne = Esat(Tw) - gamma* (Tair - Tw)\n\nThe equation is optimized for Tw. Actual vapor pressure e (kPa) is calculated from VPD using VPD_to_e. The psychrometric constant gamma (kPa K-1) is calculated using psychrometric_constant.\n\nValue\n\nwet-bulb temperature (degC)\n\nReferences\n\nMonteith J.L., Unsworth M.H., 2008: Principles of Environmental Physics.             3rd edition. Academic Press, London.\n\nExamples\n\nwetbulb_temp.([20,25.0], 100, [1,1.6])             \n\n\n\n\n\n","category":"function"},{"location":"bigleaf_constants/#Constants-used-in-Bigleaf","page":"-","title":"Constants used in Bigleaf","text":"","category":"section"},{"location":"bigleaf_constants/","page":"-","title":"-","text":"bigleaf_constants","category":"page"},{"location":"bigleaf_constants/#Bigleaf.bigleaf_constants","page":"-","title":"Bigleaf.bigleaf_constants","text":"bigleaf_constants(;...)\n\nConstants Used in the Bigleaf.jl Package\n\nReturn a Dictionary Dict{Symbol, Real}. Default values can be overridden by the named arguments:\n\ncp           Specific heat of air for constant pressure (J K-1 kg-1)\nRgas         Universal gas constant (J mol-1 K-1)\nRv           Gas constant of water vapor (J kg-1 K-1) (Stull 1988 p.641)\nRd           Gas constant of dry air (J kg-1 K-1) (Foken p. 245)\nMd           Molar mass of dry air (kg mol-1)\nMw           Molar mass of water vapor (kg mol-1)\neps          Ratio of the molecular weight of water vapor to dry air (=Mw/Md)\ng            Gravitational acceleration (m s-2)\nsolar_constant Solar constant (W m-2)\npressure0    Reference atmospheric pressure at sea level (Pa)\nTair0        Reference air temperature (K)\nk            von Karman constant\nCmol         Molar mass of carbon (kg mol-1)\nOmol         Molar mass of oxygen (kg mol-1)\nH2Omol       Molar mass of water (kg mol-1)\nsigma        Stefan-Boltzmann constant (W m-2 K-4)\nPr           Prandtl number\nSc_CO2       Schmidt number for CO2\nKelvin       Conversion degree Celsius to Kelvin\nDwDc         Ratio of the molecular diffusivities for water vapor and CO2\ndays2seconds Seconds per day\nkPa2Pa       Conversion kilopascal (kPa) to pascal (Pa)\nPa2kPa       Conversion pascal (Pa) to kilopascal (kPa)\numol2mol     Conversion micromole (umol) to mole (mol)\nmol2umol     Conversion mole (mol) to micromole (umol)\nkg2g         Conversion kilogram (kg) to gram (g)\ng2kg         Conversion gram (g) to kilogram (kg)\nkJ2J         Conversion kilojoule (kJ) to joule (J)\nJ2kJ         Conversion joule (J) to kilojoule (kJ)\nse_median    Conversion standard error (SE) of the mean to SE of the median\nfrac2percent Conversion between fraction and percent\n\n\n\n\n\n","category":"function"},{"location":"unit_conversions/#Unit-conversions","page":"-","title":"Unit conversions","text":"","category":"section"},{"location":"unit_conversions/","page":"-","title":"-","text":"Pages = [\"unit_conversions.md\",]","category":"page"},{"location":"unit_conversions/","page":"-","title":"-","text":"LE_to_ET\nms_to_mol\nVPD_to_e\nRg_to_PPFD\nkg_to_mol\numolCO2_to_gC","category":"page"},{"location":"unit_conversions/#Bigleaf.LE_to_ET","page":"-","title":"Bigleaf.LE_to_ET","text":"LE_to_ET(LE,Tair)\nET_to_LE(ET,Tair)\n\nConvert evaporative water flux from mass (ET=evapotranspiration)              to energy (LE=latent heat flux) units, or vice versa.\n\nArguments\n\nLE   Latent heat flux (W m-2)\nET   Evapotranspiration (kg m-2 s-1)\nTair Air temperature (deg C)\n\nDetails\n\nThe conversions are given by:\n\nET = LElambda\nLE = lambda ET\n\nwhere lambda is the latent heat of vaporization (J kg-1) as calculated by latent_heat_vaporization.\n\nExamples\n\n# LE of 200 Wm-2 and air temperature of 25degC\nET = LE_to_ET(200,25)\n≈(ET, 8.19e-5, atol =1e-7)\n\n\n\n\n\n","category":"function"},{"location":"unit_conversions/#Bigleaf.ms_to_mol","page":"-","title":"Bigleaf.ms_to_mol","text":"ms_to_mol(G_ms,Tair,pressure; constants=bigleaf_constants())\nmol_to_ms(G_mol,Tair,pressure; constants=bigleaf_constants())\n\nConverts conductances from mass (m s-1) to molar units (mol m-2 s-1), or vice versa\n\nDetails\n\nThe conversions are given by\n\nG_mol = G_ms   pressure  (Rgas  Tair)\nG_ms = G_mol   (Rgas  Tair)  pressure\n\nwhere Tair is in Kelvin and pressure in Pa (converted from kPa internally).\n\nReferences\n\nJones, HG 1992_ Plants and microclimate: a quantitative approach to    environmental plant physiology_   2nd Edition, Cambridge University Press, Cambridge 428 \n\nExamples\n\nG_ms,Tair,pressure = 0.005,25,100\nrmol = ms_to_mol(G_ms,Tair,pressure)\n≈(rmol, 0.2017, atol =1e-4)\n\n\n\n\n\n","category":"function"},{"location":"unit_conversions/#Bigleaf.VPD_to_e","page":"-","title":"Bigleaf.VPD_to_e","text":"VPD_to_rH(VPD,Tair; ...)\nH_to_VPD(rH,Tair; ...)\ne_to_rH(e,Tair; ...)\nVPD_to_e(VPD,Tair; ...)\ne_to_VPD(e,Tair; ...)\ne_to_q(e,pressure; ...)\nq_to_e(q,pressure; ...)\nq_to_VPD(q,Tair,pressure; ...)\nVPD_to_q(VPD,Tair,pressure; ...)\n\nConversion between vapor pressure (e), vapor pressure deficit (VPD),              specific humidity (q), and relative humidity (rH).\n\nArguments\n\nTair:      Air temperature (deg C)\npressure:  Atmospheric pressure (kPa)\ne:         Vapor pressure (kPa)\nq:        Specific humidity (kg kg-1)\nVPD:       Vapor pressure deficit (kPa)\nrH:        Relative humidity (-)\n\nAll functions accept the optional arguemtns:\n\nEsat_formula: formula used in Esat_from_Tair\nconstants: dictionary from bigleaf_constants with entries eps and Pa2kPa\n\nRreferences\n\nFoken, T, 2008: Micrometeorology_ Springer, Berlin, Germany.\n\n\n\n\n\n","category":"function"},{"location":"unit_conversions/#Bigleaf.Rg_to_PPFD","page":"-","title":"Bigleaf.Rg_to_PPFD","text":"Rg_to_PPFD(Rg,J_to_mol=4.6,frac_PAR=0.5)\nPPFD_to_Rg(PPFD,J_to_mol=4.6,frac_PAR=0.5)\n\nConversions between Global Radiation (W m-2) and Photosynthetic Photon Flux  Density (umol m-2 s-1)\n\nArguments\n\nRg:       Global radiation = incoming short-wave radiation at the surface (W m-2)\nPPFD:     Photosynthetic photon flux density (umol m-2 s-1)\nJtomol: Conversion factor from J m-2 s-1 (= W m-2) to umol (quanta) m-2 s-1\nfrac_PAR: Fraction of incoming solar irradiance that is photosynthetical-           active radiation (PAR); defaults to 0.5\n\nDetails\n\nThe conversion is given by:\n\nPPFD = Rg * frac_PAR * J_to_mol\n\nby default, the combined conversion factor (frac_PAR * J_to_mol) is 2.3\n\nExamples\n\n# convert a measured incoming short-wave radiation of 500 Wm-2 to\n# PPFD in umol m-2 s-1 and backwards\nRg_to_PPFD(500)\nPPFD_to_Rg(1150)\n\n\n\n\n\n","category":"function"},{"location":"unit_conversions/#Bigleaf.kg_to_mol","page":"-","title":"Bigleaf.kg_to_mol","text":"kg_to_mol(mass, molarMass=bigleaf_constants()[:H2Omol])\n\nConversion between Mass (kg) and Molar Units (mol).\n\n\n\n\n\n","category":"function"},{"location":"unit_conversions/#Bigleaf.umolCO2_to_gC","page":"-","title":"Bigleaf.umolCO2_to_gC","text":"umolCO2_to_gC(CO2_flux; constants=bigleaf_constants())\ngC_to_umolCO2(C_flux; constants=bigleaf_constants())\n\nConvert CO2 quantities from (umol CO2 m-2 s-1) to (g C m-2 d-1) and vice versa.\n\nArguments\n\nCO2_flux  CO2 flux (umol CO2 m-2 s-1)\nC_flux    Carbon (C) flux (gC m-2 d-1)\nconstants: dictionary from bigleaf_constants with entries: Cmol, umol2mol, mol2umol, kg2g, g2kg, says2seconds\n\nExamples\n\numolCO2_to_gC(20)  # gC m-2 d-1\n\n\n\n\n\n","category":"function"},{"location":"global_radiation/#Global-radiation","page":"-","title":"Global radiation","text":"","category":"section"},{"location":"global_radiation/","page":"-","title":"-","text":"Pages = [\"global_radiation.md\",]","category":"page"},{"location":"global_radiation/","page":"-","title":"-","text":"potential_radiation\nextraterrestrial_radiation\ncalc_sun_position_hor\ncalc_sun_position_MOD","category":"page"},{"location":"global_radiation/#Bigleaf.potential_radiation","page":"-","title":"Bigleaf.potential_radiation","text":"potential_radiation(datetime, lat, long)\npotential_radiation(doy, hour, lat, long; timezone,year)\n\nCompute potential radiation for given geolocation and time.\n\nBecause potential radiation does not change across years  (for a given location and daytime and day of year), time can be specified alternatively by doy and hour.\n\nArguments\n\ndatetime:  UTC timestamp.\nlat:       Latitude (decimal degrees)\nlong:      Longitude (decimal degrees)\ndoy:       day of year (integer starting from 1)\nhour:      hour within the day (0.0 .. 24.0 float)\n\noptional     \n\ntimezone:  Timezone for doy and hour, defaults to \"GMT+x\"  nearest to given longitude.\nyear: specific year for doy and hour\n\nValue\n\nvector of potential radiation (W m-2)\n\nExamples\n\n# assume hours in the GMT+x that is closest to given longitude\npotrad = potential_radiation(160, 10.5, 51.0, 11.5)\n\n\n\n\n\npotential_radiation(datetime, lat, long)\npotential_radiation(doy, hour, lat, long; timezone,year)\n\nCompute potential radiation for given geolocation and time.\n\nBecause potential radiation does not change across years  (for a given location and daytime and day of year), time can be specified alternatively by doy and hour.\n\nArguments\n\ndatetime:  UTC timestamp.\nlat:       Latitude (decimal degrees)\nlong:      Longitude (decimal degrees)\ndoy:       day of year (integer starting from 1)\nhour:      hour within the day (0.0 .. 24.0 float)\n\noptional     \n\ntimezone:  Timezone for doy and hour, defaults to \"GMT+x\"  nearest to given longitude.\nyear: specific year for doy and hour\n\nValue\n\nvector of potential radiation (W m-2)\n\nExamples\n\n# assume hours in the GMT+x that is closest to given longitude\npotrad = potential_radiation(160, 10.5, 51.0, 11.5)\n\n\n\n\n\n","category":"function"},{"location":"global_radiation/#Bigleaf.extraterrestrial_radiation","page":"-","title":"Bigleaf.extraterrestrial_radiation","text":"extraterrestrial_radiation(doy::Number; ...)\nextraterrestrial_radiation(datetime::TimeType; ...)\n\nCompute the extraterrestrial solar radiation with the eccentricity correction. Computation follows Lanini, 2010 (Master thesis, Bern University).\n\nArguments\n\ndoy: integer vector with day of year (DoY)\n\noptional \n\nconstants=bigleaf_constants(): Dictionary with entries \nsolar_constant\nyear=2030: year to create timestamps. Due to precession results slightly change across decades.   \n\nValue\n\nnumeric vector of extraterrestrial radiation (W_m-2)\n\nExamples\n\nex_rad = extraterrestrial_radiation(1)\n≈(ex_rad, 1414, atol = 1)\n\n\n\n\n\nextraterrestrial_radiation(doy::Number; ...)\nextraterrestrial_radiation(datetime::TimeType; ...)\n\nCompute the extraterrestrial solar radiation with the eccentricity correction. Computation follows Lanini, 2010 (Master thesis, Bern University).\n\nArguments\n\ndoy: integer vector with day of year (DoY)\n\noptional \n\nconstants=bigleaf_constants(): Dictionary with entries \nsolar_constant\nyear=2030: year to create timestamps. Due to precession results slightly change across decades.   \n\nValue\n\nnumeric vector of extraterrestrial radiation (W_m-2)\n\nExamples\n\nex_rad = extraterrestrial_radiation(1)\n≈(ex_rad, 1414, atol = 1)\n\n\n\n\n\n","category":"function"},{"location":"global_radiation/#Bigleaf.calc_sun_position_hor","page":"-","title":"Bigleaf.calc_sun_position_hor","text":"calc_sun_position_hor(datetime, lat, long)\n\nCompute the Sun position at given time and observer coordinates in horizontal coordinates.\n\nArguments:\n\ndatetime: time: Either a ZonedDateTime, or DateTime assumed in UTC\nlat, long: latitude and longitude in degree\n\nValue\n\nNamedTuple: sun position with entries\n\naltitude: angle above the horizon [rad].\nazimuth: angle ange the horizon plane eastwards of north [rad]\nhourangle: [rad] as output by AstroLib.eq2hor  Seems to represent time [day/2pi] after solar noon.   Value at local timezone noon provdes (local time - solar time).\n\n\n\n\n\ncalc_sun_position_hor(datetime, lat, long)\n\nCompute the Sun position at given time and observer coordinates in horizontal coordinates.\n\nArguments:\n\ndatetime: time: Either a ZonedDateTime, or DateTime assumed in UTC\nlat, long: latitude and longitude in degree\n\nValue\n\nNamedTuple: sun position with entries\n\naltitude: angle above the horizon [rad].\nazimuth: angle ange the horizon plane eastwards of north [rad]\nhourangle: [rad] as output by AstroLib.eq2hor  Seems to represent time [day/2pi] after solar noon.   Value at local timezone noon provdes (local time - solar time).\n\n\n\n\n\n","category":"function"},{"location":"global_radiation/#Bigleaf.calc_sun_position_MOD","page":"-","title":"Bigleaf.calc_sun_position_MOD","text":"calc_sun_position_MOD(JD::Number)\n\nCompute the Sun position at the Julian Day JD.\n\nResults are represented in the Mean Equinox of Date (MOD), i.e. accounting for precession but not for nutation and smaller pertubation of the polar axes, in spherical ecliptic and equatorial coordinates.  The algorithm was adapted from [Vallado 2013, p. 277-279].\n\nArguments:\n\nJD: time given as Julian Day . \n\nValue\n\nNamedTuple: sun position where\n\nEcliptic coordinates (1:3)\nλ: Ecliptic longitude of the Sun [rad].\nβ: Ecliptic latitude of the Sun [rad] is assumed 0.\nr: Distance of the Sun from Earth [m].\nEquatorial coordinate (4:5)  \nα: ascention [rad]\nδ: declination [rad]\nϵ: Obliquity of the ecliptic [rad].\n\nReferences\n\nVallado, D. A (2013). Fundamentals of Astrodynamics and Applications.      Microcosm Press, Hawthorne, CA.\n\n\n\n\n\n","category":"function"},{"location":"evapotranspiration/#Evapotranspiration","page":"-","title":"Evapotranspiration","text":"","category":"section"},{"location":"evapotranspiration/","page":"-","title":"-","text":"Pages = [\"evapotranspiration.md\",]","category":"page"},{"location":"evapotranspiration/","page":"-","title":"-","text":"potential_ET\nequilibrium_imposed_ET","category":"page"},{"location":"evapotranspiration/#Bigleaf.potential_ET","page":"-","title":"Bigleaf.potential_ET","text":"potential_ET(Tair, pressure, Rn, ::Val{:PriestleyTaylor}; ...)\npotential_ET(Tair, pressure, Rn, G, S, ::Val{:PriestleyTaylor}; ...)\n\npotential_ET(df, approach; ...)\npotential_ET!(df, approach; ...)\n\nPotential evapotranspiration according to Priestley & Taylor 1972 or the Penman-Monteith equation with a prescribed surface conductance.\n\nArguments\n\nTair:      Air temperature (degC)\npressure:  Atmospheric pressure (kPa)\nRn:        Net radiation (W m-2)\nVPD:       Vapor pressure deficit (kPa)\nGa:        Aerodynamic conductance to heat/water vapor (m s-1)\napproach:  Approach used.  Either Val(:PriestleyTaylor) (default), or Val(:PenmanMonteith).\ndf:      Data_frame or matrix containing all required variables; optional\n\noptional:\n\nG:         Ground heat flux (W m-2). Defaults to zero.\nS:         Sum of all storage fluxes (W m-2) . Defaults to zero.\nEsat_formula: formula used in Esat_from_Tair\nconstants=bigleaf_constants(): Dictionary with entries \ncp - specific heat of air for constant pressure (J K-1 kg-1) \neps - ratio of the molecular weight of water vapor to dry air \nPa2kPa - conversion pascal (Pa) to kilopascal (kPa) \nfor :PenmanMonteith:\nRd - gas constant of dry air (J kg-1 K-1)\nRgas - universal gas constant (J mol-1 K-1)\nKelvin - conversion degree Celsius to Kelvin\n\nadditional optional arguments with data.frame variants\n\ninfoGS=ture: sete to false to avoid infor log-message if G or S is not  specified\n\nadditional optional for PriestleyTaylor:\n\nalpha:     Priestley-Taylor coefficient\n\nadditional optional for PenmanMonteith:\n\nGs_pot:    Potential/maximum surface conductance (mol m-2 s-1);  defaults to 0.6 mol m-2 s-1;\n\nDetails\n\nPotential evapotranspiration is calculated according to Priestley & Taylor, 1972 if approach = Val(:PriestleyTaylor) (the defau LE_potPT = (alpha * Delta * (Rn - G - S))  (Delta + gamma)\n\nalpha is the Priestley-Taylor coefficient, Delta is the slope  of the saturation vapor pressure curve (kPa K-1), and gamma is the  psychrometric constant (kPa K-1). if approach = Val(:PenmanMonteith), potential evapotranspiration is calculated according to the Penman-Monteith equat\n\nLE_potPM = (Delta * (Rn - G - S) + rho * cp * VPD * Ga)   (Delta + gamma * (1 + GaGs_pot)\n\nwhere Delta is the slope of the saturation vapor pressure curve (kPa K-1), rho is the air density (kg m-3),  and gamma is the psychrometric constant (kPa K-1). The value of Gs_pot is typically a maximum value of Gs observed at the site, e.g. the 90th percentile of Gs within the growing season.\n\nGround heat flux and storage heat flux G or S are provided as optional  arguments. In the input-explicit variants, they default to zero. In the data-frame arguments, they default to missing, which results in assuming them to be zero which is displayed in a log-message. Note that in difference ot the bigleaf R package, you explitly need to care for missing values (see examples).\n\nBoth methods are provided with several forms:\n\nall required inputs as positional arguments\nproviding a DataFrame with columns corresponding to required inputs returning a DataFrame with only the result columns.\na mutating DataFrame version that returns the original DataFrame with result columns added or modified.\n\nValue\n\nNamedTuple or DataFrame with the following entries:\n\nET_pot: Potential evapotranspiration (kg m-2 s-1)\nLE_pot: Potential latent heat flux (W m-2)\n\nFor the mutating form, the original df with columns ET_pot, LE_pot  updated or added.\n\nReferences\n\nPriestley, CHB., Taylor, R_J., 1972: On the assessment of surface heat flux\n\nand evaporation using large-scale parameters. Monthly Weather Review 100, 81-92.  \n\nAllen, RG., Pereira LS., Raes D., Smith M., 1998: Crop evapotranspiration -\n\nGuidelines for computing crop water requirements - FAO Irrigation and drainage paper 56.\n\nNovick, K_A., et al. 2016: The increasing importance of atmospheric demand\n\nfor ecosystem water and carbon fluxes. Nature Climate Change 6, 1023 - 1027.\n\nSee also\n\nsurface_conductance\n\nExamples\n\nCalculate potential ET of a surface that receives a net radiation of 500 Wm-2 using Priestley-Taylor:\n\nTair,pressure,Rn = 30.0,100.0,500.0\nET_pot, LE_pot = potential_ET(Tair,pressure,Rn, Val(:PriestleyTaylor))    \n≈(ET_pot, 0.0002035969; rtol = 1e-5)\n\nCalculate potential ET for a surface with known Gs (0.5 mol m-2 s-1) and Ga (0.1 m s-1) using Penman-Monteith:\n\nTair,pressure,Rn = 30.0,100.0,500.0\nVPD, Ga = 2.0, 0.1\nET_pot, LE_pot = potential_ET(Tair,pressure,Rn,VPD, Ga, Val(:PenmanMonteith); Gs_pot=0.5,)    \n# now cross-check with the inverted equation\n#Ga2 = surface_conductance(Tair=20,pressure=100,VPD=2,Ga=0.1,Rn=400,LE=LE_pot_PM)\n#Ga2 ≈ GA\ntrue\n\nDataFrame variant with explicitly replacing missings:\n\nusing DataFrames\ndf = DataFrame(Tair = 20.0:1.0:30.0,pressure = 100.0, Rn = 500.0, G = 105.0, VPD = 2.0, Ga = 0.1) \nallowmissing!(df, Cols(:G)); df.G[1] = missing\n#\n# need to provide G explicitly\ndf_ET = potential_ET(df, Val(:PriestleyTaylor); G = df.G, infoGS = false)    \nismissing(df_ET.ET_pot[1])\n#\n# use coalesce to replace missing values\ndf_ET = potential_ET(df, Val(:PriestleyTaylor); G = coalesce.(df.G, zero(df.G)), infoGS = false)    \n!ismissing(df_ET.ET_pot[1])\n\n\n\n\n\npotential_ET(Tair, pressure, Rn, ::Val{:PriestleyTaylor}; ...)\npotential_ET(Tair, pressure, Rn, G, S, ::Val{:PriestleyTaylor}; ...)\n\npotential_ET(df, approach; ...)\npotential_ET!(df, approach; ...)\n\nPotential evapotranspiration according to Priestley & Taylor 1972 or the Penman-Monteith equation with a prescribed surface conductance.\n\nArguments\n\nTair:      Air temperature (degC)\npressure:  Atmospheric pressure (kPa)\nRn:        Net radiation (W m-2)\nVPD:       Vapor pressure deficit (kPa)\nGa:        Aerodynamic conductance to heat/water vapor (m s-1)\napproach:  Approach used.  Either Val(:PriestleyTaylor) (default), or Val(:PenmanMonteith).\ndf:      Data_frame or matrix containing all required variables; optional\n\noptional:\n\nG:         Ground heat flux (W m-2). Defaults to zero.\nS:         Sum of all storage fluxes (W m-2) . Defaults to zero.\nEsat_formula: formula used in Esat_from_Tair\nconstants=bigleaf_constants(): Dictionary with entries \ncp - specific heat of air for constant pressure (J K-1 kg-1) \neps - ratio of the molecular weight of water vapor to dry air \nPa2kPa - conversion pascal (Pa) to kilopascal (kPa) \nfor :PenmanMonteith:\nRd - gas constant of dry air (J kg-1 K-1)\nRgas - universal gas constant (J mol-1 K-1)\nKelvin - conversion degree Celsius to Kelvin\n\nadditional optional arguments with data.frame variants\n\ninfoGS=ture: sete to false to avoid infor log-message if G or S is not  specified\n\nadditional optional for PriestleyTaylor:\n\nalpha:     Priestley-Taylor coefficient\n\nadditional optional for PenmanMonteith:\n\nGs_pot:    Potential/maximum surface conductance (mol m-2 s-1);  defaults to 0.6 mol m-2 s-1;\n\nDetails\n\nPotential evapotranspiration is calculated according to Priestley & Taylor, 1972 if approach = Val(:PriestleyTaylor) (the defau LE_potPT = (alpha * Delta * (Rn - G - S))  (Delta + gamma)\n\nalpha is the Priestley-Taylor coefficient, Delta is the slope  of the saturation vapor pressure curve (kPa K-1), and gamma is the  psychrometric constant (kPa K-1). if approach = Val(:PenmanMonteith), potential evapotranspiration is calculated according to the Penman-Monteith equat\n\nLE_potPM = (Delta * (Rn - G - S) + rho * cp * VPD * Ga)   (Delta + gamma * (1 + GaGs_pot)\n\nwhere Delta is the slope of the saturation vapor pressure curve (kPa K-1), rho is the air density (kg m-3),  and gamma is the psychrometric constant (kPa K-1). The value of Gs_pot is typically a maximum value of Gs observed at the site, e.g. the 90th percentile of Gs within the growing season.\n\nGround heat flux and storage heat flux G or S are provided as optional  arguments. In the input-explicit variants, they default to zero. In the data-frame arguments, they default to missing, which results in assuming them to be zero which is displayed in a log-message. Note that in difference ot the bigleaf R package, you explitly need to care for missing values (see examples).\n\nBoth methods are provided with several forms:\n\nall required inputs as positional arguments\nproviding a DataFrame with columns corresponding to required inputs returning a DataFrame with only the result columns.\na mutating DataFrame version that returns the original DataFrame with result columns added or modified.\n\nValue\n\nNamedTuple or DataFrame with the following entries:\n\nET_pot: Potential evapotranspiration (kg m-2 s-1)\nLE_pot: Potential latent heat flux (W m-2)\n\nFor the mutating form, the original df with columns ET_pot, LE_pot  updated or added.\n\nReferences\n\nPriestley, CHB., Taylor, R_J., 1972: On the assessment of surface heat flux\n\nand evaporation using large-scale parameters. Monthly Weather Review 100, 81-92.  \n\nAllen, RG., Pereira LS., Raes D., Smith M., 1998: Crop evapotranspiration -\n\nGuidelines for computing crop water requirements - FAO Irrigation and drainage paper 56.\n\nNovick, K_A., et al. 2016: The increasing importance of atmospheric demand\n\nfor ecosystem water and carbon fluxes. Nature Climate Change 6, 1023 - 1027.\n\nSee also\n\nsurface_conductance\n\nExamples\n\nCalculate potential ET of a surface that receives a net radiation of 500 Wm-2 using Priestley-Taylor:\n\nTair,pressure,Rn = 30.0,100.0,500.0\nET_pot, LE_pot = potential_ET(Tair,pressure,Rn, Val(:PriestleyTaylor))    \n≈(ET_pot, 0.0002035969; rtol = 1e-5)\n\nCalculate potential ET for a surface with known Gs (0.5 mol m-2 s-1) and Ga (0.1 m s-1) using Penman-Monteith:\n\nTair,pressure,Rn = 30.0,100.0,500.0\nVPD, Ga = 2.0, 0.1\nET_pot, LE_pot = potential_ET(Tair,pressure,Rn,VPD, Ga, Val(:PenmanMonteith); Gs_pot=0.5,)    \n# now cross-check with the inverted equation\n#Ga2 = surface_conductance(Tair=20,pressure=100,VPD=2,Ga=0.1,Rn=400,LE=LE_pot_PM)\n#Ga2 ≈ GA\ntrue\n\nDataFrame variant with explicitly replacing missings:\n\nusing DataFrames\ndf = DataFrame(Tair = 20.0:1.0:30.0,pressure = 100.0, Rn = 500.0, G = 105.0, VPD = 2.0, Ga = 0.1) \nallowmissing!(df, Cols(:G)); df.G[1] = missing\n#\n# need to provide G explicitly\ndf_ET = potential_ET(df, Val(:PriestleyTaylor); G = df.G, infoGS = false)    \nismissing(df_ET.ET_pot[1])\n#\n# use coalesce to replace missing values\ndf_ET = potential_ET(df, Val(:PriestleyTaylor); G = coalesce.(df.G, zero(df.G)), infoGS = false)    \n!ismissing(df_ET.ET_pot[1])\n\n\n\n\n\npotential_ET(Tair, pressure, Rn, ::Val{:PriestleyTaylor}; ...)\npotential_ET(Tair, pressure, Rn, G, S, ::Val{:PriestleyTaylor}; ...)\n\npotential_ET(df, approach; ...)\npotential_ET!(df, approach; ...)\n\nPotential evapotranspiration according to Priestley & Taylor 1972 or the Penman-Monteith equation with a prescribed surface conductance.\n\nArguments\n\nTair:      Air temperature (degC)\npressure:  Atmospheric pressure (kPa)\nRn:        Net radiation (W m-2)\nVPD:       Vapor pressure deficit (kPa)\nGa:        Aerodynamic conductance to heat/water vapor (m s-1)\napproach:  Approach used.  Either Val(:PriestleyTaylor) (default), or Val(:PenmanMonteith).\ndf:      Data_frame or matrix containing all required variables; optional\n\noptional:\n\nG:         Ground heat flux (W m-2). Defaults to zero.\nS:         Sum of all storage fluxes (W m-2) . Defaults to zero.\nEsat_formula: formula used in Esat_from_Tair\nconstants=bigleaf_constants(): Dictionary with entries \ncp - specific heat of air for constant pressure (J K-1 kg-1) \neps - ratio of the molecular weight of water vapor to dry air \nPa2kPa - conversion pascal (Pa) to kilopascal (kPa) \nfor :PenmanMonteith:\nRd - gas constant of dry air (J kg-1 K-1)\nRgas - universal gas constant (J mol-1 K-1)\nKelvin - conversion degree Celsius to Kelvin\n\nadditional optional arguments with data.frame variants\n\ninfoGS=ture: sete to false to avoid infor log-message if G or S is not  specified\n\nadditional optional for PriestleyTaylor:\n\nalpha:     Priestley-Taylor coefficient\n\nadditional optional for PenmanMonteith:\n\nGs_pot:    Potential/maximum surface conductance (mol m-2 s-1);  defaults to 0.6 mol m-2 s-1;\n\nDetails\n\nPotential evapotranspiration is calculated according to Priestley & Taylor, 1972 if approach = Val(:PriestleyTaylor) (the defau LE_potPT = (alpha * Delta * (Rn - G - S))  (Delta + gamma)\n\nalpha is the Priestley-Taylor coefficient, Delta is the slope  of the saturation vapor pressure curve (kPa K-1), and gamma is the  psychrometric constant (kPa K-1). if approach = Val(:PenmanMonteith), potential evapotranspiration is calculated according to the Penman-Monteith equat\n\nLE_potPM = (Delta * (Rn - G - S) + rho * cp * VPD * Ga)   (Delta + gamma * (1 + GaGs_pot)\n\nwhere Delta is the slope of the saturation vapor pressure curve (kPa K-1), rho is the air density (kg m-3),  and gamma is the psychrometric constant (kPa K-1). The value of Gs_pot is typically a maximum value of Gs observed at the site, e.g. the 90th percentile of Gs within the growing season.\n\nGround heat flux and storage heat flux G or S are provided as optional  arguments. In the input-explicit variants, they default to zero. In the data-frame arguments, they default to missing, which results in assuming them to be zero which is displayed in a log-message. Note that in difference ot the bigleaf R package, you explitly need to care for missing values (see examples).\n\nBoth methods are provided with several forms:\n\nall required inputs as positional arguments\nproviding a DataFrame with columns corresponding to required inputs returning a DataFrame with only the result columns.\na mutating DataFrame version that returns the original DataFrame with result columns added or modified.\n\nValue\n\nNamedTuple or DataFrame with the following entries:\n\nET_pot: Potential evapotranspiration (kg m-2 s-1)\nLE_pot: Potential latent heat flux (W m-2)\n\nFor the mutating form, the original df with columns ET_pot, LE_pot  updated or added.\n\nReferences\n\nPriestley, CHB., Taylor, R_J., 1972: On the assessment of surface heat flux\n\nand evaporation using large-scale parameters. Monthly Weather Review 100, 81-92.  \n\nAllen, RG., Pereira LS., Raes D., Smith M., 1998: Crop evapotranspiration -\n\nGuidelines for computing crop water requirements - FAO Irrigation and drainage paper 56.\n\nNovick, K_A., et al. 2016: The increasing importance of atmospheric demand\n\nfor ecosystem water and carbon fluxes. Nature Climate Change 6, 1023 - 1027.\n\nSee also\n\nsurface_conductance\n\nExamples\n\nCalculate potential ET of a surface that receives a net radiation of 500 Wm-2 using Priestley-Taylor:\n\nTair,pressure,Rn = 30.0,100.0,500.0\nET_pot, LE_pot = potential_ET(Tair,pressure,Rn, Val(:PriestleyTaylor))    \n≈(ET_pot, 0.0002035969; rtol = 1e-5)\n\nCalculate potential ET for a surface with known Gs (0.5 mol m-2 s-1) and Ga (0.1 m s-1) using Penman-Monteith:\n\nTair,pressure,Rn = 30.0,100.0,500.0\nVPD, Ga = 2.0, 0.1\nET_pot, LE_pot = potential_ET(Tair,pressure,Rn,VPD, Ga, Val(:PenmanMonteith); Gs_pot=0.5,)    \n# now cross-check with the inverted equation\n#Ga2 = surface_conductance(Tair=20,pressure=100,VPD=2,Ga=0.1,Rn=400,LE=LE_pot_PM)\n#Ga2 ≈ GA\ntrue\n\nDataFrame variant with explicitly replacing missings:\n\nusing DataFrames\ndf = DataFrame(Tair = 20.0:1.0:30.0,pressure = 100.0, Rn = 500.0, G = 105.0, VPD = 2.0, Ga = 0.1) \nallowmissing!(df, Cols(:G)); df.G[1] = missing\n#\n# need to provide G explicitly\ndf_ET = potential_ET(df, Val(:PriestleyTaylor); G = df.G, infoGS = false)    \nismissing(df_ET.ET_pot[1])\n#\n# use coalesce to replace missing values\ndf_ET = potential_ET(df, Val(:PriestleyTaylor); G = coalesce.(df.G, zero(df.G)), infoGS = false)    \n!ismissing(df_ET.ET_pot[1])\n\n\n\n\n\npotential_ET(Tair, pressure, Rn, ::Val{:PriestleyTaylor}; ...)\npotential_ET(Tair, pressure, Rn, G, S, ::Val{:PriestleyTaylor}; ...)\n\npotential_ET(df, approach; ...)\npotential_ET!(df, approach; ...)\n\nPotential evapotranspiration according to Priestley & Taylor 1972 or the Penman-Monteith equation with a prescribed surface conductance.\n\nArguments\n\nTair:      Air temperature (degC)\npressure:  Atmospheric pressure (kPa)\nRn:        Net radiation (W m-2)\nVPD:       Vapor pressure deficit (kPa)\nGa:        Aerodynamic conductance to heat/water vapor (m s-1)\napproach:  Approach used.  Either Val(:PriestleyTaylor) (default), or Val(:PenmanMonteith).\ndf:      Data_frame or matrix containing all required variables; optional\n\noptional:\n\nG:         Ground heat flux (W m-2). Defaults to zero.\nS:         Sum of all storage fluxes (W m-2) . Defaults to zero.\nEsat_formula: formula used in Esat_from_Tair\nconstants=bigleaf_constants(): Dictionary with entries \ncp - specific heat of air for constant pressure (J K-1 kg-1) \neps - ratio of the molecular weight of water vapor to dry air \nPa2kPa - conversion pascal (Pa) to kilopascal (kPa) \nfor :PenmanMonteith:\nRd - gas constant of dry air (J kg-1 K-1)\nRgas - universal gas constant (J mol-1 K-1)\nKelvin - conversion degree Celsius to Kelvin\n\nadditional optional arguments with data.frame variants\n\ninfoGS=ture: sete to false to avoid infor log-message if G or S is not  specified\n\nadditional optional for PriestleyTaylor:\n\nalpha:     Priestley-Taylor coefficient\n\nadditional optional for PenmanMonteith:\n\nGs_pot:    Potential/maximum surface conductance (mol m-2 s-1);  defaults to 0.6 mol m-2 s-1;\n\nDetails\n\nPotential evapotranspiration is calculated according to Priestley & Taylor, 1972 if approach = Val(:PriestleyTaylor) (the defau LE_potPT = (alpha * Delta * (Rn - G - S))  (Delta + gamma)\n\nalpha is the Priestley-Taylor coefficient, Delta is the slope  of the saturation vapor pressure curve (kPa K-1), and gamma is the  psychrometric constant (kPa K-1). if approach = Val(:PenmanMonteith), potential evapotranspiration is calculated according to the Penman-Monteith equat\n\nLE_potPM = (Delta * (Rn - G - S) + rho * cp * VPD * Ga)   (Delta + gamma * (1 + GaGs_pot)\n\nwhere Delta is the slope of the saturation vapor pressure curve (kPa K-1), rho is the air density (kg m-3),  and gamma is the psychrometric constant (kPa K-1). The value of Gs_pot is typically a maximum value of Gs observed at the site, e.g. the 90th percentile of Gs within the growing season.\n\nGround heat flux and storage heat flux G or S are provided as optional  arguments. In the input-explicit variants, they default to zero. In the data-frame arguments, they default to missing, which results in assuming them to be zero which is displayed in a log-message. Note that in difference ot the bigleaf R package, you explitly need to care for missing values (see examples).\n\nBoth methods are provided with several forms:\n\nall required inputs as positional arguments\nproviding a DataFrame with columns corresponding to required inputs returning a DataFrame with only the result columns.\na mutating DataFrame version that returns the original DataFrame with result columns added or modified.\n\nValue\n\nNamedTuple or DataFrame with the following entries:\n\nET_pot: Potential evapotranspiration (kg m-2 s-1)\nLE_pot: Potential latent heat flux (W m-2)\n\nFor the mutating form, the original df with columns ET_pot, LE_pot  updated or added.\n\nReferences\n\nPriestley, CHB., Taylor, R_J., 1972: On the assessment of surface heat flux\n\nand evaporation using large-scale parameters. Monthly Weather Review 100, 81-92.  \n\nAllen, RG., Pereira LS., Raes D., Smith M., 1998: Crop evapotranspiration -\n\nGuidelines for computing crop water requirements - FAO Irrigation and drainage paper 56.\n\nNovick, K_A., et al. 2016: The increasing importance of atmospheric demand\n\nfor ecosystem water and carbon fluxes. Nature Climate Change 6, 1023 - 1027.\n\nSee also\n\nsurface_conductance\n\nExamples\n\nCalculate potential ET of a surface that receives a net radiation of 500 Wm-2 using Priestley-Taylor:\n\nTair,pressure,Rn = 30.0,100.0,500.0\nET_pot, LE_pot = potential_ET(Tair,pressure,Rn, Val(:PriestleyTaylor))    \n≈(ET_pot, 0.0002035969; rtol = 1e-5)\n\nCalculate potential ET for a surface with known Gs (0.5 mol m-2 s-1) and Ga (0.1 m s-1) using Penman-Monteith:\n\nTair,pressure,Rn = 30.0,100.0,500.0\nVPD, Ga = 2.0, 0.1\nET_pot, LE_pot = potential_ET(Tair,pressure,Rn,VPD, Ga, Val(:PenmanMonteith); Gs_pot=0.5,)    \n# now cross-check with the inverted equation\n#Ga2 = surface_conductance(Tair=20,pressure=100,VPD=2,Ga=0.1,Rn=400,LE=LE_pot_PM)\n#Ga2 ≈ GA\ntrue\n\nDataFrame variant with explicitly replacing missings:\n\nusing DataFrames\ndf = DataFrame(Tair = 20.0:1.0:30.0,pressure = 100.0, Rn = 500.0, G = 105.0, VPD = 2.0, Ga = 0.1) \nallowmissing!(df, Cols(:G)); df.G[1] = missing\n#\n# need to provide G explicitly\ndf_ET = potential_ET(df, Val(:PriestleyTaylor); G = df.G, infoGS = false)    \nismissing(df_ET.ET_pot[1])\n#\n# use coalesce to replace missing values\ndf_ET = potential_ET(df, Val(:PriestleyTaylor); G = coalesce.(df.G, zero(df.G)), infoGS = false)    \n!ismissing(df_ET.ET_pot[1])\n\n\n\n\n\npotential_ET(Tair, pressure, Rn, ::Val{:PriestleyTaylor}; ...)\npotential_ET(Tair, pressure, Rn, G, S, ::Val{:PriestleyTaylor}; ...)\n\npotential_ET(df, approach; ...)\npotential_ET!(df, approach; ...)\n\nPotential evapotranspiration according to Priestley & Taylor 1972 or the Penman-Monteith equation with a prescribed surface conductance.\n\nArguments\n\nTair:      Air temperature (degC)\npressure:  Atmospheric pressure (kPa)\nRn:        Net radiation (W m-2)\nVPD:       Vapor pressure deficit (kPa)\nGa:        Aerodynamic conductance to heat/water vapor (m s-1)\napproach:  Approach used.  Either Val(:PriestleyTaylor) (default), or Val(:PenmanMonteith).\ndf:      Data_frame or matrix containing all required variables; optional\n\noptional:\n\nG:         Ground heat flux (W m-2). Defaults to zero.\nS:         Sum of all storage fluxes (W m-2) . Defaults to zero.\nEsat_formula: formula used in Esat_from_Tair\nconstants=bigleaf_constants(): Dictionary with entries \ncp - specific heat of air for constant pressure (J K-1 kg-1) \neps - ratio of the molecular weight of water vapor to dry air \nPa2kPa - conversion pascal (Pa) to kilopascal (kPa) \nfor :PenmanMonteith:\nRd - gas constant of dry air (J kg-1 K-1)\nRgas - universal gas constant (J mol-1 K-1)\nKelvin - conversion degree Celsius to Kelvin\n\nadditional optional arguments with data.frame variants\n\ninfoGS=ture: sete to false to avoid infor log-message if G or S is not  specified\n\nadditional optional for PriestleyTaylor:\n\nalpha:     Priestley-Taylor coefficient\n\nadditional optional for PenmanMonteith:\n\nGs_pot:    Potential/maximum surface conductance (mol m-2 s-1);  defaults to 0.6 mol m-2 s-1;\n\nDetails\n\nPotential evapotranspiration is calculated according to Priestley & Taylor, 1972 if approach = Val(:PriestleyTaylor) (the defau LE_potPT = (alpha * Delta * (Rn - G - S))  (Delta + gamma)\n\nalpha is the Priestley-Taylor coefficient, Delta is the slope  of the saturation vapor pressure curve (kPa K-1), and gamma is the  psychrometric constant (kPa K-1). if approach = Val(:PenmanMonteith), potential evapotranspiration is calculated according to the Penman-Monteith equat\n\nLE_potPM = (Delta * (Rn - G - S) + rho * cp * VPD * Ga)   (Delta + gamma * (1 + GaGs_pot)\n\nwhere Delta is the slope of the saturation vapor pressure curve (kPa K-1), rho is the air density (kg m-3),  and gamma is the psychrometric constant (kPa K-1). The value of Gs_pot is typically a maximum value of Gs observed at the site, e.g. the 90th percentile of Gs within the growing season.\n\nGround heat flux and storage heat flux G or S are provided as optional  arguments. In the input-explicit variants, they default to zero. In the data-frame arguments, they default to missing, which results in assuming them to be zero which is displayed in a log-message. Note that in difference ot the bigleaf R package, you explitly need to care for missing values (see examples).\n\nBoth methods are provided with several forms:\n\nall required inputs as positional arguments\nproviding a DataFrame with columns corresponding to required inputs returning a DataFrame with only the result columns.\na mutating DataFrame version that returns the original DataFrame with result columns added or modified.\n\nValue\n\nNamedTuple or DataFrame with the following entries:\n\nET_pot: Potential evapotranspiration (kg m-2 s-1)\nLE_pot: Potential latent heat flux (W m-2)\n\nFor the mutating form, the original df with columns ET_pot, LE_pot  updated or added.\n\nReferences\n\nPriestley, CHB., Taylor, R_J., 1972: On the assessment of surface heat flux\n\nand evaporation using large-scale parameters. Monthly Weather Review 100, 81-92.  \n\nAllen, RG., Pereira LS., Raes D., Smith M., 1998: Crop evapotranspiration -\n\nGuidelines for computing crop water requirements - FAO Irrigation and drainage paper 56.\n\nNovick, K_A., et al. 2016: The increasing importance of atmospheric demand\n\nfor ecosystem water and carbon fluxes. Nature Climate Change 6, 1023 - 1027.\n\nSee also\n\nsurface_conductance\n\nExamples\n\nCalculate potential ET of a surface that receives a net radiation of 500 Wm-2 using Priestley-Taylor:\n\nTair,pressure,Rn = 30.0,100.0,500.0\nET_pot, LE_pot = potential_ET(Tair,pressure,Rn, Val(:PriestleyTaylor))    \n≈(ET_pot, 0.0002035969; rtol = 1e-5)\n\nCalculate potential ET for a surface with known Gs (0.5 mol m-2 s-1) and Ga (0.1 m s-1) using Penman-Monteith:\n\nTair,pressure,Rn = 30.0,100.0,500.0\nVPD, Ga = 2.0, 0.1\nET_pot, LE_pot = potential_ET(Tair,pressure,Rn,VPD, Ga, Val(:PenmanMonteith); Gs_pot=0.5,)    \n# now cross-check with the inverted equation\n#Ga2 = surface_conductance(Tair=20,pressure=100,VPD=2,Ga=0.1,Rn=400,LE=LE_pot_PM)\n#Ga2 ≈ GA\ntrue\n\nDataFrame variant with explicitly replacing missings:\n\nusing DataFrames\ndf = DataFrame(Tair = 20.0:1.0:30.0,pressure = 100.0, Rn = 500.0, G = 105.0, VPD = 2.0, Ga = 0.1) \nallowmissing!(df, Cols(:G)); df.G[1] = missing\n#\n# need to provide G explicitly\ndf_ET = potential_ET(df, Val(:PriestleyTaylor); G = df.G, infoGS = false)    \nismissing(df_ET.ET_pot[1])\n#\n# use coalesce to replace missing values\ndf_ET = potential_ET(df, Val(:PriestleyTaylor); G = coalesce.(df.G, zero(df.G)), infoGS = false)    \n!ismissing(df_ET.ET_pot[1])\n\n\n\n\n\npotential_ET(Tair, pressure, Rn, ::Val{:PriestleyTaylor}; ...)\npotential_ET(Tair, pressure, Rn, G, S, ::Val{:PriestleyTaylor}; ...)\n\npotential_ET(df, approach; ...)\npotential_ET!(df, approach; ...)\n\nPotential evapotranspiration according to Priestley & Taylor 1972 or the Penman-Monteith equation with a prescribed surface conductance.\n\nArguments\n\nTair:      Air temperature (degC)\npressure:  Atmospheric pressure (kPa)\nRn:        Net radiation (W m-2)\nVPD:       Vapor pressure deficit (kPa)\nGa:        Aerodynamic conductance to heat/water vapor (m s-1)\napproach:  Approach used.  Either Val(:PriestleyTaylor) (default), or Val(:PenmanMonteith).\ndf:      Data_frame or matrix containing all required variables; optional\n\noptional:\n\nG:         Ground heat flux (W m-2). Defaults to zero.\nS:         Sum of all storage fluxes (W m-2) . Defaults to zero.\nEsat_formula: formula used in Esat_from_Tair\nconstants=bigleaf_constants(): Dictionary with entries \ncp - specific heat of air for constant pressure (J K-1 kg-1) \neps - ratio of the molecular weight of water vapor to dry air \nPa2kPa - conversion pascal (Pa) to kilopascal (kPa) \nfor :PenmanMonteith:\nRd - gas constant of dry air (J kg-1 K-1)\nRgas - universal gas constant (J mol-1 K-1)\nKelvin - conversion degree Celsius to Kelvin\n\nadditional optional arguments with data.frame variants\n\ninfoGS=ture: sete to false to avoid infor log-message if G or S is not  specified\n\nadditional optional for PriestleyTaylor:\n\nalpha:     Priestley-Taylor coefficient\n\nadditional optional for PenmanMonteith:\n\nGs_pot:    Potential/maximum surface conductance (mol m-2 s-1);  defaults to 0.6 mol m-2 s-1;\n\nDetails\n\nPotential evapotranspiration is calculated according to Priestley & Taylor, 1972 if approach = Val(:PriestleyTaylor) (the defau LE_potPT = (alpha * Delta * (Rn - G - S))  (Delta + gamma)\n\nalpha is the Priestley-Taylor coefficient, Delta is the slope  of the saturation vapor pressure curve (kPa K-1), and gamma is the  psychrometric constant (kPa K-1). if approach = Val(:PenmanMonteith), potential evapotranspiration is calculated according to the Penman-Monteith equat\n\nLE_potPM = (Delta * (Rn - G - S) + rho * cp * VPD * Ga)   (Delta + gamma * (1 + GaGs_pot)\n\nwhere Delta is the slope of the saturation vapor pressure curve (kPa K-1), rho is the air density (kg m-3),  and gamma is the psychrometric constant (kPa K-1). The value of Gs_pot is typically a maximum value of Gs observed at the site, e.g. the 90th percentile of Gs within the growing season.\n\nGround heat flux and storage heat flux G or S are provided as optional  arguments. In the input-explicit variants, they default to zero. In the data-frame arguments, they default to missing, which results in assuming them to be zero which is displayed in a log-message. Note that in difference ot the bigleaf R package, you explitly need to care for missing values (see examples).\n\nBoth methods are provided with several forms:\n\nall required inputs as positional arguments\nproviding a DataFrame with columns corresponding to required inputs returning a DataFrame with only the result columns.\na mutating DataFrame version that returns the original DataFrame with result columns added or modified.\n\nValue\n\nNamedTuple or DataFrame with the following entries:\n\nET_pot: Potential evapotranspiration (kg m-2 s-1)\nLE_pot: Potential latent heat flux (W m-2)\n\nFor the mutating form, the original df with columns ET_pot, LE_pot  updated or added.\n\nReferences\n\nPriestley, CHB., Taylor, R_J., 1972: On the assessment of surface heat flux\n\nand evaporation using large-scale parameters. Monthly Weather Review 100, 81-92.  \n\nAllen, RG., Pereira LS., Raes D., Smith M., 1998: Crop evapotranspiration -\n\nGuidelines for computing crop water requirements - FAO Irrigation and drainage paper 56.\n\nNovick, K_A., et al. 2016: The increasing importance of atmospheric demand\n\nfor ecosystem water and carbon fluxes. Nature Climate Change 6, 1023 - 1027.\n\nSee also\n\nsurface_conductance\n\nExamples\n\nCalculate potential ET of a surface that receives a net radiation of 500 Wm-2 using Priestley-Taylor:\n\nTair,pressure,Rn = 30.0,100.0,500.0\nET_pot, LE_pot = potential_ET(Tair,pressure,Rn, Val(:PriestleyTaylor))    \n≈(ET_pot, 0.0002035969; rtol = 1e-5)\n\nCalculate potential ET for a surface with known Gs (0.5 mol m-2 s-1) and Ga (0.1 m s-1) using Penman-Monteith:\n\nTair,pressure,Rn = 30.0,100.0,500.0\nVPD, Ga = 2.0, 0.1\nET_pot, LE_pot = potential_ET(Tair,pressure,Rn,VPD, Ga, Val(:PenmanMonteith); Gs_pot=0.5,)    \n# now cross-check with the inverted equation\n#Ga2 = surface_conductance(Tair=20,pressure=100,VPD=2,Ga=0.1,Rn=400,LE=LE_pot_PM)\n#Ga2 ≈ GA\ntrue\n\nDataFrame variant with explicitly replacing missings:\n\nusing DataFrames\ndf = DataFrame(Tair = 20.0:1.0:30.0,pressure = 100.0, Rn = 500.0, G = 105.0, VPD = 2.0, Ga = 0.1) \nallowmissing!(df, Cols(:G)); df.G[1] = missing\n#\n# need to provide G explicitly\ndf_ET = potential_ET(df, Val(:PriestleyTaylor); G = df.G, infoGS = false)    \nismissing(df_ET.ET_pot[1])\n#\n# use coalesce to replace missing values\ndf_ET = potential_ET(df, Val(:PriestleyTaylor); G = coalesce.(df.G, zero(df.G)), infoGS = false)    \n!ismissing(df_ET.ET_pot[1])\n\n\n\n\n\n","category":"function"},{"location":"evapotranspiration/#Bigleaf.equilibrium_imposed_ET","page":"-","title":"Bigleaf.equilibrium_imposed_ET","text":"equilibrium_imposed_ET(Tair,pressure,VPD,Gs, Rn; ...)\nequilibrium_imposed_ET(df; ...)\nequilibrium_imposed_ET!(df; ...)\n\nEvapotranspiration (ET) split up into imposed ET and equilibrium ET.\n\nArgumens\n\nTair:      Air temperature (deg C)\npressure:  Atmospheric pressure (kPa)\nVPD:       Air vapor pressure deficit (kPa)\nGs:        surface conductance to water vapor (m s-1)\nRn:        Net radiation (W m-2)\n\noptional \n\nG:         Ground heat flux (W m-2); optional\nS:         Sum of all storage fluxes (W m-2); optional\nEsat_formula: formula used in Esat_from_Tair\nconstants=bigleaf_constants(): Dictionary with entries \ncp - specific heat of air for constant pressure (J K-1 kg-1) \neps - ratio of the molecular weight of water vapor to dry  (-) \nPa2kPa - conversion pascal (Pa) to kilopascal (kPa)\n\nDetails\n\nTotal evapotranspiration can be written in the form (Jarvis & McNaughton 6):\n\nET = Omega ET_eq + (1 - Omega)ET_imp\n\nwhere Omega is the decoupling coefficient as calculated from decoupling. ET_eq is the equilibrium evapotranspiration i.e., the ET rate that would occur under uncoupled conditions, where the budget is dominated by radiation (when Ga -> 0):\n\nET_eq = (Delta * (Rn - G - S) * lambda)  ( Delta gamma)\n\nwhere Delta is the slope of the saturation vapor pressur(kPa K-1), lambda is the latent heat of vaporization (J kg-1), and gamma is the psychrometric constant (kPa K-1). ET_imp is the imposed evapotranspiration rate, the ET rate that would occur under fully coupled conditions (when Ga -> inf):\n\nET_imp = (rho * cp * VPD * Gs * lambda)  gamma\n\nwhere rho is the air density (kg m-3).\n\nNote\n\nSurface conductance (Gs) can be calculated with surface_conductance       Aerodynamic conductance (Ga) can be calculated using aerodynamic_conductance.\n\nValue\n\nA NamedTuple or DataFrame with the following columns:\n\nET_eq: Equilibrium ET (kg m-2 s-1)\nET_imp: Imposed ET (kg m-2 s-1)\nLE_eq: Equilibrium LE (W m-2)\nLE_imp: Imposed LE (W m-2)      \n\nReferences\n\nJarvis, PG., McNaughton, KG., 1986: Stomatal control of transpiration: scaling up from leaf to region. Advances in Ecological Rese1-49.\nMonteith, JL., Unsworth, MH., 2008: Principles of ironmPhysics. 3rd edition. Academic Press, London. \n\nExamples\n\nTair,pressure,Rn, VPD, Gs = 20.0,100.0,50.0, 0.5, 0.01\nET_eq, ET_imp, LE_eq, LE_imp = equilibrium_imposed_ET(Tair,pressure,VPD,Gs, Rn)    \n≈(ET_eq, 1.399424e-05; rtol = 1e-5)\n\n\n\n\n\nequilibrium_imposed_ET(Tair,pressure,VPD,Gs, Rn; ...)\nequilibrium_imposed_ET(df; ...)\nequilibrium_imposed_ET!(df; ...)\n\nEvapotranspiration (ET) split up into imposed ET and equilibrium ET.\n\nArgumens\n\nTair:      Air temperature (deg C)\npressure:  Atmospheric pressure (kPa)\nVPD:       Air vapor pressure deficit (kPa)\nGs:        surface conductance to water vapor (m s-1)\nRn:        Net radiation (W m-2)\n\noptional \n\nG:         Ground heat flux (W m-2); optional\nS:         Sum of all storage fluxes (W m-2); optional\nEsat_formula: formula used in Esat_from_Tair\nconstants=bigleaf_constants(): Dictionary with entries \ncp - specific heat of air for constant pressure (J K-1 kg-1) \neps - ratio of the molecular weight of water vapor to dry  (-) \nPa2kPa - conversion pascal (Pa) to kilopascal (kPa)\n\nDetails\n\nTotal evapotranspiration can be written in the form (Jarvis & McNaughton 6):\n\nET = Omega ET_eq + (1 - Omega)ET_imp\n\nwhere Omega is the decoupling coefficient as calculated from decoupling. ET_eq is the equilibrium evapotranspiration i.e., the ET rate that would occur under uncoupled conditions, where the budget is dominated by radiation (when Ga -> 0):\n\nET_eq = (Delta * (Rn - G - S) * lambda)  ( Delta gamma)\n\nwhere Delta is the slope of the saturation vapor pressur(kPa K-1), lambda is the latent heat of vaporization (J kg-1), and gamma is the psychrometric constant (kPa K-1). ET_imp is the imposed evapotranspiration rate, the ET rate that would occur under fully coupled conditions (when Ga -> inf):\n\nET_imp = (rho * cp * VPD * Gs * lambda)  gamma\n\nwhere rho is the air density (kg m-3).\n\nNote\n\nSurface conductance (Gs) can be calculated with surface_conductance       Aerodynamic conductance (Ga) can be calculated using aerodynamic_conductance.\n\nValue\n\nA NamedTuple or DataFrame with the following columns:\n\nET_eq: Equilibrium ET (kg m-2 s-1)\nET_imp: Imposed ET (kg m-2 s-1)\nLE_eq: Equilibrium LE (W m-2)\nLE_imp: Imposed LE (W m-2)      \n\nReferences\n\nJarvis, PG., McNaughton, KG., 1986: Stomatal control of transpiration: scaling up from leaf to region. Advances in Ecological Rese1-49.\nMonteith, JL., Unsworth, MH., 2008: Principles of ironmPhysics. 3rd edition. Academic Press, London. \n\nExamples\n\nTair,pressure,Rn, VPD, Gs = 20.0,100.0,50.0, 0.5, 0.01\nET_eq, ET_imp, LE_eq, LE_imp = equilibrium_imposed_ET(Tair,pressure,VPD,Gs, Rn)    \n≈(ET_eq, 1.399424e-05; rtol = 1e-5)\n\n\n\n\n\nequilibrium_imposed_ET(Tair,pressure,VPD,Gs, Rn; ...)\nequilibrium_imposed_ET(df; ...)\nequilibrium_imposed_ET!(df; ...)\n\nEvapotranspiration (ET) split up into imposed ET and equilibrium ET.\n\nArgumens\n\nTair:      Air temperature (deg C)\npressure:  Atmospheric pressure (kPa)\nVPD:       Air vapor pressure deficit (kPa)\nGs:        surface conductance to water vapor (m s-1)\nRn:        Net radiation (W m-2)\n\noptional \n\nG:         Ground heat flux (W m-2); optional\nS:         Sum of all storage fluxes (W m-2); optional\nEsat_formula: formula used in Esat_from_Tair\nconstants=bigleaf_constants(): Dictionary with entries \ncp - specific heat of air for constant pressure (J K-1 kg-1) \neps - ratio of the molecular weight of water vapor to dry  (-) \nPa2kPa - conversion pascal (Pa) to kilopascal (kPa)\n\nDetails\n\nTotal evapotranspiration can be written in the form (Jarvis & McNaughton 6):\n\nET = Omega ET_eq + (1 - Omega)ET_imp\n\nwhere Omega is the decoupling coefficient as calculated from decoupling. ET_eq is the equilibrium evapotranspiration i.e., the ET rate that would occur under uncoupled conditions, where the budget is dominated by radiation (when Ga -> 0):\n\nET_eq = (Delta * (Rn - G - S) * lambda)  ( Delta gamma)\n\nwhere Delta is the slope of the saturation vapor pressur(kPa K-1), lambda is the latent heat of vaporization (J kg-1), and gamma is the psychrometric constant (kPa K-1). ET_imp is the imposed evapotranspiration rate, the ET rate that would occur under fully coupled conditions (when Ga -> inf):\n\nET_imp = (rho * cp * VPD * Gs * lambda)  gamma\n\nwhere rho is the air density (kg m-3).\n\nNote\n\nSurface conductance (Gs) can be calculated with surface_conductance       Aerodynamic conductance (Ga) can be calculated using aerodynamic_conductance.\n\nValue\n\nA NamedTuple or DataFrame with the following columns:\n\nET_eq: Equilibrium ET (kg m-2 s-1)\nET_imp: Imposed ET (kg m-2 s-1)\nLE_eq: Equilibrium LE (W m-2)\nLE_imp: Imposed LE (W m-2)      \n\nReferences\n\nJarvis, PG., McNaughton, KG., 1986: Stomatal control of transpiration: scaling up from leaf to region. Advances in Ecological Rese1-49.\nMonteith, JL., Unsworth, MH., 2008: Principles of ironmPhysics. 3rd edition. Academic Press, London. \n\nExamples\n\nTair,pressure,Rn, VPD, Gs = 20.0,100.0,50.0, 0.5, 0.01\nET_eq, ET_imp, LE_eq, LE_imp = equilibrium_imposed_ET(Tair,pressure,VPD,Gs, Rn)    \n≈(ET_eq, 1.399424e-05; rtol = 1e-5)\n\n\n\n\n\n","category":"function"},{"location":"","page":"Home","title":"Home","text":"CurrentModule = Bigleaf","category":"page"},{"location":"#Bigleaf","page":"Home","title":"Bigleaf","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Documentation for Bigleaf.","category":"page"},{"location":"","page":"Home","title":"Home","text":"Pages = [\"index.md\",]","category":"page"},{"location":"#Meteorological-variables","page":"Home","title":"Meteorological variables","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Pages = [\"metorological_variables.md\",]","category":"page"},{"location":"#Evapotranspiration","page":"Home","title":"Evapotranspiration","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Pages = [\"evapotranspiration.md\",]","category":"page"},{"location":"#Global-radiation","page":"Home","title":"Global radiation","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Pages = [\"global_radiation.md\",]","category":"page"},{"location":"#Unit-conversions","page":"Home","title":"Unit conversions","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Pages = [\"unit_conversions.md\",\"bigleaf_constants.md\",]","category":"page"},{"location":"autodocs/","page":"Index","title":"Index","text":"CurrentModule = Bigleaf","category":"page"},{"location":"autodocs/#Index","page":"Index","title":"Index","text":"","category":"section"},{"location":"autodocs/","page":"Index","title":"Index","text":"","category":"page"},{"location":"autodocs/#Autodocs","page":"Index","title":"Autodocs","text":"","category":"section"},{"location":"autodocs/","page":"Index","title":"Index","text":"Modules = [Bigleaf]","category":"page"},{"location":"autodocs/#Bigleaf.ET_to_LE-Tuple{Any, Any}","page":"Index","title":"Bigleaf.ET_to_LE","text":"LE_to_ET(LE,Tair)\nET_to_LE(ET,Tair)\n\nConvert evaporative water flux from mass (ET=evapotranspiration)              to energy (LE=latent heat flux) units, or vice versa.\n\nArguments\n\nLE   Latent heat flux (W m-2)\nET   Evapotranspiration (kg m-2 s-1)\nTair Air temperature (deg C)\n\nDetails\n\nThe conversions are given by:\n\nET = LElambda\nLE = lambda ET\n\nwhere lambda is the latent heat of vaporization (J kg-1) as calculated by latent_heat_vaporization.\n\nExamples\n\n# LE of 200 Wm-2 and air temperature of 25degC\nET = LE_to_ET(200,25)\n≈(ET, 8.19e-5, atol =1e-7)\n\n\n\n\n\n","category":"method"},{"location":"autodocs/#Bigleaf.Esat_from_Tair-Tuple{Any}","page":"Index","title":"Bigleaf.Esat_from_Tair","text":"Esat_slope(Tair; formula, constants) \nEsat_from_Tair(Tair; formula, constants) \nEsat_from_Tair_deriv(Tair; formula, constants)\n\nSaturation Vapor Pressure (Esat) and Slope of the Esat Curve\n\nArguemtns\n\nTair:      Air temperature (deg C)\nformula=Val(:Sonntag_1990):   Formula to be used. Either   Val(:Sonntag_1990) (Default), Val(:Alduchov_1996, or Val(:Allen_1998).\nconstants=bigleaf_constants(): Dictionary with entry  :Pa2kPa \n\nDetails\n\nEsat (kPa) is calculated using the Magnus equation:\n\nEsat = a * exp((b * Tair) / (c + Tair)) / 1000 where the coefficients a, b, c take different values depending on the formula use The default values are from Sonntag 1990 (a=611.2, b=17.62, c=243.12). This versi of the Magnus equation is recommended by the WMO (WMO 2008; p1.4-29). Alternativel parameter values determined by Alduchov & Eskridge 1996 or Allen et al. 1998 can b used (see references). The slope of the Esat curve (Delta) is calculated as the first derivative of the function:\n\nDelta = dEsat over dTair\n\nValue\n\nEsat_from_Tair: Saturation vapor pressure (kPa)\nEsat_from_Tair_deriv: Slope of the saturation vapor pressure curve (kPa K-1)\nEsat_slope: A tuple of the two above values\n\nReferences\n\nSonntag D. 1990: Important new values of the physical constants of 1986, vapor  pressure formulations based on the ITS-90 and psychrometric formulae.  Zeitschrift fuer Meteorologie 70, 340-344.\n\nWorld Meteorological Organization 2008: Guide to Meteorological Instruments and Methods of Observation (WMO-No.8). World Meteorological Organization, Geneva. 7th Edition,\n\nAlduchov, O. A. & Eskridge, R. E., 1996: Improved Magnus form approximation of  saturation vapor pressure. Journal of Applied Meteorology, 35, 601-609\n\nAllen, R.G., Pereira, L.S., Raes, D., Smith, M., 1998: Crop evapotranspiration - Guidelines for computing crop water requirements - FAO irrigation and drainage paper 56, FAO, Rome.\n\nEsat_from_Tair(20.0)          # Esat in kPa\nEsat_from_Tair_deriv(20.0)    # its derivative to temperature in kPa K-1\nEsat_slope(20.0)              # both as a tuple\n\n\n\n\n\n","category":"method"},{"location":"autodocs/#Bigleaf.Esat_from_Tair_deriv-Tuple{Any}","page":"Index","title":"Bigleaf.Esat_from_Tair_deriv","text":"Esat_slope(Tair; formula, constants) \nEsat_from_Tair(Tair; formula, constants) \nEsat_from_Tair_deriv(Tair; formula, constants)\n\nSaturation Vapor Pressure (Esat) and Slope of the Esat Curve\n\nArguemtns\n\nTair:      Air temperature (deg C)\nformula=Val(:Sonntag_1990):   Formula to be used. Either   Val(:Sonntag_1990) (Default), Val(:Alduchov_1996, or Val(:Allen_1998).\nconstants=bigleaf_constants(): Dictionary with entry  :Pa2kPa \n\nDetails\n\nEsat (kPa) is calculated using the Magnus equation:\n\nEsat = a * exp((b * Tair) / (c + Tair)) / 1000 where the coefficients a, b, c take different values depending on the formula use The default values are from Sonntag 1990 (a=611.2, b=17.62, c=243.12). This versi of the Magnus equation is recommended by the WMO (WMO 2008; p1.4-29). Alternativel parameter values determined by Alduchov & Eskridge 1996 or Allen et al. 1998 can b used (see references). The slope of the Esat curve (Delta) is calculated as the first derivative of the function:\n\nDelta = dEsat over dTair\n\nValue\n\nEsat_from_Tair: Saturation vapor pressure (kPa)\nEsat_from_Tair_deriv: Slope of the saturation vapor pressure curve (kPa K-1)\nEsat_slope: A tuple of the two above values\n\nReferences\n\nSonntag D. 1990: Important new values of the physical constants of 1986, vapor  pressure formulations based on the ITS-90 and psychrometric formulae.  Zeitschrift fuer Meteorologie 70, 340-344.\n\nWorld Meteorological Organization 2008: Guide to Meteorological Instruments and Methods of Observation (WMO-No.8). World Meteorological Organization, Geneva. 7th Edition,\n\nAlduchov, O. A. & Eskridge, R. E., 1996: Improved Magnus form approximation of  saturation vapor pressure. Journal of Applied Meteorology, 35, 601-609\n\nAllen, R.G., Pereira, L.S., Raes, D., Smith, M., 1998: Crop evapotranspiration - Guidelines for computing crop water requirements - FAO irrigation and drainage paper 56, FAO, Rome.\n\nEsat_from_Tair(20.0)          # Esat in kPa\nEsat_from_Tair_deriv(20.0)    # its derivative to temperature in kPa K-1\nEsat_slope(20.0)              # both as a tuple\n\n\n\n\n\n","category":"method"},{"location":"autodocs/#Bigleaf.Esat_slope-Tuple{Number}","page":"Index","title":"Bigleaf.Esat_slope","text":"Esat_slope(Tair; formula, constants) \nEsat_from_Tair(Tair; formula, constants) \nEsat_from_Tair_deriv(Tair; formula, constants)\n\nSaturation Vapor Pressure (Esat) and Slope of the Esat Curve\n\nArguemtns\n\nTair:      Air temperature (deg C)\nformula=Val(:Sonntag_1990):   Formula to be used. Either   Val(:Sonntag_1990) (Default), Val(:Alduchov_1996, or Val(:Allen_1998).\nconstants=bigleaf_constants(): Dictionary with entry  :Pa2kPa \n\nDetails\n\nEsat (kPa) is calculated using the Magnus equation:\n\nEsat = a * exp((b * Tair) / (c + Tair)) / 1000 where the coefficients a, b, c take different values depending on the formula use The default values are from Sonntag 1990 (a=611.2, b=17.62, c=243.12). This versi of the Magnus equation is recommended by the WMO (WMO 2008; p1.4-29). Alternativel parameter values determined by Alduchov & Eskridge 1996 or Allen et al. 1998 can b used (see references). The slope of the Esat curve (Delta) is calculated as the first derivative of the function:\n\nDelta = dEsat over dTair\n\nValue\n\nEsat_from_Tair: Saturation vapor pressure (kPa)\nEsat_from_Tair_deriv: Slope of the saturation vapor pressure curve (kPa K-1)\nEsat_slope: A tuple of the two above values\n\nReferences\n\nSonntag D. 1990: Important new values of the physical constants of 1986, vapor  pressure formulations based on the ITS-90 and psychrometric formulae.  Zeitschrift fuer Meteorologie 70, 340-344.\n\nWorld Meteorological Organization 2008: Guide to Meteorological Instruments and Methods of Observation (WMO-No.8). World Meteorological Organization, Geneva. 7th Edition,\n\nAlduchov, O. A. & Eskridge, R. E., 1996: Improved Magnus form approximation of  saturation vapor pressure. Journal of Applied Meteorology, 35, 601-609\n\nAllen, R.G., Pereira, L.S., Raes, D., Smith, M., 1998: Crop evapotranspiration - Guidelines for computing crop water requirements - FAO irrigation and drainage paper 56, FAO, Rome.\n\nEsat_from_Tair(20.0)          # Esat in kPa\nEsat_from_Tair_deriv(20.0)    # its derivative to temperature in kPa K-1\nEsat_slope(20.0)              # both as a tuple\n\n\n\n\n\n","category":"method"},{"location":"autodocs/#Bigleaf.LE_to_ET-Tuple{Any, Any}","page":"Index","title":"Bigleaf.LE_to_ET","text":"LE_to_ET(LE,Tair)\nET_to_LE(ET,Tair)\n\nConvert evaporative water flux from mass (ET=evapotranspiration)              to energy (LE=latent heat flux) units, or vice versa.\n\nArguments\n\nLE   Latent heat flux (W m-2)\nET   Evapotranspiration (kg m-2 s-1)\nTair Air temperature (deg C)\n\nDetails\n\nThe conversions are given by:\n\nET = LElambda\nLE = lambda ET\n\nwhere lambda is the latent heat of vaporization (J kg-1) as calculated by latent_heat_vaporization.\n\nExamples\n\n# LE of 200 Wm-2 and air temperature of 25degC\nET = LE_to_ET(200,25)\n≈(ET, 8.19e-5, atol =1e-7)\n\n\n\n\n\n","category":"method"},{"location":"autodocs/#Bigleaf.PPFD_to_Rg","page":"Index","title":"Bigleaf.PPFD_to_Rg","text":"Rg_to_PPFD(Rg,J_to_mol=4.6,frac_PAR=0.5)\nPPFD_to_Rg(PPFD,J_to_mol=4.6,frac_PAR=0.5)\n\nConversions between Global Radiation (W m-2) and Photosynthetic Photon Flux  Density (umol m-2 s-1)\n\nArguments\n\nRg:       Global radiation = incoming short-wave radiation at the surface (W m-2)\nPPFD:     Photosynthetic photon flux density (umol m-2 s-1)\nJtomol: Conversion factor from J m-2 s-1 (= W m-2) to umol (quanta) m-2 s-1\nfrac_PAR: Fraction of incoming solar irradiance that is photosynthetical-           active radiation (PAR); defaults to 0.5\n\nDetails\n\nThe conversion is given by:\n\nPPFD = Rg * frac_PAR * J_to_mol\n\nby default, the combined conversion factor (frac_PAR * J_to_mol) is 2.3\n\nExamples\n\n# convert a measured incoming short-wave radiation of 500 Wm-2 to\n# PPFD in umol m-2 s-1 and backwards\nRg_to_PPFD(500)\nPPFD_to_Rg(1150)\n\n\n\n\n\n","category":"function"},{"location":"autodocs/#Bigleaf.Rg_to_PPFD","page":"Index","title":"Bigleaf.Rg_to_PPFD","text":"Rg_to_PPFD(Rg,J_to_mol=4.6,frac_PAR=0.5)\nPPFD_to_Rg(PPFD,J_to_mol=4.6,frac_PAR=0.5)\n\nConversions between Global Radiation (W m-2) and Photosynthetic Photon Flux  Density (umol m-2 s-1)\n\nArguments\n\nRg:       Global radiation = incoming short-wave radiation at the surface (W m-2)\nPPFD:     Photosynthetic photon flux density (umol m-2 s-1)\nJtomol: Conversion factor from J m-2 s-1 (= W m-2) to umol (quanta) m-2 s-1\nfrac_PAR: Fraction of incoming solar irradiance that is photosynthetical-           active radiation (PAR); defaults to 0.5\n\nDetails\n\nThe conversion is given by:\n\nPPFD = Rg * frac_PAR * J_to_mol\n\nby default, the combined conversion factor (frac_PAR * J_to_mol) is 2.3\n\nExamples\n\n# convert a measured incoming short-wave radiation of 500 Wm-2 to\n# PPFD in umol m-2 s-1 and backwards\nRg_to_PPFD(500)\nPPFD_to_Rg(1150)\n\n\n\n\n\n","category":"function"},{"location":"autodocs/#Bigleaf.VPD_to_e-Tuple{Any, Any}","page":"Index","title":"Bigleaf.VPD_to_e","text":"VPD_to_rH(VPD,Tair; ...)\nH_to_VPD(rH,Tair; ...)\ne_to_rH(e,Tair; ...)\nVPD_to_e(VPD,Tair; ...)\ne_to_VPD(e,Tair; ...)\ne_to_q(e,pressure; ...)\nq_to_e(q,pressure; ...)\nq_to_VPD(q,Tair,pressure; ...)\nVPD_to_q(VPD,Tair,pressure; ...)\n\nConversion between vapor pressure (e), vapor pressure deficit (VPD),              specific humidity (q), and relative humidity (rH).\n\nArguments\n\nTair:      Air temperature (deg C)\npressure:  Atmospheric pressure (kPa)\ne:         Vapor pressure (kPa)\nq:        Specific humidity (kg kg-1)\nVPD:       Vapor pressure deficit (kPa)\nrH:        Relative humidity (-)\n\nAll functions accept the optional arguemtns:\n\nEsat_formula: formula used in Esat_from_Tair\nconstants: dictionary from bigleaf_constants with entries eps and Pa2kPa\n\nRreferences\n\nFoken, T, 2008: Micrometeorology_ Springer, Berlin, Germany.\n\n\n\n\n\n","category":"method"},{"location":"autodocs/#Bigleaf.VPD_to_q-Tuple{Any, Any, Any}","page":"Index","title":"Bigleaf.VPD_to_q","text":"VPD_to_rH(VPD,Tair; ...)\nH_to_VPD(rH,Tair; ...)\ne_to_rH(e,Tair; ...)\nVPD_to_e(VPD,Tair; ...)\ne_to_VPD(e,Tair; ...)\ne_to_q(e,pressure; ...)\nq_to_e(q,pressure; ...)\nq_to_VPD(q,Tair,pressure; ...)\nVPD_to_q(VPD,Tair,pressure; ...)\n\nConversion between vapor pressure (e), vapor pressure deficit (VPD),              specific humidity (q), and relative humidity (rH).\n\nArguments\n\nTair:      Air temperature (deg C)\npressure:  Atmospheric pressure (kPa)\ne:         Vapor pressure (kPa)\nq:        Specific humidity (kg kg-1)\nVPD:       Vapor pressure deficit (kPa)\nrH:        Relative humidity (-)\n\nAll functions accept the optional arguemtns:\n\nEsat_formula: formula used in Esat_from_Tair\nconstants: dictionary from bigleaf_constants with entries eps and Pa2kPa\n\nRreferences\n\nFoken, T, 2008: Micrometeorology_ Springer, Berlin, Germany.\n\n\n\n\n\n","category":"method"},{"location":"autodocs/#Bigleaf.VPD_to_rH-Tuple{Any, Any}","page":"Index","title":"Bigleaf.VPD_to_rH","text":"VPD_to_rH(VPD,Tair; ...)\nH_to_VPD(rH,Tair; ...)\ne_to_rH(e,Tair; ...)\nVPD_to_e(VPD,Tair; ...)\ne_to_VPD(e,Tair; ...)\ne_to_q(e,pressure; ...)\nq_to_e(q,pressure; ...)\nq_to_VPD(q,Tair,pressure; ...)\nVPD_to_q(VPD,Tair,pressure; ...)\n\nConversion between vapor pressure (e), vapor pressure deficit (VPD),              specific humidity (q), and relative humidity (rH).\n\nArguments\n\nTair:      Air temperature (deg C)\npressure:  Atmospheric pressure (kPa)\ne:         Vapor pressure (kPa)\nq:        Specific humidity (kg kg-1)\nVPD:       Vapor pressure deficit (kPa)\nrH:        Relative humidity (-)\n\nAll functions accept the optional arguemtns:\n\nEsat_formula: formula used in Esat_from_Tair\nconstants: dictionary from bigleaf_constants with entries eps and Pa2kPa\n\nRreferences\n\nFoken, T, 2008: Micrometeorology_ Springer, Berlin, Germany.\n\n\n\n\n\n","category":"method"},{"location":"autodocs/#Bigleaf.aerodynamic_conductance-Tuple{}","page":"Index","title":"Bigleaf.aerodynamic_conductance","text":"TODO; implement aerodynamic_conductance.\n\nThis stub is there to satisfy links im Help-pages.\n\n\n\n\n\n","category":"method"},{"location":"autodocs/#Bigleaf.air_density-Tuple{Any, Any}","page":"Index","title":"Bigleaf.air_density","text":"air_density(Tair,pressure; ...)\n\nAir density of moist air from air temperature and pressure_\n\nArguments\n\nTair:      Air temperature (deg C)\npressure:  Atmospheric pressure (kPa)\n\noptional \n\nconstants=bigleaf_constants(): Dictionary with entries   Kelvin, kPa2Pa\n\nDetails\n\nAir density rho is calculated as:\n\nrho = pressure over Rd * Tair\n\nValue\n\nair density (kg m-3)\n\nExamples\n\n# air density at 25degC and standard pressure (101.325kPa)\nair_density(25,101.325)\n\nReferences\n\nFoken, T, 2008: Micrometeorology. Springer, Berlin, Germany.\n\n\n\n\n\n","category":"method"},{"location":"autodocs/#Bigleaf.bigleaf_constants-Tuple{}","page":"Index","title":"Bigleaf.bigleaf_constants","text":"bigleaf_constants(;...)\n\nConstants Used in the Bigleaf.jl Package\n\nReturn a Dictionary Dict{Symbol, Real}. Default values can be overridden by the named arguments:\n\ncp           Specific heat of air for constant pressure (J K-1 kg-1)\nRgas         Universal gas constant (J mol-1 K-1)\nRv           Gas constant of water vapor (J kg-1 K-1) (Stull 1988 p.641)\nRd           Gas constant of dry air (J kg-1 K-1) (Foken p. 245)\nMd           Molar mass of dry air (kg mol-1)\nMw           Molar mass of water vapor (kg mol-1)\neps          Ratio of the molecular weight of water vapor to dry air (=Mw/Md)\ng            Gravitational acceleration (m s-2)\nsolar_constant Solar constant (W m-2)\npressure0    Reference atmospheric pressure at sea level (Pa)\nTair0        Reference air temperature (K)\nk            von Karman constant\nCmol         Molar mass of carbon (kg mol-1)\nOmol         Molar mass of oxygen (kg mol-1)\nH2Omol       Molar mass of water (kg mol-1)\nsigma        Stefan-Boltzmann constant (W m-2 K-4)\nPr           Prandtl number\nSc_CO2       Schmidt number for CO2\nKelvin       Conversion degree Celsius to Kelvin\nDwDc         Ratio of the molecular diffusivities for water vapor and CO2\ndays2seconds Seconds per day\nkPa2Pa       Conversion kilopascal (kPa) to pascal (Pa)\nPa2kPa       Conversion pascal (Pa) to kilopascal (kPa)\numol2mol     Conversion micromole (umol) to mole (mol)\nmol2umol     Conversion mole (mol) to micromole (umol)\nkg2g         Conversion kilogram (kg) to gram (g)\ng2kg         Conversion gram (g) to kilogram (kg)\nkJ2J         Conversion kilojoule (kJ) to joule (J)\nJ2kJ         Conversion joule (J) to kilojoule (kJ)\nse_median    Conversion standard error (SE) of the mean to SE of the median\nfrac2percent Conversion between fraction and percent\n\n\n\n\n\n","category":"method"},{"location":"autodocs/#Bigleaf.calc_sun_position_MOD-Tuple{Number}","page":"Index","title":"Bigleaf.calc_sun_position_MOD","text":"calc_sun_position_MOD(JD::Number)\n\nCompute the Sun position at the Julian Day JD.\n\nResults are represented in the Mean Equinox of Date (MOD), i.e. accounting for precession but not for nutation and smaller pertubation of the polar axes, in spherical ecliptic and equatorial coordinates.  The algorithm was adapted from [Vallado 2013, p. 277-279].\n\nArguments:\n\nJD: time given as Julian Day . \n\nValue\n\nNamedTuple: sun position where\n\nEcliptic coordinates (1:3)\nλ: Ecliptic longitude of the Sun [rad].\nβ: Ecliptic latitude of the Sun [rad] is assumed 0.\nr: Distance of the Sun from Earth [m].\nEquatorial coordinate (4:5)  \nα: ascention [rad]\nδ: declination [rad]\nϵ: Obliquity of the ecliptic [rad].\n\nReferences\n\nVallado, D. A (2013). Fundamentals of Astrodynamics and Applications.      Microcosm Press, Hawthorne, CA.\n\n\n\n\n\n","category":"method"},{"location":"autodocs/#Bigleaf.calc_sun_position_hor-Tuple{Dates.DateTime, Any, Any}","page":"Index","title":"Bigleaf.calc_sun_position_hor","text":"calc_sun_position_hor(datetime, lat, long)\n\nCompute the Sun position at given time and observer coordinates in horizontal coordinates.\n\nArguments:\n\ndatetime: time: Either a ZonedDateTime, or DateTime assumed in UTC\nlat, long: latitude and longitude in degree\n\nValue\n\nNamedTuple: sun position with entries\n\naltitude: angle above the horizon [rad].\nazimuth: angle ange the horizon plane eastwards of north [rad]\nhourangle: [rad] as output by AstroLib.eq2hor  Seems to represent time [day/2pi] after solar noon.   Value at local timezone noon provdes (local time - solar time).\n\n\n\n\n\n","category":"method"},{"location":"autodocs/#Bigleaf.calc_sun_position_hor-Tuple{TimeZones.ZonedDateTime, Any, Any}","page":"Index","title":"Bigleaf.calc_sun_position_hor","text":"calc_sun_position_hor(datetime, lat, long)\n\nCompute the Sun position at given time and observer coordinates in horizontal coordinates.\n\nArguments:\n\ndatetime: time: Either a ZonedDateTime, or DateTime assumed in UTC\nlat, long: latitude and longitude in degree\n\nValue\n\nNamedTuple: sun position with entries\n\naltitude: angle above the horizon [rad].\nazimuth: angle ange the horizon plane eastwards of north [rad]\nhourangle: [rad] as output by AstroLib.eq2hor  Seems to represent time [day/2pi] after solar noon.   Value at local timezone noon provdes (local time - solar time).\n\n\n\n\n\n","category":"method"},{"location":"autodocs/#Bigleaf.decoupling-Tuple{}","page":"Index","title":"Bigleaf.decoupling","text":"TODO; implement decoupling.\n\nThis stub is there to satisfy links im Help-pages.\n\n\n\n\n\n","category":"method"},{"location":"autodocs/#Bigleaf.dew_point-Tuple{Any, Any}","page":"Index","title":"Bigleaf.dew_point","text":"dew_point(Tair,VPD; ...)\ndew_point_from_e(ea; ...)\n\nCalculate the dew point, the temperature to which air must be               cooled to become saturated (ie e = Esat(Td))\n\nArguments\n\nTair:     Air temperature (degC)\nVPD:      Vapor pressure deficit (kPa)\nea:       actual water vapor pressure (kPa)\n\noptional\n\naccuracy = 1e-03: Accuracy of the result (deg C)\nEsat_formula: formula used in Esat_from_Tair\nconstants=bigleaf_constants(): Dictionary with entries    Pa2kPa \n\nDetails\n\nDew point temperature (Td) is defined by the temperature for which saturaed vapour pressure equals current vapour pressure, i.e. below which  water would start to condensate.\n\ne = Esat(Td)\n\nwhere e is vapor pressure of the air and Esat is the vapor pressure deficit.          This equation is solved for Td by optimization.\n\nValue\n\ndew point temperature (degC)\n\nReferences\n\nMonteith J.L., Unsworth M.H., 2008: Principles of Environmental Physics.             3rd edition. Academic Press, London.\n\nExamples\n\nTair = 20.0\nVPD = 1.5\nTd = dew_point(Tair, VPD; accuracy = 1e-2)                \n(e = VPD_to_e(VPD,Tair), esat_Td = Esat_from_Tair(Td))\n\n\n\n\n\n","category":"method"},{"location":"autodocs/#Bigleaf.dew_point_from_e-Tuple{Any}","page":"Index","title":"Bigleaf.dew_point_from_e","text":"dew_point(Tair,VPD; ...)\ndew_point_from_e(ea; ...)\n\nCalculate the dew point, the temperature to which air must be               cooled to become saturated (ie e = Esat(Td))\n\nArguments\n\nTair:     Air temperature (degC)\nVPD:      Vapor pressure deficit (kPa)\nea:       actual water vapor pressure (kPa)\n\noptional\n\naccuracy = 1e-03: Accuracy of the result (deg C)\nEsat_formula: formula used in Esat_from_Tair\nconstants=bigleaf_constants(): Dictionary with entries    Pa2kPa \n\nDetails\n\nDew point temperature (Td) is defined by the temperature for which saturaed vapour pressure equals current vapour pressure, i.e. below which  water would start to condensate.\n\ne = Esat(Td)\n\nwhere e is vapor pressure of the air and Esat is the vapor pressure deficit.          This equation is solved for Td by optimization.\n\nValue\n\ndew point temperature (degC)\n\nReferences\n\nMonteith J.L., Unsworth M.H., 2008: Principles of Environmental Physics.             3rd edition. Academic Press, London.\n\nExamples\n\nTair = 20.0\nVPD = 1.5\nTd = dew_point(Tair, VPD; accuracy = 1e-2)                \n(e = VPD_to_e(VPD,Tair), esat_Td = Esat_from_Tair(Td))\n\n\n\n\n\n","category":"method"},{"location":"autodocs/#Bigleaf.e_to_VPD-Tuple{Any, Any}","page":"Index","title":"Bigleaf.e_to_VPD","text":"VPD_to_rH(VPD,Tair; ...)\nH_to_VPD(rH,Tair; ...)\ne_to_rH(e,Tair; ...)\nVPD_to_e(VPD,Tair; ...)\ne_to_VPD(e,Tair; ...)\ne_to_q(e,pressure; ...)\nq_to_e(q,pressure; ...)\nq_to_VPD(q,Tair,pressure; ...)\nVPD_to_q(VPD,Tair,pressure; ...)\n\nConversion between vapor pressure (e), vapor pressure deficit (VPD),              specific humidity (q), and relative humidity (rH).\n\nArguments\n\nTair:      Air temperature (deg C)\npressure:  Atmospheric pressure (kPa)\ne:         Vapor pressure (kPa)\nq:        Specific humidity (kg kg-1)\nVPD:       Vapor pressure deficit (kPa)\nrH:        Relative humidity (-)\n\nAll functions accept the optional arguemtns:\n\nEsat_formula: formula used in Esat_from_Tair\nconstants: dictionary from bigleaf_constants with entries eps and Pa2kPa\n\nRreferences\n\nFoken, T, 2008: Micrometeorology_ Springer, Berlin, Germany.\n\n\n\n\n\n","category":"method"},{"location":"autodocs/#Bigleaf.e_to_q-Tuple{Any, Any}","page":"Index","title":"Bigleaf.e_to_q","text":"VPD_to_rH(VPD,Tair; ...)\nH_to_VPD(rH,Tair; ...)\ne_to_rH(e,Tair; ...)\nVPD_to_e(VPD,Tair; ...)\ne_to_VPD(e,Tair; ...)\ne_to_q(e,pressure; ...)\nq_to_e(q,pressure; ...)\nq_to_VPD(q,Tair,pressure; ...)\nVPD_to_q(VPD,Tair,pressure; ...)\n\nConversion between vapor pressure (e), vapor pressure deficit (VPD),              specific humidity (q), and relative humidity (rH).\n\nArguments\n\nTair:      Air temperature (deg C)\npressure:  Atmospheric pressure (kPa)\ne:         Vapor pressure (kPa)\nq:        Specific humidity (kg kg-1)\nVPD:       Vapor pressure deficit (kPa)\nrH:        Relative humidity (-)\n\nAll functions accept the optional arguemtns:\n\nEsat_formula: formula used in Esat_from_Tair\nconstants: dictionary from bigleaf_constants with entries eps and Pa2kPa\n\nRreferences\n\nFoken, T, 2008: Micrometeorology_ Springer, Berlin, Germany.\n\n\n\n\n\n","category":"method"},{"location":"autodocs/#Bigleaf.e_to_rH-Tuple{Any, Any}","page":"Index","title":"Bigleaf.e_to_rH","text":"VPD_to_rH(VPD,Tair; ...)\nH_to_VPD(rH,Tair; ...)\ne_to_rH(e,Tair; ...)\nVPD_to_e(VPD,Tair; ...)\ne_to_VPD(e,Tair; ...)\ne_to_q(e,pressure; ...)\nq_to_e(q,pressure; ...)\nq_to_VPD(q,Tair,pressure; ...)\nVPD_to_q(VPD,Tair,pressure; ...)\n\nConversion between vapor pressure (e), vapor pressure deficit (VPD),              specific humidity (q), and relative humidity (rH).\n\nArguments\n\nTair:      Air temperature (deg C)\npressure:  Atmospheric pressure (kPa)\ne:         Vapor pressure (kPa)\nq:        Specific humidity (kg kg-1)\nVPD:       Vapor pressure deficit (kPa)\nrH:        Relative humidity (-)\n\nAll functions accept the optional arguemtns:\n\nEsat_formula: formula used in Esat_from_Tair\nconstants: dictionary from bigleaf_constants with entries eps and Pa2kPa\n\nRreferences\n\nFoken, T, 2008: Micrometeorology_ Springer, Berlin, Germany.\n\n\n\n\n\n","category":"method"},{"location":"autodocs/#Bigleaf.equilibrium_imposed_ET!-Tuple{Any}","page":"Index","title":"Bigleaf.equilibrium_imposed_ET!","text":"equilibrium_imposed_ET(Tair,pressure,VPD,Gs, Rn; ...)\nequilibrium_imposed_ET(df; ...)\nequilibrium_imposed_ET!(df; ...)\n\nEvapotranspiration (ET) split up into imposed ET and equilibrium ET.\n\nArgumens\n\nTair:      Air temperature (deg C)\npressure:  Atmospheric pressure (kPa)\nVPD:       Air vapor pressure deficit (kPa)\nGs:        surface conductance to water vapor (m s-1)\nRn:        Net radiation (W m-2)\n\noptional \n\nG:         Ground heat flux (W m-2); optional\nS:         Sum of all storage fluxes (W m-2); optional\nEsat_formula: formula used in Esat_from_Tair\nconstants=bigleaf_constants(): Dictionary with entries \ncp - specific heat of air for constant pressure (J K-1 kg-1) \neps - ratio of the molecular weight of water vapor to dry  (-) \nPa2kPa - conversion pascal (Pa) to kilopascal (kPa)\n\nDetails\n\nTotal evapotranspiration can be written in the form (Jarvis & McNaughton 6):\n\nET = Omega ET_eq + (1 - Omega)ET_imp\n\nwhere Omega is the decoupling coefficient as calculated from decoupling. ET_eq is the equilibrium evapotranspiration i.e., the ET rate that would occur under uncoupled conditions, where the budget is dominated by radiation (when Ga -> 0):\n\nET_eq = (Delta * (Rn - G - S) * lambda)  ( Delta gamma)\n\nwhere Delta is the slope of the saturation vapor pressur(kPa K-1), lambda is the latent heat of vaporization (J kg-1), and gamma is the psychrometric constant (kPa K-1). ET_imp is the imposed evapotranspiration rate, the ET rate that would occur under fully coupled conditions (when Ga -> inf):\n\nET_imp = (rho * cp * VPD * Gs * lambda)  gamma\n\nwhere rho is the air density (kg m-3).\n\nNote\n\nSurface conductance (Gs) can be calculated with surface_conductance       Aerodynamic conductance (Ga) can be calculated using aerodynamic_conductance.\n\nValue\n\nA NamedTuple or DataFrame with the following columns:\n\nET_eq: Equilibrium ET (kg m-2 s-1)\nET_imp: Imposed ET (kg m-2 s-1)\nLE_eq: Equilibrium LE (W m-2)\nLE_imp: Imposed LE (W m-2)      \n\nReferences\n\nJarvis, PG., McNaughton, KG., 1986: Stomatal control of transpiration: scaling up from leaf to region. Advances in Ecological Rese1-49.\nMonteith, JL., Unsworth, MH., 2008: Principles of ironmPhysics. 3rd edition. Academic Press, London. \n\nExamples\n\nTair,pressure,Rn, VPD, Gs = 20.0,100.0,50.0, 0.5, 0.01\nET_eq, ET_imp, LE_eq, LE_imp = equilibrium_imposed_ET(Tair,pressure,VPD,Gs, Rn)    \n≈(ET_eq, 1.399424e-05; rtol = 1e-5)\n\n\n\n\n\n","category":"method"},{"location":"autodocs/#Bigleaf.equilibrium_imposed_ET-NTuple{5, Any}","page":"Index","title":"Bigleaf.equilibrium_imposed_ET","text":"equilibrium_imposed_ET(Tair,pressure,VPD,Gs, Rn; ...)\nequilibrium_imposed_ET(df; ...)\nequilibrium_imposed_ET!(df; ...)\n\nEvapotranspiration (ET) split up into imposed ET and equilibrium ET.\n\nArgumens\n\nTair:      Air temperature (deg C)\npressure:  Atmospheric pressure (kPa)\nVPD:       Air vapor pressure deficit (kPa)\nGs:        surface conductance to water vapor (m s-1)\nRn:        Net radiation (W m-2)\n\noptional \n\nG:         Ground heat flux (W m-2); optional\nS:         Sum of all storage fluxes (W m-2); optional\nEsat_formula: formula used in Esat_from_Tair\nconstants=bigleaf_constants(): Dictionary with entries \ncp - specific heat of air for constant pressure (J K-1 kg-1) \neps - ratio of the molecular weight of water vapor to dry  (-) \nPa2kPa - conversion pascal (Pa) to kilopascal (kPa)\n\nDetails\n\nTotal evapotranspiration can be written in the form (Jarvis & McNaughton 6):\n\nET = Omega ET_eq + (1 - Omega)ET_imp\n\nwhere Omega is the decoupling coefficient as calculated from decoupling. ET_eq is the equilibrium evapotranspiration i.e., the ET rate that would occur under uncoupled conditions, where the budget is dominated by radiation (when Ga -> 0):\n\nET_eq = (Delta * (Rn - G - S) * lambda)  ( Delta gamma)\n\nwhere Delta is the slope of the saturation vapor pressur(kPa K-1), lambda is the latent heat of vaporization (J kg-1), and gamma is the psychrometric constant (kPa K-1). ET_imp is the imposed evapotranspiration rate, the ET rate that would occur under fully coupled conditions (when Ga -> inf):\n\nET_imp = (rho * cp * VPD * Gs * lambda)  gamma\n\nwhere rho is the air density (kg m-3).\n\nNote\n\nSurface conductance (Gs) can be calculated with surface_conductance       Aerodynamic conductance (Ga) can be calculated using aerodynamic_conductance.\n\nValue\n\nA NamedTuple or DataFrame with the following columns:\n\nET_eq: Equilibrium ET (kg m-2 s-1)\nET_imp: Imposed ET (kg m-2 s-1)\nLE_eq: Equilibrium LE (W m-2)\nLE_imp: Imposed LE (W m-2)      \n\nReferences\n\nJarvis, PG., McNaughton, KG., 1986: Stomatal control of transpiration: scaling up from leaf to region. Advances in Ecological Rese1-49.\nMonteith, JL., Unsworth, MH., 2008: Principles of ironmPhysics. 3rd edition. Academic Press, London. \n\nExamples\n\nTair,pressure,Rn, VPD, Gs = 20.0,100.0,50.0, 0.5, 0.01\nET_eq, ET_imp, LE_eq, LE_imp = equilibrium_imposed_ET(Tair,pressure,VPD,Gs, Rn)    \n≈(ET_eq, 1.399424e-05; rtol = 1e-5)\n\n\n\n\n\n","category":"method"},{"location":"autodocs/#Bigleaf.equilibrium_imposed_ET-NTuple{7, Any}","page":"Index","title":"Bigleaf.equilibrium_imposed_ET","text":"equilibrium_imposed_ET(Tair,pressure,VPD,Gs, Rn; ...)\nequilibrium_imposed_ET(df; ...)\nequilibrium_imposed_ET!(df; ...)\n\nEvapotranspiration (ET) split up into imposed ET and equilibrium ET.\n\nArgumens\n\nTair:      Air temperature (deg C)\npressure:  Atmospheric pressure (kPa)\nVPD:       Air vapor pressure deficit (kPa)\nGs:        surface conductance to water vapor (m s-1)\nRn:        Net radiation (W m-2)\n\noptional \n\nG:         Ground heat flux (W m-2); optional\nS:         Sum of all storage fluxes (W m-2); optional\nEsat_formula: formula used in Esat_from_Tair\nconstants=bigleaf_constants(): Dictionary with entries \ncp - specific heat of air for constant pressure (J K-1 kg-1) \neps - ratio of the molecular weight of water vapor to dry  (-) \nPa2kPa - conversion pascal (Pa) to kilopascal (kPa)\n\nDetails\n\nTotal evapotranspiration can be written in the form (Jarvis & McNaughton 6):\n\nET = Omega ET_eq + (1 - Omega)ET_imp\n\nwhere Omega is the decoupling coefficient as calculated from decoupling. ET_eq is the equilibrium evapotranspiration i.e., the ET rate that would occur under uncoupled conditions, where the budget is dominated by radiation (when Ga -> 0):\n\nET_eq = (Delta * (Rn - G - S) * lambda)  ( Delta gamma)\n\nwhere Delta is the slope of the saturation vapor pressur(kPa K-1), lambda is the latent heat of vaporization (J kg-1), and gamma is the psychrometric constant (kPa K-1). ET_imp is the imposed evapotranspiration rate, the ET rate that would occur under fully coupled conditions (when Ga -> inf):\n\nET_imp = (rho * cp * VPD * Gs * lambda)  gamma\n\nwhere rho is the air density (kg m-3).\n\nNote\n\nSurface conductance (Gs) can be calculated with surface_conductance       Aerodynamic conductance (Ga) can be calculated using aerodynamic_conductance.\n\nValue\n\nA NamedTuple or DataFrame with the following columns:\n\nET_eq: Equilibrium ET (kg m-2 s-1)\nET_imp: Imposed ET (kg m-2 s-1)\nLE_eq: Equilibrium LE (W m-2)\nLE_imp: Imposed LE (W m-2)      \n\nReferences\n\nJarvis, PG., McNaughton, KG., 1986: Stomatal control of transpiration: scaling up from leaf to region. Advances in Ecological Rese1-49.\nMonteith, JL., Unsworth, MH., 2008: Principles of ironmPhysics. 3rd edition. Academic Press, London. \n\nExamples\n\nTair,pressure,Rn, VPD, Gs = 20.0,100.0,50.0, 0.5, 0.01\nET_eq, ET_imp, LE_eq, LE_imp = equilibrium_imposed_ET(Tair,pressure,VPD,Gs, Rn)    \n≈(ET_eq, 1.399424e-05; rtol = 1e-5)\n\n\n\n\n\n","category":"method"},{"location":"autodocs/#Bigleaf.equilibrium_imposed_ET-Tuple{Any}","page":"Index","title":"Bigleaf.equilibrium_imposed_ET","text":"equilibrium_imposed_ET(Tair,pressure,VPD,Gs, Rn; ...)\nequilibrium_imposed_ET(df; ...)\nequilibrium_imposed_ET!(df; ...)\n\nEvapotranspiration (ET) split up into imposed ET and equilibrium ET.\n\nArgumens\n\nTair:      Air temperature (deg C)\npressure:  Atmospheric pressure (kPa)\nVPD:       Air vapor pressure deficit (kPa)\nGs:        surface conductance to water vapor (m s-1)\nRn:        Net radiation (W m-2)\n\noptional \n\nG:         Ground heat flux (W m-2); optional\nS:         Sum of all storage fluxes (W m-2); optional\nEsat_formula: formula used in Esat_from_Tair\nconstants=bigleaf_constants(): Dictionary with entries \ncp - specific heat of air for constant pressure (J K-1 kg-1) \neps - ratio of the molecular weight of water vapor to dry  (-) \nPa2kPa - conversion pascal (Pa) to kilopascal (kPa)\n\nDetails\n\nTotal evapotranspiration can be written in the form (Jarvis & McNaughton 6):\n\nET = Omega ET_eq + (1 - Omega)ET_imp\n\nwhere Omega is the decoupling coefficient as calculated from decoupling. ET_eq is the equilibrium evapotranspiration i.e., the ET rate that would occur under uncoupled conditions, where the budget is dominated by radiation (when Ga -> 0):\n\nET_eq = (Delta * (Rn - G - S) * lambda)  ( Delta gamma)\n\nwhere Delta is the slope of the saturation vapor pressur(kPa K-1), lambda is the latent heat of vaporization (J kg-1), and gamma is the psychrometric constant (kPa K-1). ET_imp is the imposed evapotranspiration rate, the ET rate that would occur under fully coupled conditions (when Ga -> inf):\n\nET_imp = (rho * cp * VPD * Gs * lambda)  gamma\n\nwhere rho is the air density (kg m-3).\n\nNote\n\nSurface conductance (Gs) can be calculated with surface_conductance       Aerodynamic conductance (Ga) can be calculated using aerodynamic_conductance.\n\nValue\n\nA NamedTuple or DataFrame with the following columns:\n\nET_eq: Equilibrium ET (kg m-2 s-1)\nET_imp: Imposed ET (kg m-2 s-1)\nLE_eq: Equilibrium LE (W m-2)\nLE_imp: Imposed LE (W m-2)      \n\nReferences\n\nJarvis, PG., McNaughton, KG., 1986: Stomatal control of transpiration: scaling up from leaf to region. Advances in Ecological Rese1-49.\nMonteith, JL., Unsworth, MH., 2008: Principles of ironmPhysics. 3rd edition. Academic Press, London. \n\nExamples\n\nTair,pressure,Rn, VPD, Gs = 20.0,100.0,50.0, 0.5, 0.01\nET_eq, ET_imp, LE_eq, LE_imp = equilibrium_imposed_ET(Tair,pressure,VPD,Gs, Rn)    \n≈(ET_eq, 1.399424e-05; rtol = 1e-5)\n\n\n\n\n\n","category":"method"},{"location":"autodocs/#Bigleaf.extraterrestrial_radiation-Tuple{Dates.TimeType}","page":"Index","title":"Bigleaf.extraterrestrial_radiation","text":"extraterrestrial_radiation(doy::Number; ...)\nextraterrestrial_radiation(datetime::TimeType; ...)\n\nCompute the extraterrestrial solar radiation with the eccentricity correction. Computation follows Lanini, 2010 (Master thesis, Bern University).\n\nArguments\n\ndoy: integer vector with day of year (DoY)\n\noptional \n\nconstants=bigleaf_constants(): Dictionary with entries \nsolar_constant\nyear=2030: year to create timestamps. Due to precession results slightly change across decades.   \n\nValue\n\nnumeric vector of extraterrestrial radiation (W_m-2)\n\nExamples\n\nex_rad = extraterrestrial_radiation(1)\n≈(ex_rad, 1414, atol = 1)\n\n\n\n\n\n","category":"method"},{"location":"autodocs/#Bigleaf.extraterrestrial_radiation-Tuple{Number}","page":"Index","title":"Bigleaf.extraterrestrial_radiation","text":"extraterrestrial_radiation(doy::Number; ...)\nextraterrestrial_radiation(datetime::TimeType; ...)\n\nCompute the extraterrestrial solar radiation with the eccentricity correction. Computation follows Lanini, 2010 (Master thesis, Bern University).\n\nArguments\n\ndoy: integer vector with day of year (DoY)\n\noptional \n\nconstants=bigleaf_constants(): Dictionary with entries \nsolar_constant\nyear=2030: year to create timestamps. Due to precession results slightly change across decades.   \n\nValue\n\nnumeric vector of extraterrestrial radiation (W_m-2)\n\nExamples\n\nex_rad = extraterrestrial_radiation(1)\n≈(ex_rad, 1414, atol = 1)\n\n\n\n\n\n","category":"method"},{"location":"autodocs/#Bigleaf.frac_hour-Tuple{Type{var\"#s3\"} where var\"#s3\"<:Dates.Period, AbstractFloat}","page":"Index","title":"Bigleaf.frac_hour","text":"frac_hour(float::AbstractFloat)\nfrac_hour(period::Type{<:Period}, float::AbstractFloat)\n\nCreate a period in given type (defaults to Nanosecond) from fractional hours.\n\nusing Dates\nfrac_hour(1+1/60) == Hour(1) + Minute(1)\n\n\n\n\n\n","category":"method"},{"location":"autodocs/#Bigleaf.gC_to_umolCO2-Tuple{Any}","page":"Index","title":"Bigleaf.gC_to_umolCO2","text":"umolCO2_to_gC(CO2_flux; constants=bigleaf_constants())\ngC_to_umolCO2(C_flux; constants=bigleaf_constants())\n\nConvert CO2 quantities from (umol CO2 m-2 s-1) to (g C m-2 d-1) and vice versa.\n\nArguments\n\nCO2_flux  CO2 flux (umol CO2 m-2 s-1)\nC_flux    Carbon (C) flux (gC m-2 d-1)\nconstants: dictionary from bigleaf_constants with entries: Cmol, umol2mol, mol2umol, kg2g, g2kg, says2seconds\n\nExamples\n\numolCO2_to_gC(20)  # gC m-2 d-1\n\n\n\n\n\n","category":"method"},{"location":"autodocs/#Bigleaf.get_datetime_for_doy_hour","page":"Index","title":"Bigleaf.get_datetime_for_doy_hour","text":"get_datetime_for_doy_hour(doy, hour=12; year = 2030)\n\nCreate DateTime for given dayofyear and hour. Hour defaults to noon and year to 2030, a near future where earth axis  precession does not differ too much from year where the function  is called. Fractional hours can be provided.\n\nExamples\n\nget_datetime_for_doy_hour(2; year = 2021)\n# output\n2021-01-02T12:00:00\n\n\n\n\n\n","category":"function"},{"location":"autodocs/#Bigleaf.kg_to_mol","page":"Index","title":"Bigleaf.kg_to_mol","text":"kg_to_mol(mass, molarMass=bigleaf_constants()[:H2Omol])\n\nConversion between Mass (kg) and Molar Units (mol).\n\n\n\n\n\n","category":"function"},{"location":"autodocs/#Bigleaf.kinematic_viscosity-Tuple{Any, Any}","page":"Index","title":"Bigleaf.kinematic_viscosity","text":"kinematic_viscosity(Tair,pressure; ...)\n\nCalculate the kinematic viscosity of air.\n\nParameters\n\nTair      Air temperature (deg C)\npressure  Atmospheric pressure (kPa)\n\noptional \n\nconstants=bigleaf_constants(): Dictionary with entries    Kelvin, pressure0, Tair0, kPa2Pa\n\nDetails\n\nEq where v is the kinematic viscosity of the air (m2 s-1),           given by (Massman 1999b):\n\nv = 1327 * 10^-5(pressure0pressure)(TairTair0)^181\n\nValue\n\nkinematic viscosity of air (m2 s-1)\n\nReferences\n\nMassman, W.J., 1999b: Molecular diffusivities of Hg vapor in air,              O2 and N2 near STP and the kinematic viscosity and thermal diffusivity             of air near STP. Atmospheric Environment 33, 453-457.      \n\nExamples\n\nTair,pressure = 25,100\nvis = kinematic_viscosity(Tair,pressure)\n≈(vis, 1.58e-5, atol =1e-7)\n\n\n\n\n\n","category":"method"},{"location":"autodocs/#Bigleaf.latent_heat_vaporization-Tuple{Any}","page":"Index","title":"Bigleaf.latent_heat_vaporization","text":"latent_heat_vaporization(Tair)\n\nLatent heat of vaporization as a function of air temperature using \n\nlambda = (2501 - 000237  Tair) 10^6.\n\nArguments:\n\nTair:  Air temperature (deg C)\n\nValue\n\nlambda: Latent heat of vaporization (J kg-1) \n\nReferences\n\nStull, B, 1988: An Introduction to Boundary Layer Meteorology (p641)           Kluwer Academic Publishers, Dordrecht, Netherlands            \nFoken, T, 2008: Micrometeorology_ Springer, Berlin, Germany\n\nlatent_heat_vaporization.(5:5:45)        \n\n\n\n\n\n","category":"method"},{"location":"autodocs/#Bigleaf.mol_to_ms-Tuple{Any, Any, Any}","page":"Index","title":"Bigleaf.mol_to_ms","text":"ms_to_mol(G_ms,Tair,pressure; constants=bigleaf_constants())\nmol_to_ms(G_mol,Tair,pressure; constants=bigleaf_constants())\n\nConverts conductances from mass (m s-1) to molar units (mol m-2 s-1), or vice versa\n\nDetails\n\nThe conversions are given by\n\nG_mol = G_ms   pressure  (Rgas  Tair)\nG_ms = G_mol   (Rgas  Tair)  pressure\n\nwhere Tair is in Kelvin and pressure in Pa (converted from kPa internally).\n\nReferences\n\nJones, HG 1992_ Plants and microclimate: a quantitative approach to    environmental plant physiology_   2nd Edition, Cambridge University Press, Cambridge 428 \n\nExamples\n\nG_ms,Tair,pressure = 0.005,25,100\nrmol = ms_to_mol(G_ms,Tair,pressure)\n≈(rmol, 0.2017, atol =1e-4)\n\n\n\n\n\n","category":"method"},{"location":"autodocs/#Bigleaf.ms_to_mol-Tuple{Any, Any, Any}","page":"Index","title":"Bigleaf.ms_to_mol","text":"ms_to_mol(G_ms,Tair,pressure; constants=bigleaf_constants())\nmol_to_ms(G_mol,Tair,pressure; constants=bigleaf_constants())\n\nConverts conductances from mass (m s-1) to molar units (mol m-2 s-1), or vice versa\n\nDetails\n\nThe conversions are given by\n\nG_mol = G_ms   pressure  (Rgas  Tair)\nG_ms = G_mol   (Rgas  Tair)  pressure\n\nwhere Tair is in Kelvin and pressure in Pa (converted from kPa internally).\n\nReferences\n\nJones, HG 1992_ Plants and microclimate: a quantitative approach to    environmental plant physiology_   2nd Edition, Cambridge University Press, Cambridge 428 \n\nExamples\n\nG_ms,Tair,pressure = 0.005,25,100\nrmol = ms_to_mol(G_ms,Tair,pressure)\n≈(rmol, 0.2017, atol =1e-4)\n\n\n\n\n\n","category":"method"},{"location":"autodocs/#Bigleaf.potential_ET!-Tuple{Any, Val{:PenmanMonteith}}","page":"Index","title":"Bigleaf.potential_ET!","text":"potential_ET(Tair, pressure, Rn, ::Val{:PriestleyTaylor}; ...)\npotential_ET(Tair, pressure, Rn, G, S, ::Val{:PriestleyTaylor}; ...)\n\npotential_ET(df, approach; ...)\npotential_ET!(df, approach; ...)\n\nPotential evapotranspiration according to Priestley & Taylor 1972 or the Penman-Monteith equation with a prescribed surface conductance.\n\nArguments\n\nTair:      Air temperature (degC)\npressure:  Atmospheric pressure (kPa)\nRn:        Net radiation (W m-2)\nVPD:       Vapor pressure deficit (kPa)\nGa:        Aerodynamic conductance to heat/water vapor (m s-1)\napproach:  Approach used.  Either Val(:PriestleyTaylor) (default), or Val(:PenmanMonteith).\ndf:      Data_frame or matrix containing all required variables; optional\n\noptional:\n\nG:         Ground heat flux (W m-2). Defaults to zero.\nS:         Sum of all storage fluxes (W m-2) . Defaults to zero.\nEsat_formula: formula used in Esat_from_Tair\nconstants=bigleaf_constants(): Dictionary with entries \ncp - specific heat of air for constant pressure (J K-1 kg-1) \neps - ratio of the molecular weight of water vapor to dry air \nPa2kPa - conversion pascal (Pa) to kilopascal (kPa) \nfor :PenmanMonteith:\nRd - gas constant of dry air (J kg-1 K-1)\nRgas - universal gas constant (J mol-1 K-1)\nKelvin - conversion degree Celsius to Kelvin\n\nadditional optional arguments with data.frame variants\n\ninfoGS=ture: sete to false to avoid infor log-message if G or S is not  specified\n\nadditional optional for PriestleyTaylor:\n\nalpha:     Priestley-Taylor coefficient\n\nadditional optional for PenmanMonteith:\n\nGs_pot:    Potential/maximum surface conductance (mol m-2 s-1);  defaults to 0.6 mol m-2 s-1;\n\nDetails\n\nPotential evapotranspiration is calculated according to Priestley & Taylor, 1972 if approach = Val(:PriestleyTaylor) (the defau LE_potPT = (alpha * Delta * (Rn - G - S))  (Delta + gamma)\n\nalpha is the Priestley-Taylor coefficient, Delta is the slope  of the saturation vapor pressure curve (kPa K-1), and gamma is the  psychrometric constant (kPa K-1). if approach = Val(:PenmanMonteith), potential evapotranspiration is calculated according to the Penman-Monteith equat\n\nLE_potPM = (Delta * (Rn - G - S) + rho * cp * VPD * Ga)   (Delta + gamma * (1 + GaGs_pot)\n\nwhere Delta is the slope of the saturation vapor pressure curve (kPa K-1), rho is the air density (kg m-3),  and gamma is the psychrometric constant (kPa K-1). The value of Gs_pot is typically a maximum value of Gs observed at the site, e.g. the 90th percentile of Gs within the growing season.\n\nGround heat flux and storage heat flux G or S are provided as optional  arguments. In the input-explicit variants, they default to zero. In the data-frame arguments, they default to missing, which results in assuming them to be zero which is displayed in a log-message. Note that in difference ot the bigleaf R package, you explitly need to care for missing values (see examples).\n\nBoth methods are provided with several forms:\n\nall required inputs as positional arguments\nproviding a DataFrame with columns corresponding to required inputs returning a DataFrame with only the result columns.\na mutating DataFrame version that returns the original DataFrame with result columns added or modified.\n\nValue\n\nNamedTuple or DataFrame with the following entries:\n\nET_pot: Potential evapotranspiration (kg m-2 s-1)\nLE_pot: Potential latent heat flux (W m-2)\n\nFor the mutating form, the original df with columns ET_pot, LE_pot  updated or added.\n\nReferences\n\nPriestley, CHB., Taylor, R_J., 1972: On the assessment of surface heat flux\n\nand evaporation using large-scale parameters. Monthly Weather Review 100, 81-92.  \n\nAllen, RG., Pereira LS., Raes D., Smith M., 1998: Crop evapotranspiration -\n\nGuidelines for computing crop water requirements - FAO Irrigation and drainage paper 56.\n\nNovick, K_A., et al. 2016: The increasing importance of atmospheric demand\n\nfor ecosystem water and carbon fluxes. Nature Climate Change 6, 1023 - 1027.\n\nSee also\n\nsurface_conductance\n\nExamples\n\nCalculate potential ET of a surface that receives a net radiation of 500 Wm-2 using Priestley-Taylor:\n\nTair,pressure,Rn = 30.0,100.0,500.0\nET_pot, LE_pot = potential_ET(Tair,pressure,Rn, Val(:PriestleyTaylor))    \n≈(ET_pot, 0.0002035969; rtol = 1e-5)\n\nCalculate potential ET for a surface with known Gs (0.5 mol m-2 s-1) and Ga (0.1 m s-1) using Penman-Monteith:\n\nTair,pressure,Rn = 30.0,100.0,500.0\nVPD, Ga = 2.0, 0.1\nET_pot, LE_pot = potential_ET(Tair,pressure,Rn,VPD, Ga, Val(:PenmanMonteith); Gs_pot=0.5,)    \n# now cross-check with the inverted equation\n#Ga2 = surface_conductance(Tair=20,pressure=100,VPD=2,Ga=0.1,Rn=400,LE=LE_pot_PM)\n#Ga2 ≈ GA\ntrue\n\nDataFrame variant with explicitly replacing missings:\n\nusing DataFrames\ndf = DataFrame(Tair = 20.0:1.0:30.0,pressure = 100.0, Rn = 500.0, G = 105.0, VPD = 2.0, Ga = 0.1) \nallowmissing!(df, Cols(:G)); df.G[1] = missing\n#\n# need to provide G explicitly\ndf_ET = potential_ET(df, Val(:PriestleyTaylor); G = df.G, infoGS = false)    \nismissing(df_ET.ET_pot[1])\n#\n# use coalesce to replace missing values\ndf_ET = potential_ET(df, Val(:PriestleyTaylor); G = coalesce.(df.G, zero(df.G)), infoGS = false)    \n!ismissing(df_ET.ET_pot[1])\n\n\n\n\n\n","category":"method"},{"location":"autodocs/#Bigleaf.potential_ET!-Tuple{Any, Val{:PriestleyTaylor}}","page":"Index","title":"Bigleaf.potential_ET!","text":"potential_ET(Tair, pressure, Rn, ::Val{:PriestleyTaylor}; ...)\npotential_ET(Tair, pressure, Rn, G, S, ::Val{:PriestleyTaylor}; ...)\n\npotential_ET(df, approach; ...)\npotential_ET!(df, approach; ...)\n\nPotential evapotranspiration according to Priestley & Taylor 1972 or the Penman-Monteith equation with a prescribed surface conductance.\n\nArguments\n\nTair:      Air temperature (degC)\npressure:  Atmospheric pressure (kPa)\nRn:        Net radiation (W m-2)\nVPD:       Vapor pressure deficit (kPa)\nGa:        Aerodynamic conductance to heat/water vapor (m s-1)\napproach:  Approach used.  Either Val(:PriestleyTaylor) (default), or Val(:PenmanMonteith).\ndf:      Data_frame or matrix containing all required variables; optional\n\noptional:\n\nG:         Ground heat flux (W m-2). Defaults to zero.\nS:         Sum of all storage fluxes (W m-2) . Defaults to zero.\nEsat_formula: formula used in Esat_from_Tair\nconstants=bigleaf_constants(): Dictionary with entries \ncp - specific heat of air for constant pressure (J K-1 kg-1) \neps - ratio of the molecular weight of water vapor to dry air \nPa2kPa - conversion pascal (Pa) to kilopascal (kPa) \nfor :PenmanMonteith:\nRd - gas constant of dry air (J kg-1 K-1)\nRgas - universal gas constant (J mol-1 K-1)\nKelvin - conversion degree Celsius to Kelvin\n\nadditional optional arguments with data.frame variants\n\ninfoGS=ture: sete to false to avoid infor log-message if G or S is not  specified\n\nadditional optional for PriestleyTaylor:\n\nalpha:     Priestley-Taylor coefficient\n\nadditional optional for PenmanMonteith:\n\nGs_pot:    Potential/maximum surface conductance (mol m-2 s-1);  defaults to 0.6 mol m-2 s-1;\n\nDetails\n\nPotential evapotranspiration is calculated according to Priestley & Taylor, 1972 if approach = Val(:PriestleyTaylor) (the defau LE_potPT = (alpha * Delta * (Rn - G - S))  (Delta + gamma)\n\nalpha is the Priestley-Taylor coefficient, Delta is the slope  of the saturation vapor pressure curve (kPa K-1), and gamma is the  psychrometric constant (kPa K-1). if approach = Val(:PenmanMonteith), potential evapotranspiration is calculated according to the Penman-Monteith equat\n\nLE_potPM = (Delta * (Rn - G - S) + rho * cp * VPD * Ga)   (Delta + gamma * (1 + GaGs_pot)\n\nwhere Delta is the slope of the saturation vapor pressure curve (kPa K-1), rho is the air density (kg m-3),  and gamma is the psychrometric constant (kPa K-1). The value of Gs_pot is typically a maximum value of Gs observed at the site, e.g. the 90th percentile of Gs within the growing season.\n\nGround heat flux and storage heat flux G or S are provided as optional  arguments. In the input-explicit variants, they default to zero. In the data-frame arguments, they default to missing, which results in assuming them to be zero which is displayed in a log-message. Note that in difference ot the bigleaf R package, you explitly need to care for missing values (see examples).\n\nBoth methods are provided with several forms:\n\nall required inputs as positional arguments\nproviding a DataFrame with columns corresponding to required inputs returning a DataFrame with only the result columns.\na mutating DataFrame version that returns the original DataFrame with result columns added or modified.\n\nValue\n\nNamedTuple or DataFrame with the following entries:\n\nET_pot: Potential evapotranspiration (kg m-2 s-1)\nLE_pot: Potential latent heat flux (W m-2)\n\nFor the mutating form, the original df with columns ET_pot, LE_pot  updated or added.\n\nReferences\n\nPriestley, CHB., Taylor, R_J., 1972: On the assessment of surface heat flux\n\nand evaporation using large-scale parameters. Monthly Weather Review 100, 81-92.  \n\nAllen, RG., Pereira LS., Raes D., Smith M., 1998: Crop evapotranspiration -\n\nGuidelines for computing crop water requirements - FAO Irrigation and drainage paper 56.\n\nNovick, K_A., et al. 2016: The increasing importance of atmospheric demand\n\nfor ecosystem water and carbon fluxes. Nature Climate Change 6, 1023 - 1027.\n\nSee also\n\nsurface_conductance\n\nExamples\n\nCalculate potential ET of a surface that receives a net radiation of 500 Wm-2 using Priestley-Taylor:\n\nTair,pressure,Rn = 30.0,100.0,500.0\nET_pot, LE_pot = potential_ET(Tair,pressure,Rn, Val(:PriestleyTaylor))    \n≈(ET_pot, 0.0002035969; rtol = 1e-5)\n\nCalculate potential ET for a surface with known Gs (0.5 mol m-2 s-1) and Ga (0.1 m s-1) using Penman-Monteith:\n\nTair,pressure,Rn = 30.0,100.0,500.0\nVPD, Ga = 2.0, 0.1\nET_pot, LE_pot = potential_ET(Tair,pressure,Rn,VPD, Ga, Val(:PenmanMonteith); Gs_pot=0.5,)    \n# now cross-check with the inverted equation\n#Ga2 = surface_conductance(Tair=20,pressure=100,VPD=2,Ga=0.1,Rn=400,LE=LE_pot_PM)\n#Ga2 ≈ GA\ntrue\n\nDataFrame variant with explicitly replacing missings:\n\nusing DataFrames\ndf = DataFrame(Tair = 20.0:1.0:30.0,pressure = 100.0, Rn = 500.0, G = 105.0, VPD = 2.0, Ga = 0.1) \nallowmissing!(df, Cols(:G)); df.G[1] = missing\n#\n# need to provide G explicitly\ndf_ET = potential_ET(df, Val(:PriestleyTaylor); G = df.G, infoGS = false)    \nismissing(df_ET.ET_pot[1])\n#\n# use coalesce to replace missing values\ndf_ET = potential_ET(df, Val(:PriestleyTaylor); G = coalesce.(df.G, zero(df.G)), infoGS = false)    \n!ismissing(df_ET.ET_pot[1])\n\n\n\n\n\n","category":"method"},{"location":"autodocs/#Bigleaf.potential_ET-Tuple{Any, Any, Any, Any, Any, Any, Any, Val{:PenmanMonteith}}","page":"Index","title":"Bigleaf.potential_ET","text":"potential_ET(Tair, pressure, Rn, ::Val{:PriestleyTaylor}; ...)\npotential_ET(Tair, pressure, Rn, G, S, ::Val{:PriestleyTaylor}; ...)\n\npotential_ET(df, approach; ...)\npotential_ET!(df, approach; ...)\n\nPotential evapotranspiration according to Priestley & Taylor 1972 or the Penman-Monteith equation with a prescribed surface conductance.\n\nArguments\n\nTair:      Air temperature (degC)\npressure:  Atmospheric pressure (kPa)\nRn:        Net radiation (W m-2)\nVPD:       Vapor pressure deficit (kPa)\nGa:        Aerodynamic conductance to heat/water vapor (m s-1)\napproach:  Approach used.  Either Val(:PriestleyTaylor) (default), or Val(:PenmanMonteith).\ndf:      Data_frame or matrix containing all required variables; optional\n\noptional:\n\nG:         Ground heat flux (W m-2). Defaults to zero.\nS:         Sum of all storage fluxes (W m-2) . Defaults to zero.\nEsat_formula: formula used in Esat_from_Tair\nconstants=bigleaf_constants(): Dictionary with entries \ncp - specific heat of air for constant pressure (J K-1 kg-1) \neps - ratio of the molecular weight of water vapor to dry air \nPa2kPa - conversion pascal (Pa) to kilopascal (kPa) \nfor :PenmanMonteith:\nRd - gas constant of dry air (J kg-1 K-1)\nRgas - universal gas constant (J mol-1 K-1)\nKelvin - conversion degree Celsius to Kelvin\n\nadditional optional arguments with data.frame variants\n\ninfoGS=ture: sete to false to avoid infor log-message if G or S is not  specified\n\nadditional optional for PriestleyTaylor:\n\nalpha:     Priestley-Taylor coefficient\n\nadditional optional for PenmanMonteith:\n\nGs_pot:    Potential/maximum surface conductance (mol m-2 s-1);  defaults to 0.6 mol m-2 s-1;\n\nDetails\n\nPotential evapotranspiration is calculated according to Priestley & Taylor, 1972 if approach = Val(:PriestleyTaylor) (the defau LE_potPT = (alpha * Delta * (Rn - G - S))  (Delta + gamma)\n\nalpha is the Priestley-Taylor coefficient, Delta is the slope  of the saturation vapor pressure curve (kPa K-1), and gamma is the  psychrometric constant (kPa K-1). if approach = Val(:PenmanMonteith), potential evapotranspiration is calculated according to the Penman-Monteith equat\n\nLE_potPM = (Delta * (Rn - G - S) + rho * cp * VPD * Ga)   (Delta + gamma * (1 + GaGs_pot)\n\nwhere Delta is the slope of the saturation vapor pressure curve (kPa K-1), rho is the air density (kg m-3),  and gamma is the psychrometric constant (kPa K-1). The value of Gs_pot is typically a maximum value of Gs observed at the site, e.g. the 90th percentile of Gs within the growing season.\n\nGround heat flux and storage heat flux G or S are provided as optional  arguments. In the input-explicit variants, they default to zero. In the data-frame arguments, they default to missing, which results in assuming them to be zero which is displayed in a log-message. Note that in difference ot the bigleaf R package, you explitly need to care for missing values (see examples).\n\nBoth methods are provided with several forms:\n\nall required inputs as positional arguments\nproviding a DataFrame with columns corresponding to required inputs returning a DataFrame with only the result columns.\na mutating DataFrame version that returns the original DataFrame with result columns added or modified.\n\nValue\n\nNamedTuple or DataFrame with the following entries:\n\nET_pot: Potential evapotranspiration (kg m-2 s-1)\nLE_pot: Potential latent heat flux (W m-2)\n\nFor the mutating form, the original df with columns ET_pot, LE_pot  updated or added.\n\nReferences\n\nPriestley, CHB., Taylor, R_J., 1972: On the assessment of surface heat flux\n\nand evaporation using large-scale parameters. Monthly Weather Review 100, 81-92.  \n\nAllen, RG., Pereira LS., Raes D., Smith M., 1998: Crop evapotranspiration -\n\nGuidelines for computing crop water requirements - FAO Irrigation and drainage paper 56.\n\nNovick, K_A., et al. 2016: The increasing importance of atmospheric demand\n\nfor ecosystem water and carbon fluxes. Nature Climate Change 6, 1023 - 1027.\n\nSee also\n\nsurface_conductance\n\nExamples\n\nCalculate potential ET of a surface that receives a net radiation of 500 Wm-2 using Priestley-Taylor:\n\nTair,pressure,Rn = 30.0,100.0,500.0\nET_pot, LE_pot = potential_ET(Tair,pressure,Rn, Val(:PriestleyTaylor))    \n≈(ET_pot, 0.0002035969; rtol = 1e-5)\n\nCalculate potential ET for a surface with known Gs (0.5 mol m-2 s-1) and Ga (0.1 m s-1) using Penman-Monteith:\n\nTair,pressure,Rn = 30.0,100.0,500.0\nVPD, Ga = 2.0, 0.1\nET_pot, LE_pot = potential_ET(Tair,pressure,Rn,VPD, Ga, Val(:PenmanMonteith); Gs_pot=0.5,)    \n# now cross-check with the inverted equation\n#Ga2 = surface_conductance(Tair=20,pressure=100,VPD=2,Ga=0.1,Rn=400,LE=LE_pot_PM)\n#Ga2 ≈ GA\ntrue\n\nDataFrame variant with explicitly replacing missings:\n\nusing DataFrames\ndf = DataFrame(Tair = 20.0:1.0:30.0,pressure = 100.0, Rn = 500.0, G = 105.0, VPD = 2.0, Ga = 0.1) \nallowmissing!(df, Cols(:G)); df.G[1] = missing\n#\n# need to provide G explicitly\ndf_ET = potential_ET(df, Val(:PriestleyTaylor); G = df.G, infoGS = false)    \nismissing(df_ET.ET_pot[1])\n#\n# use coalesce to replace missing values\ndf_ET = potential_ET(df, Val(:PriestleyTaylor); G = coalesce.(df.G, zero(df.G)), infoGS = false)    \n!ismissing(df_ET.ET_pot[1])\n\n\n\n\n\n","category":"method"},{"location":"autodocs/#Bigleaf.potential_ET-Tuple{Any, Any, Any, Any, Any, Val{:PenmanMonteith}}","page":"Index","title":"Bigleaf.potential_ET","text":"potential_ET(Tair, pressure, Rn, ::Val{:PriestleyTaylor}; ...)\npotential_ET(Tair, pressure, Rn, G, S, ::Val{:PriestleyTaylor}; ...)\n\npotential_ET(df, approach; ...)\npotential_ET!(df, approach; ...)\n\nPotential evapotranspiration according to Priestley & Taylor 1972 or the Penman-Monteith equation with a prescribed surface conductance.\n\nArguments\n\nTair:      Air temperature (degC)\npressure:  Atmospheric pressure (kPa)\nRn:        Net radiation (W m-2)\nVPD:       Vapor pressure deficit (kPa)\nGa:        Aerodynamic conductance to heat/water vapor (m s-1)\napproach:  Approach used.  Either Val(:PriestleyTaylor) (default), or Val(:PenmanMonteith).\ndf:      Data_frame or matrix containing all required variables; optional\n\noptional:\n\nG:         Ground heat flux (W m-2). Defaults to zero.\nS:         Sum of all storage fluxes (W m-2) . Defaults to zero.\nEsat_formula: formula used in Esat_from_Tair\nconstants=bigleaf_constants(): Dictionary with entries \ncp - specific heat of air for constant pressure (J K-1 kg-1) \neps - ratio of the molecular weight of water vapor to dry air \nPa2kPa - conversion pascal (Pa) to kilopascal (kPa) \nfor :PenmanMonteith:\nRd - gas constant of dry air (J kg-1 K-1)\nRgas - universal gas constant (J mol-1 K-1)\nKelvin - conversion degree Celsius to Kelvin\n\nadditional optional arguments with data.frame variants\n\ninfoGS=ture: sete to false to avoid infor log-message if G or S is not  specified\n\nadditional optional for PriestleyTaylor:\n\nalpha:     Priestley-Taylor coefficient\n\nadditional optional for PenmanMonteith:\n\nGs_pot:    Potential/maximum surface conductance (mol m-2 s-1);  defaults to 0.6 mol m-2 s-1;\n\nDetails\n\nPotential evapotranspiration is calculated according to Priestley & Taylor, 1972 if approach = Val(:PriestleyTaylor) (the defau LE_potPT = (alpha * Delta * (Rn - G - S))  (Delta + gamma)\n\nalpha is the Priestley-Taylor coefficient, Delta is the slope  of the saturation vapor pressure curve (kPa K-1), and gamma is the  psychrometric constant (kPa K-1). if approach = Val(:PenmanMonteith), potential evapotranspiration is calculated according to the Penman-Monteith equat\n\nLE_potPM = (Delta * (Rn - G - S) + rho * cp * VPD * Ga)   (Delta + gamma * (1 + GaGs_pot)\n\nwhere Delta is the slope of the saturation vapor pressure curve (kPa K-1), rho is the air density (kg m-3),  and gamma is the psychrometric constant (kPa K-1). The value of Gs_pot is typically a maximum value of Gs observed at the site, e.g. the 90th percentile of Gs within the growing season.\n\nGround heat flux and storage heat flux G or S are provided as optional  arguments. In the input-explicit variants, they default to zero. In the data-frame arguments, they default to missing, which results in assuming them to be zero which is displayed in a log-message. Note that in difference ot the bigleaf R package, you explitly need to care for missing values (see examples).\n\nBoth methods are provided with several forms:\n\nall required inputs as positional arguments\nproviding a DataFrame with columns corresponding to required inputs returning a DataFrame with only the result columns.\na mutating DataFrame version that returns the original DataFrame with result columns added or modified.\n\nValue\n\nNamedTuple or DataFrame with the following entries:\n\nET_pot: Potential evapotranspiration (kg m-2 s-1)\nLE_pot: Potential latent heat flux (W m-2)\n\nFor the mutating form, the original df with columns ET_pot, LE_pot  updated or added.\n\nReferences\n\nPriestley, CHB., Taylor, R_J., 1972: On the assessment of surface heat flux\n\nand evaporation using large-scale parameters. Monthly Weather Review 100, 81-92.  \n\nAllen, RG., Pereira LS., Raes D., Smith M., 1998: Crop evapotranspiration -\n\nGuidelines for computing crop water requirements - FAO Irrigation and drainage paper 56.\n\nNovick, K_A., et al. 2016: The increasing importance of atmospheric demand\n\nfor ecosystem water and carbon fluxes. Nature Climate Change 6, 1023 - 1027.\n\nSee also\n\nsurface_conductance\n\nExamples\n\nCalculate potential ET of a surface that receives a net radiation of 500 Wm-2 using Priestley-Taylor:\n\nTair,pressure,Rn = 30.0,100.0,500.0\nET_pot, LE_pot = potential_ET(Tair,pressure,Rn, Val(:PriestleyTaylor))    \n≈(ET_pot, 0.0002035969; rtol = 1e-5)\n\nCalculate potential ET for a surface with known Gs (0.5 mol m-2 s-1) and Ga (0.1 m s-1) using Penman-Monteith:\n\nTair,pressure,Rn = 30.0,100.0,500.0\nVPD, Ga = 2.0, 0.1\nET_pot, LE_pot = potential_ET(Tair,pressure,Rn,VPD, Ga, Val(:PenmanMonteith); Gs_pot=0.5,)    \n# now cross-check with the inverted equation\n#Ga2 = surface_conductance(Tair=20,pressure=100,VPD=2,Ga=0.1,Rn=400,LE=LE_pot_PM)\n#Ga2 ≈ GA\ntrue\n\nDataFrame variant with explicitly replacing missings:\n\nusing DataFrames\ndf = DataFrame(Tair = 20.0:1.0:30.0,pressure = 100.0, Rn = 500.0, G = 105.0, VPD = 2.0, Ga = 0.1) \nallowmissing!(df, Cols(:G)); df.G[1] = missing\n#\n# need to provide G explicitly\ndf_ET = potential_ET(df, Val(:PriestleyTaylor); G = df.G, infoGS = false)    \nismissing(df_ET.ET_pot[1])\n#\n# use coalesce to replace missing values\ndf_ET = potential_ET(df, Val(:PriestleyTaylor); G = coalesce.(df.G, zero(df.G)), infoGS = false)    \n!ismissing(df_ET.ET_pot[1])\n\n\n\n\n\n","category":"method"},{"location":"autodocs/#Bigleaf.potential_ET-Tuple{Any, Any, Any, Any, Any, Val{:PriestleyTaylor}}","page":"Index","title":"Bigleaf.potential_ET","text":"potential_ET(Tair, pressure, Rn, ::Val{:PriestleyTaylor}; ...)\npotential_ET(Tair, pressure, Rn, G, S, ::Val{:PriestleyTaylor}; ...)\n\npotential_ET(df, approach; ...)\npotential_ET!(df, approach; ...)\n\nPotential evapotranspiration according to Priestley & Taylor 1972 or the Penman-Monteith equation with a prescribed surface conductance.\n\nArguments\n\nTair:      Air temperature (degC)\npressure:  Atmospheric pressure (kPa)\nRn:        Net radiation (W m-2)\nVPD:       Vapor pressure deficit (kPa)\nGa:        Aerodynamic conductance to heat/water vapor (m s-1)\napproach:  Approach used.  Either Val(:PriestleyTaylor) (default), or Val(:PenmanMonteith).\ndf:      Data_frame or matrix containing all required variables; optional\n\noptional:\n\nG:         Ground heat flux (W m-2). Defaults to zero.\nS:         Sum of all storage fluxes (W m-2) . Defaults to zero.\nEsat_formula: formula used in Esat_from_Tair\nconstants=bigleaf_constants(): Dictionary with entries \ncp - specific heat of air for constant pressure (J K-1 kg-1) \neps - ratio of the molecular weight of water vapor to dry air \nPa2kPa - conversion pascal (Pa) to kilopascal (kPa) \nfor :PenmanMonteith:\nRd - gas constant of dry air (J kg-1 K-1)\nRgas - universal gas constant (J mol-1 K-1)\nKelvin - conversion degree Celsius to Kelvin\n\nadditional optional arguments with data.frame variants\n\ninfoGS=ture: sete to false to avoid infor log-message if G or S is not  specified\n\nadditional optional for PriestleyTaylor:\n\nalpha:     Priestley-Taylor coefficient\n\nadditional optional for PenmanMonteith:\n\nGs_pot:    Potential/maximum surface conductance (mol m-2 s-1);  defaults to 0.6 mol m-2 s-1;\n\nDetails\n\nPotential evapotranspiration is calculated according to Priestley & Taylor, 1972 if approach = Val(:PriestleyTaylor) (the defau LE_potPT = (alpha * Delta * (Rn - G - S))  (Delta + gamma)\n\nalpha is the Priestley-Taylor coefficient, Delta is the slope  of the saturation vapor pressure curve (kPa K-1), and gamma is the  psychrometric constant (kPa K-1). if approach = Val(:PenmanMonteith), potential evapotranspiration is calculated according to the Penman-Monteith equat\n\nLE_potPM = (Delta * (Rn - G - S) + rho * cp * VPD * Ga)   (Delta + gamma * (1 + GaGs_pot)\n\nwhere Delta is the slope of the saturation vapor pressure curve (kPa K-1), rho is the air density (kg m-3),  and gamma is the psychrometric constant (kPa K-1). The value of Gs_pot is typically a maximum value of Gs observed at the site, e.g. the 90th percentile of Gs within the growing season.\n\nGround heat flux and storage heat flux G or S are provided as optional  arguments. In the input-explicit variants, they default to zero. In the data-frame arguments, they default to missing, which results in assuming them to be zero which is displayed in a log-message. Note that in difference ot the bigleaf R package, you explitly need to care for missing values (see examples).\n\nBoth methods are provided with several forms:\n\nall required inputs as positional arguments\nproviding a DataFrame with columns corresponding to required inputs returning a DataFrame with only the result columns.\na mutating DataFrame version that returns the original DataFrame with result columns added or modified.\n\nValue\n\nNamedTuple or DataFrame with the following entries:\n\nET_pot: Potential evapotranspiration (kg m-2 s-1)\nLE_pot: Potential latent heat flux (W m-2)\n\nFor the mutating form, the original df with columns ET_pot, LE_pot  updated or added.\n\nReferences\n\nPriestley, CHB., Taylor, R_J., 1972: On the assessment of surface heat flux\n\nand evaporation using large-scale parameters. Monthly Weather Review 100, 81-92.  \n\nAllen, RG., Pereira LS., Raes D., Smith M., 1998: Crop evapotranspiration -\n\nGuidelines for computing crop water requirements - FAO Irrigation and drainage paper 56.\n\nNovick, K_A., et al. 2016: The increasing importance of atmospheric demand\n\nfor ecosystem water and carbon fluxes. Nature Climate Change 6, 1023 - 1027.\n\nSee also\n\nsurface_conductance\n\nExamples\n\nCalculate potential ET of a surface that receives a net radiation of 500 Wm-2 using Priestley-Taylor:\n\nTair,pressure,Rn = 30.0,100.0,500.0\nET_pot, LE_pot = potential_ET(Tair,pressure,Rn, Val(:PriestleyTaylor))    \n≈(ET_pot, 0.0002035969; rtol = 1e-5)\n\nCalculate potential ET for a surface with known Gs (0.5 mol m-2 s-1) and Ga (0.1 m s-1) using Penman-Monteith:\n\nTair,pressure,Rn = 30.0,100.0,500.0\nVPD, Ga = 2.0, 0.1\nET_pot, LE_pot = potential_ET(Tair,pressure,Rn,VPD, Ga, Val(:PenmanMonteith); Gs_pot=0.5,)    \n# now cross-check with the inverted equation\n#Ga2 = surface_conductance(Tair=20,pressure=100,VPD=2,Ga=0.1,Rn=400,LE=LE_pot_PM)\n#Ga2 ≈ GA\ntrue\n\nDataFrame variant with explicitly replacing missings:\n\nusing DataFrames\ndf = DataFrame(Tair = 20.0:1.0:30.0,pressure = 100.0, Rn = 500.0, G = 105.0, VPD = 2.0, Ga = 0.1) \nallowmissing!(df, Cols(:G)); df.G[1] = missing\n#\n# need to provide G explicitly\ndf_ET = potential_ET(df, Val(:PriestleyTaylor); G = df.G, infoGS = false)    \nismissing(df_ET.ET_pot[1])\n#\n# use coalesce to replace missing values\ndf_ET = potential_ET(df, Val(:PriestleyTaylor); G = coalesce.(df.G, zero(df.G)), infoGS = false)    \n!ismissing(df_ET.ET_pot[1])\n\n\n\n\n\n","category":"method"},{"location":"autodocs/#Bigleaf.potential_ET-Tuple{Any, Any, Any, Val{:PriestleyTaylor}}","page":"Index","title":"Bigleaf.potential_ET","text":"potential_ET(Tair, pressure, Rn, ::Val{:PriestleyTaylor}; ...)\npotential_ET(Tair, pressure, Rn, G, S, ::Val{:PriestleyTaylor}; ...)\n\npotential_ET(df, approach; ...)\npotential_ET!(df, approach; ...)\n\nPotential evapotranspiration according to Priestley & Taylor 1972 or the Penman-Monteith equation with a prescribed surface conductance.\n\nArguments\n\nTair:      Air temperature (degC)\npressure:  Atmospheric pressure (kPa)\nRn:        Net radiation (W m-2)\nVPD:       Vapor pressure deficit (kPa)\nGa:        Aerodynamic conductance to heat/water vapor (m s-1)\napproach:  Approach used.  Either Val(:PriestleyTaylor) (default), or Val(:PenmanMonteith).\ndf:      Data_frame or matrix containing all required variables; optional\n\noptional:\n\nG:         Ground heat flux (W m-2). Defaults to zero.\nS:         Sum of all storage fluxes (W m-2) . Defaults to zero.\nEsat_formula: formula used in Esat_from_Tair\nconstants=bigleaf_constants(): Dictionary with entries \ncp - specific heat of air for constant pressure (J K-1 kg-1) \neps - ratio of the molecular weight of water vapor to dry air \nPa2kPa - conversion pascal (Pa) to kilopascal (kPa) \nfor :PenmanMonteith:\nRd - gas constant of dry air (J kg-1 K-1)\nRgas - universal gas constant (J mol-1 K-1)\nKelvin - conversion degree Celsius to Kelvin\n\nadditional optional arguments with data.frame variants\n\ninfoGS=ture: sete to false to avoid infor log-message if G or S is not  specified\n\nadditional optional for PriestleyTaylor:\n\nalpha:     Priestley-Taylor coefficient\n\nadditional optional for PenmanMonteith:\n\nGs_pot:    Potential/maximum surface conductance (mol m-2 s-1);  defaults to 0.6 mol m-2 s-1;\n\nDetails\n\nPotential evapotranspiration is calculated according to Priestley & Taylor, 1972 if approach = Val(:PriestleyTaylor) (the defau LE_potPT = (alpha * Delta * (Rn - G - S))  (Delta + gamma)\n\nalpha is the Priestley-Taylor coefficient, Delta is the slope  of the saturation vapor pressure curve (kPa K-1), and gamma is the  psychrometric constant (kPa K-1). if approach = Val(:PenmanMonteith), potential evapotranspiration is calculated according to the Penman-Monteith equat\n\nLE_potPM = (Delta * (Rn - G - S) + rho * cp * VPD * Ga)   (Delta + gamma * (1 + GaGs_pot)\n\nwhere Delta is the slope of the saturation vapor pressure curve (kPa K-1), rho is the air density (kg m-3),  and gamma is the psychrometric constant (kPa K-1). The value of Gs_pot is typically a maximum value of Gs observed at the site, e.g. the 90th percentile of Gs within the growing season.\n\nGround heat flux and storage heat flux G or S are provided as optional  arguments. In the input-explicit variants, they default to zero. In the data-frame arguments, they default to missing, which results in assuming them to be zero which is displayed in a log-message. Note that in difference ot the bigleaf R package, you explitly need to care for missing values (see examples).\n\nBoth methods are provided with several forms:\n\nall required inputs as positional arguments\nproviding a DataFrame with columns corresponding to required inputs returning a DataFrame with only the result columns.\na mutating DataFrame version that returns the original DataFrame with result columns added or modified.\n\nValue\n\nNamedTuple or DataFrame with the following entries:\n\nET_pot: Potential evapotranspiration (kg m-2 s-1)\nLE_pot: Potential latent heat flux (W m-2)\n\nFor the mutating form, the original df with columns ET_pot, LE_pot  updated or added.\n\nReferences\n\nPriestley, CHB., Taylor, R_J., 1972: On the assessment of surface heat flux\n\nand evaporation using large-scale parameters. Monthly Weather Review 100, 81-92.  \n\nAllen, RG., Pereira LS., Raes D., Smith M., 1998: Crop evapotranspiration -\n\nGuidelines for computing crop water requirements - FAO Irrigation and drainage paper 56.\n\nNovick, K_A., et al. 2016: The increasing importance of atmospheric demand\n\nfor ecosystem water and carbon fluxes. Nature Climate Change 6, 1023 - 1027.\n\nSee also\n\nsurface_conductance\n\nExamples\n\nCalculate potential ET of a surface that receives a net radiation of 500 Wm-2 using Priestley-Taylor:\n\nTair,pressure,Rn = 30.0,100.0,500.0\nET_pot, LE_pot = potential_ET(Tair,pressure,Rn, Val(:PriestleyTaylor))    \n≈(ET_pot, 0.0002035969; rtol = 1e-5)\n\nCalculate potential ET for a surface with known Gs (0.5 mol m-2 s-1) and Ga (0.1 m s-1) using Penman-Monteith:\n\nTair,pressure,Rn = 30.0,100.0,500.0\nVPD, Ga = 2.0, 0.1\nET_pot, LE_pot = potential_ET(Tair,pressure,Rn,VPD, Ga, Val(:PenmanMonteith); Gs_pot=0.5,)    \n# now cross-check with the inverted equation\n#Ga2 = surface_conductance(Tair=20,pressure=100,VPD=2,Ga=0.1,Rn=400,LE=LE_pot_PM)\n#Ga2 ≈ GA\ntrue\n\nDataFrame variant with explicitly replacing missings:\n\nusing DataFrames\ndf = DataFrame(Tair = 20.0:1.0:30.0,pressure = 100.0, Rn = 500.0, G = 105.0, VPD = 2.0, Ga = 0.1) \nallowmissing!(df, Cols(:G)); df.G[1] = missing\n#\n# need to provide G explicitly\ndf_ET = potential_ET(df, Val(:PriestleyTaylor); G = df.G, infoGS = false)    \nismissing(df_ET.ET_pot[1])\n#\n# use coalesce to replace missing values\ndf_ET = potential_ET(df, Val(:PriestleyTaylor); G = coalesce.(df.G, zero(df.G)), infoGS = false)    \n!ismissing(df_ET.ET_pot[1])\n\n\n\n\n\n","category":"method"},{"location":"autodocs/#Bigleaf.potential_ET-Tuple{Any, Val{:PenmanMonteith}}","page":"Index","title":"Bigleaf.potential_ET","text":"potential_ET(Tair, pressure, Rn, ::Val{:PriestleyTaylor}; ...)\npotential_ET(Tair, pressure, Rn, G, S, ::Val{:PriestleyTaylor}; ...)\n\npotential_ET(df, approach; ...)\npotential_ET!(df, approach; ...)\n\nPotential evapotranspiration according to Priestley & Taylor 1972 or the Penman-Monteith equation with a prescribed surface conductance.\n\nArguments\n\nTair:      Air temperature (degC)\npressure:  Atmospheric pressure (kPa)\nRn:        Net radiation (W m-2)\nVPD:       Vapor pressure deficit (kPa)\nGa:        Aerodynamic conductance to heat/water vapor (m s-1)\napproach:  Approach used.  Either Val(:PriestleyTaylor) (default), or Val(:PenmanMonteith).\ndf:      Data_frame or matrix containing all required variables; optional\n\noptional:\n\nG:         Ground heat flux (W m-2). Defaults to zero.\nS:         Sum of all storage fluxes (W m-2) . Defaults to zero.\nEsat_formula: formula used in Esat_from_Tair\nconstants=bigleaf_constants(): Dictionary with entries \ncp - specific heat of air for constant pressure (J K-1 kg-1) \neps - ratio of the molecular weight of water vapor to dry air \nPa2kPa - conversion pascal (Pa) to kilopascal (kPa) \nfor :PenmanMonteith:\nRd - gas constant of dry air (J kg-1 K-1)\nRgas - universal gas constant (J mol-1 K-1)\nKelvin - conversion degree Celsius to Kelvin\n\nadditional optional arguments with data.frame variants\n\ninfoGS=ture: sete to false to avoid infor log-message if G or S is not  specified\n\nadditional optional for PriestleyTaylor:\n\nalpha:     Priestley-Taylor coefficient\n\nadditional optional for PenmanMonteith:\n\nGs_pot:    Potential/maximum surface conductance (mol m-2 s-1);  defaults to 0.6 mol m-2 s-1;\n\nDetails\n\nPotential evapotranspiration is calculated according to Priestley & Taylor, 1972 if approach = Val(:PriestleyTaylor) (the defau LE_potPT = (alpha * Delta * (Rn - G - S))  (Delta + gamma)\n\nalpha is the Priestley-Taylor coefficient, Delta is the slope  of the saturation vapor pressure curve (kPa K-1), and gamma is the  psychrometric constant (kPa K-1). if approach = Val(:PenmanMonteith), potential evapotranspiration is calculated according to the Penman-Monteith equat\n\nLE_potPM = (Delta * (Rn - G - S) + rho * cp * VPD * Ga)   (Delta + gamma * (1 + GaGs_pot)\n\nwhere Delta is the slope of the saturation vapor pressure curve (kPa K-1), rho is the air density (kg m-3),  and gamma is the psychrometric constant (kPa K-1). The value of Gs_pot is typically a maximum value of Gs observed at the site, e.g. the 90th percentile of Gs within the growing season.\n\nGround heat flux and storage heat flux G or S are provided as optional  arguments. In the input-explicit variants, they default to zero. In the data-frame arguments, they default to missing, which results in assuming them to be zero which is displayed in a log-message. Note that in difference ot the bigleaf R package, you explitly need to care for missing values (see examples).\n\nBoth methods are provided with several forms:\n\nall required inputs as positional arguments\nproviding a DataFrame with columns corresponding to required inputs returning a DataFrame with only the result columns.\na mutating DataFrame version that returns the original DataFrame with result columns added or modified.\n\nValue\n\nNamedTuple or DataFrame with the following entries:\n\nET_pot: Potential evapotranspiration (kg m-2 s-1)\nLE_pot: Potential latent heat flux (W m-2)\n\nFor the mutating form, the original df with columns ET_pot, LE_pot  updated or added.\n\nReferences\n\nPriestley, CHB., Taylor, R_J., 1972: On the assessment of surface heat flux\n\nand evaporation using large-scale parameters. Monthly Weather Review 100, 81-92.  \n\nAllen, RG., Pereira LS., Raes D., Smith M., 1998: Crop evapotranspiration -\n\nGuidelines for computing crop water requirements - FAO Irrigation and drainage paper 56.\n\nNovick, K_A., et al. 2016: The increasing importance of atmospheric demand\n\nfor ecosystem water and carbon fluxes. Nature Climate Change 6, 1023 - 1027.\n\nSee also\n\nsurface_conductance\n\nExamples\n\nCalculate potential ET of a surface that receives a net radiation of 500 Wm-2 using Priestley-Taylor:\n\nTair,pressure,Rn = 30.0,100.0,500.0\nET_pot, LE_pot = potential_ET(Tair,pressure,Rn, Val(:PriestleyTaylor))    \n≈(ET_pot, 0.0002035969; rtol = 1e-5)\n\nCalculate potential ET for a surface with known Gs (0.5 mol m-2 s-1) and Ga (0.1 m s-1) using Penman-Monteith:\n\nTair,pressure,Rn = 30.0,100.0,500.0\nVPD, Ga = 2.0, 0.1\nET_pot, LE_pot = potential_ET(Tair,pressure,Rn,VPD, Ga, Val(:PenmanMonteith); Gs_pot=0.5,)    \n# now cross-check with the inverted equation\n#Ga2 = surface_conductance(Tair=20,pressure=100,VPD=2,Ga=0.1,Rn=400,LE=LE_pot_PM)\n#Ga2 ≈ GA\ntrue\n\nDataFrame variant with explicitly replacing missings:\n\nusing DataFrames\ndf = DataFrame(Tair = 20.0:1.0:30.0,pressure = 100.0, Rn = 500.0, G = 105.0, VPD = 2.0, Ga = 0.1) \nallowmissing!(df, Cols(:G)); df.G[1] = missing\n#\n# need to provide G explicitly\ndf_ET = potential_ET(df, Val(:PriestleyTaylor); G = df.G, infoGS = false)    \nismissing(df_ET.ET_pot[1])\n#\n# use coalesce to replace missing values\ndf_ET = potential_ET(df, Val(:PriestleyTaylor); G = coalesce.(df.G, zero(df.G)), infoGS = false)    \n!ismissing(df_ET.ET_pot[1])\n\n\n\n\n\n","category":"method"},{"location":"autodocs/#Bigleaf.potential_ET-Tuple{Any, Val{:PriestleyTaylor}}","page":"Index","title":"Bigleaf.potential_ET","text":"potential_ET(Tair, pressure, Rn, ::Val{:PriestleyTaylor}; ...)\npotential_ET(Tair, pressure, Rn, G, S, ::Val{:PriestleyTaylor}; ...)\n\npotential_ET(df, approach; ...)\npotential_ET!(df, approach; ...)\n\nPotential evapotranspiration according to Priestley & Taylor 1972 or the Penman-Monteith equation with a prescribed surface conductance.\n\nArguments\n\nTair:      Air temperature (degC)\npressure:  Atmospheric pressure (kPa)\nRn:        Net radiation (W m-2)\nVPD:       Vapor pressure deficit (kPa)\nGa:        Aerodynamic conductance to heat/water vapor (m s-1)\napproach:  Approach used.  Either Val(:PriestleyTaylor) (default), or Val(:PenmanMonteith).\ndf:      Data_frame or matrix containing all required variables; optional\n\noptional:\n\nG:         Ground heat flux (W m-2). Defaults to zero.\nS:         Sum of all storage fluxes (W m-2) . Defaults to zero.\nEsat_formula: formula used in Esat_from_Tair\nconstants=bigleaf_constants(): Dictionary with entries \ncp - specific heat of air for constant pressure (J K-1 kg-1) \neps - ratio of the molecular weight of water vapor to dry air \nPa2kPa - conversion pascal (Pa) to kilopascal (kPa) \nfor :PenmanMonteith:\nRd - gas constant of dry air (J kg-1 K-1)\nRgas - universal gas constant (J mol-1 K-1)\nKelvin - conversion degree Celsius to Kelvin\n\nadditional optional arguments with data.frame variants\n\ninfoGS=ture: sete to false to avoid infor log-message if G or S is not  specified\n\nadditional optional for PriestleyTaylor:\n\nalpha:     Priestley-Taylor coefficient\n\nadditional optional for PenmanMonteith:\n\nGs_pot:    Potential/maximum surface conductance (mol m-2 s-1);  defaults to 0.6 mol m-2 s-1;\n\nDetails\n\nPotential evapotranspiration is calculated according to Priestley & Taylor, 1972 if approach = Val(:PriestleyTaylor) (the defau LE_potPT = (alpha * Delta * (Rn - G - S))  (Delta + gamma)\n\nalpha is the Priestley-Taylor coefficient, Delta is the slope  of the saturation vapor pressure curve (kPa K-1), and gamma is the  psychrometric constant (kPa K-1). if approach = Val(:PenmanMonteith), potential evapotranspiration is calculated according to the Penman-Monteith equat\n\nLE_potPM = (Delta * (Rn - G - S) + rho * cp * VPD * Ga)   (Delta + gamma * (1 + GaGs_pot)\n\nwhere Delta is the slope of the saturation vapor pressure curve (kPa K-1), rho is the air density (kg m-3),  and gamma is the psychrometric constant (kPa K-1). The value of Gs_pot is typically a maximum value of Gs observed at the site, e.g. the 90th percentile of Gs within the growing season.\n\nGround heat flux and storage heat flux G or S are provided as optional  arguments. In the input-explicit variants, they default to zero. In the data-frame arguments, they default to missing, which results in assuming them to be zero which is displayed in a log-message. Note that in difference ot the bigleaf R package, you explitly need to care for missing values (see examples).\n\nBoth methods are provided with several forms:\n\nall required inputs as positional arguments\nproviding a DataFrame with columns corresponding to required inputs returning a DataFrame with only the result columns.\na mutating DataFrame version that returns the original DataFrame with result columns added or modified.\n\nValue\n\nNamedTuple or DataFrame with the following entries:\n\nET_pot: Potential evapotranspiration (kg m-2 s-1)\nLE_pot: Potential latent heat flux (W m-2)\n\nFor the mutating form, the original df with columns ET_pot, LE_pot  updated or added.\n\nReferences\n\nPriestley, CHB., Taylor, R_J., 1972: On the assessment of surface heat flux\n\nand evaporation using large-scale parameters. Monthly Weather Review 100, 81-92.  \n\nAllen, RG., Pereira LS., Raes D., Smith M., 1998: Crop evapotranspiration -\n\nGuidelines for computing crop water requirements - FAO Irrigation and drainage paper 56.\n\nNovick, K_A., et al. 2016: The increasing importance of atmospheric demand\n\nfor ecosystem water and carbon fluxes. Nature Climate Change 6, 1023 - 1027.\n\nSee also\n\nsurface_conductance\n\nExamples\n\nCalculate potential ET of a surface that receives a net radiation of 500 Wm-2 using Priestley-Taylor:\n\nTair,pressure,Rn = 30.0,100.0,500.0\nET_pot, LE_pot = potential_ET(Tair,pressure,Rn, Val(:PriestleyTaylor))    \n≈(ET_pot, 0.0002035969; rtol = 1e-5)\n\nCalculate potential ET for a surface with known Gs (0.5 mol m-2 s-1) and Ga (0.1 m s-1) using Penman-Monteith:\n\nTair,pressure,Rn = 30.0,100.0,500.0\nVPD, Ga = 2.0, 0.1\nET_pot, LE_pot = potential_ET(Tair,pressure,Rn,VPD, Ga, Val(:PenmanMonteith); Gs_pot=0.5,)    \n# now cross-check with the inverted equation\n#Ga2 = surface_conductance(Tair=20,pressure=100,VPD=2,Ga=0.1,Rn=400,LE=LE_pot_PM)\n#Ga2 ≈ GA\ntrue\n\nDataFrame variant with explicitly replacing missings:\n\nusing DataFrames\ndf = DataFrame(Tair = 20.0:1.0:30.0,pressure = 100.0, Rn = 500.0, G = 105.0, VPD = 2.0, Ga = 0.1) \nallowmissing!(df, Cols(:G)); df.G[1] = missing\n#\n# need to provide G explicitly\ndf_ET = potential_ET(df, Val(:PriestleyTaylor); G = df.G, infoGS = false)    \nismissing(df_ET.ET_pot[1])\n#\n# use coalesce to replace missing values\ndf_ET = potential_ET(df, Val(:PriestleyTaylor); G = coalesce.(df.G, zero(df.G)), infoGS = false)    \n!ismissing(df_ET.ET_pot[1])\n\n\n\n\n\n","category":"method"},{"location":"autodocs/#Bigleaf.potential_radiation-NTuple{4, Any}","page":"Index","title":"Bigleaf.potential_radiation","text":"potential_radiation(datetime, lat, long)\npotential_radiation(doy, hour, lat, long; timezone,year)\n\nCompute potential radiation for given geolocation and time.\n\nBecause potential radiation does not change across years  (for a given location and daytime and day of year), time can be specified alternatively by doy and hour.\n\nArguments\n\ndatetime:  UTC timestamp.\nlat:       Latitude (decimal degrees)\nlong:      Longitude (decimal degrees)\ndoy:       day of year (integer starting from 1)\nhour:      hour within the day (0.0 .. 24.0 float)\n\noptional     \n\ntimezone:  Timezone for doy and hour, defaults to \"GMT+x\"  nearest to given longitude.\nyear: specific year for doy and hour\n\nValue\n\nvector of potential radiation (W m-2)\n\nExamples\n\n# assume hours in the GMT+x that is closest to given longitude\npotrad = potential_radiation(160, 10.5, 51.0, 11.5)\n\n\n\n\n\n","category":"method"},{"location":"autodocs/#Bigleaf.potential_radiation-Tuple{Dates.TimeType, Any, Any}","page":"Index","title":"Bigleaf.potential_radiation","text":"potential_radiation(datetime, lat, long)\npotential_radiation(doy, hour, lat, long; timezone,year)\n\nCompute potential radiation for given geolocation and time.\n\nBecause potential radiation does not change across years  (for a given location and daytime and day of year), time can be specified alternatively by doy and hour.\n\nArguments\n\ndatetime:  UTC timestamp.\nlat:       Latitude (decimal degrees)\nlong:      Longitude (decimal degrees)\ndoy:       day of year (integer starting from 1)\nhour:      hour within the day (0.0 .. 24.0 float)\n\noptional     \n\ntimezone:  Timezone for doy and hour, defaults to \"GMT+x\"  nearest to given longitude.\nyear: specific year for doy and hour\n\nValue\n\nvector of potential radiation (W m-2)\n\nExamples\n\n# assume hours in the GMT+x that is closest to given longitude\npotrad = potential_radiation(160, 10.5, 51.0, 11.5)\n\n\n\n\n\n","category":"method"},{"location":"autodocs/#Bigleaf.pressure_from_elevation","page":"Index","title":"Bigleaf.pressure_from_elevation","text":"pressure_from_elevation(elev,Tair,VPD=missing;...)\n\nAn estimate of mean pressure at a given elevation as predicted by the              hypsometric equation.\n\nArguments\n\nelev:      Elevation asl_ (m)\nTair:      Air temperature (deg C)\nVPD:       Vapor pressure deficit (kPa); optional\n\noptional \n\nconstants=bigleaf_constants(): Dictionary with entries    Kelvin, pressure0, Rd, g, Pa2kPa\n\nDetails\n\nAtmospheric pressure is approximated by the hypsometric equation:\n\npressure = pressure_0  (exp(g * elevation  (Rd Temp)))\n\nThe hypsometric equation gives an estimate of the standard pressure       at a given altitude.       If VPD is provided, humidity correction is applied and the       virtual temperature instead of air temperature is used_ VPD is        internally converted to specific humidity.\n\nValue\n\nAtmospheric pressure (kPa)\n\nReferences\n\nStull B_, 1988: An Introduction to Boundary Layer Meteorology.             Kluwer Academic Publishers, Dordrecht, Netherlands.\n\nExamples\n\n# mean pressure at 500m altitude at 25 deg C and VPD of 1 kPa\npressure_from_elevation(500,25,1)\n\n\n\n\n\n","category":"function"},{"location":"autodocs/#Bigleaf.psychrometric_constant-Tuple{Any, Any}","page":"Index","title":"Bigleaf.psychrometric_constant","text":"psychrometric_constant(Tair,pressure; ...)\n\nComputes the psychrometric 'constant'.\n\nArgumens\n\nTair:      Air temperature (deg C)\npressure:  Atmospheric pressure (kPa)\n\noptional \n\nconstants=bigleaf_constants(): Dictionary with entries    cp, eps\n\nDetails\n\nThe psychrometric constant (gamma) is given as:\n\ngamma = cp * pressure  (eps * lambda)\n\nwhere lambda is the latent heat of vaporization (J kg-1),   as calculated from latent_heat_vaporization.\n\nValue\n\nthe psychrometric constant (kPa K-1)\n\nReferences\n\nMonteith J.L., Unsworth M.H., 2008: Principles of Environmental Physics.             3rd Edition. Academic Press, London.\n\nExamples\n\npsychrometric_constant.(5.0:5.0:25.0, 100)\n\n\n\n\n\n","category":"method"},{"location":"autodocs/#Bigleaf.q_to_VPD-Tuple{Any, Any, Any}","page":"Index","title":"Bigleaf.q_to_VPD","text":"VPD_to_rH(VPD,Tair; ...)\nH_to_VPD(rH,Tair; ...)\ne_to_rH(e,Tair; ...)\nVPD_to_e(VPD,Tair; ...)\ne_to_VPD(e,Tair; ...)\ne_to_q(e,pressure; ...)\nq_to_e(q,pressure; ...)\nq_to_VPD(q,Tair,pressure; ...)\nVPD_to_q(VPD,Tair,pressure; ...)\n\nConversion between vapor pressure (e), vapor pressure deficit (VPD),              specific humidity (q), and relative humidity (rH).\n\nArguments\n\nTair:      Air temperature (deg C)\npressure:  Atmospheric pressure (kPa)\ne:         Vapor pressure (kPa)\nq:        Specific humidity (kg kg-1)\nVPD:       Vapor pressure deficit (kPa)\nrH:        Relative humidity (-)\n\nAll functions accept the optional arguemtns:\n\nEsat_formula: formula used in Esat_from_Tair\nconstants: dictionary from bigleaf_constants with entries eps and Pa2kPa\n\nRreferences\n\nFoken, T, 2008: Micrometeorology_ Springer, Berlin, Germany.\n\n\n\n\n\n","category":"method"},{"location":"autodocs/#Bigleaf.q_to_e-Tuple{Any, Any}","page":"Index","title":"Bigleaf.q_to_e","text":"VPD_to_rH(VPD,Tair; ...)\nH_to_VPD(rH,Tair; ...)\ne_to_rH(e,Tair; ...)\nVPD_to_e(VPD,Tair; ...)\ne_to_VPD(e,Tair; ...)\ne_to_q(e,pressure; ...)\nq_to_e(q,pressure; ...)\nq_to_VPD(q,Tair,pressure; ...)\nVPD_to_q(VPD,Tair,pressure; ...)\n\nConversion between vapor pressure (e), vapor pressure deficit (VPD),              specific humidity (q), and relative humidity (rH).\n\nArguments\n\nTair:      Air temperature (deg C)\npressure:  Atmospheric pressure (kPa)\ne:         Vapor pressure (kPa)\nq:        Specific humidity (kg kg-1)\nVPD:       Vapor pressure deficit (kPa)\nrH:        Relative humidity (-)\n\nAll functions accept the optional arguemtns:\n\nEsat_formula: formula used in Esat_from_Tair\nconstants: dictionary from bigleaf_constants with entries eps and Pa2kPa\n\nRreferences\n\nFoken, T, 2008: Micrometeorology_ Springer, Berlin, Germany.\n\n\n\n\n\n","category":"method"},{"location":"autodocs/#Bigleaf.rH_to_VPD-Tuple{Any, Any}","page":"Index","title":"Bigleaf.rH_to_VPD","text":"VPD_to_rH(VPD,Tair; ...)\nH_to_VPD(rH,Tair; ...)\ne_to_rH(e,Tair; ...)\nVPD_to_e(VPD,Tair; ...)\ne_to_VPD(e,Tair; ...)\ne_to_q(e,pressure; ...)\nq_to_e(q,pressure; ...)\nq_to_VPD(q,Tair,pressure; ...)\nVPD_to_q(VPD,Tair,pressure; ...)\n\nConversion between vapor pressure (e), vapor pressure deficit (VPD),              specific humidity (q), and relative humidity (rH).\n\nArguments\n\nTair:      Air temperature (deg C)\npressure:  Atmospheric pressure (kPa)\ne:         Vapor pressure (kPa)\nq:        Specific humidity (kg kg-1)\nVPD:       Vapor pressure deficit (kPa)\nrH:        Relative humidity (-)\n\nAll functions accept the optional arguemtns:\n\nEsat_formula: formula used in Esat_from_Tair\nconstants: dictionary from bigleaf_constants with entries eps and Pa2kPa\n\nRreferences\n\nFoken, T, 2008: Micrometeorology_ Springer, Berlin, Germany.\n\n\n\n\n\n","category":"method"},{"location":"autodocs/#Bigleaf.surface_conductance-Tuple{}","page":"Index","title":"Bigleaf.surface_conductance","text":"TODO; implement surface_conductance.\n\nThis stub is there to satisfy links im Help-pages.\n\n\n\n\n\n","category":"method"},{"location":"autodocs/#Bigleaf.umolCO2_to_gC-Tuple{Any}","page":"Index","title":"Bigleaf.umolCO2_to_gC","text":"umolCO2_to_gC(CO2_flux; constants=bigleaf_constants())\ngC_to_umolCO2(C_flux; constants=bigleaf_constants())\n\nConvert CO2 quantities from (umol CO2 m-2 s-1) to (g C m-2 d-1) and vice versa.\n\nArguments\n\nCO2_flux  CO2 flux (umol CO2 m-2 s-1)\nC_flux    Carbon (C) flux (gC m-2 d-1)\nconstants: dictionary from bigleaf_constants with entries: Cmol, umol2mol, mol2umol, kg2g, g2kg, says2seconds\n\nExamples\n\numolCO2_to_gC(20)  # gC m-2 d-1\n\n\n\n\n\n","category":"method"},{"location":"autodocs/#Bigleaf.virtual_temp-Tuple{Any, Any, Any}","page":"Index","title":"Bigleaf.virtual_temp","text":"virtual_temp(Tair,pressure,VPD; ...)\n\nVirtual temperature, defined as the temperature at which dry air would have the same              density as moist air at its actual temperature.\n\nArguments\n\nTair:      Air temperature (deg C)\npressure:  Atmospheric pressure (kPa)\nVPD:       Vapor pressure deficit (kPa)\nEsat_formula: formula used in Esat_from_Tair\n\noptional \n\nconstants=bigleaf_constants(): Dictionary with entries \n:Kelvin - conversion degree Celsius to Kelvin\n:eps - ratio of the molecular weight of water vapor to dry air (-) \n\nDetails\n\nThe virtual temperature is given by:\n\nTv = Tair / (1 - (1 - eps) e/pressure)\n\nwhere Tair is in Kelvin (converted internally)_ Likewise, VPD is converted   to actual vapor pressure (e in kPa) with VPD_to_e internally.\n\nValue\n\nvirtual temperature (deg C)\n\nReferences\n\nMonteith J.L., Unsworth M.H., 2008: Principles of Environmental Physics.           3rd edition. Academic Press, London.\n\nExamples\n\nTair,pressure,VPD = 25,100,1.5\nvt = virtual_temp(Tair,pressure,VPD)  \n≈(vt, 26.9, atol =0.1)\n\n\n\n\n\n","category":"method"},{"location":"autodocs/#Bigleaf.wetbulb_temp-Tuple{Any, Any, Any}","page":"Index","title":"Bigleaf.wetbulb_temp","text":"wetbulb_temp(Tair, pressure, VPD; ...)\n\nCalculate the wet bulb temperature, ie the temperature              that the air would have if it was saturated\n\nArguments\n\nTair:      Air temperature (deg C)\npressure:  Atmospheric pressure (kPa)\nVPD:       Vapor pressure deficit (kPa)\n\noptional\n\naccuracy:  Accuracy of the result (deg C)\nEsat_formula: formula used in Esat_from_Tair\nconstants=bigleaf_constants(): Dictionary with entries     cp, eps,Pa2kPa\n\nDetails\n\nWet-bulb temperature (Tw) is calculated from the following expression:\n\ne = Esat(Tw) - gamma* (Tair - Tw)\n\nThe equation is optimized for Tw. Actual vapor pressure e (kPa) is calculated from VPD using VPD_to_e. The psychrometric constant gamma (kPa K-1) is calculated using psychrometric_constant.\n\nValue\n\nwet-bulb temperature (degC)\n\nReferences\n\nMonteith J.L., Unsworth M.H., 2008: Principles of Environmental Physics.             3rd edition. Academic Press, London.\n\nExamples\n\nwetbulb_temp.([20,25.0], 100, [1,1.6])             \n\n\n\n\n\n","category":"method"},{"location":"autodocs/#Bigleaf.wetbulb_temp_from_e_Tair_gamma-Tuple{Any, Any, Any}","page":"Index","title":"Bigleaf.wetbulb_temp_from_e_Tair_gamma","text":"wetbulb_temp(Tair, pressure, VPD; ...)\n\nCalculate the wet bulb temperature, ie the temperature              that the air would have if it was saturated\n\nArguments\n\nTair:      Air temperature (deg C)\npressure:  Atmospheric pressure (kPa)\nVPD:       Vapor pressure deficit (kPa)\n\noptional\n\naccuracy:  Accuracy of the result (deg C)\nEsat_formula: formula used in Esat_from_Tair\nconstants=bigleaf_constants(): Dictionary with entries     cp, eps,Pa2kPa\n\nDetails\n\nWet-bulb temperature (Tw) is calculated from the following expression:\n\ne = Esat(Tw) - gamma* (Tair - Tw)\n\nThe equation is optimized for Tw. Actual vapor pressure e (kPa) is calculated from VPD using VPD_to_e. The psychrometric constant gamma (kPa K-1) is calculated using psychrometric_constant.\n\nValue\n\nwet-bulb temperature (degC)\n\nReferences\n\nMonteith J.L., Unsworth M.H., 2008: Principles of Environmental Physics.             3rd edition. Academic Press, London.\n\nExamples\n\nwetbulb_temp.([20,25.0], 100, [1,1.6])             \n\n\n\n\n\n","category":"method"},{"location":"walkthrough/","page":"Walkthrough","title":"Walkthrough","text":"This vignette is a short introduction to the functionalities of the Bigleaf.jl package.  It is directed to first-time package users who are familiar with the basic concepts of Julia.  After presenting the use of several key functions of the package,  some useful hints and guidelines are given at the end of the vignette.","category":"page"},{"location":"walkthrough/#Package-scope-and-important-conceptual-considerations","page":"Walkthrough","title":"Package scope and important conceptual considerations","text":"","category":"section"},{"location":"walkthrough/","page":"Walkthrough","title":"Walkthrough","text":"Bigleaf.jl calculates physical and physiological ecosystem properties from eddy covariance data. Examples for such properties are aerodynamic and surface conductance, surface conditions(e.g. temperature, VPD), wind profile, roughness parameters, vegetation-atmosphere decoupling, potential evapotranspiration, (intrinsic) water-use efficiency, stomatal sensitivity to VPD, or intercellular CO2 concentration.  All calculations in the Bigleaf.jl package assume that the ecosystem behaves like a  \"big-leaf\", i.e. a single, homogenous plane which acts as the only source and sink of the measured fluxes. This assumption comes with the advantages that calculations are simplified considerably and that (in most cases) little ancillary information on the EC sites is required. It is important to keep in mind that these simplifications go hand in hand with critical limitations. All derived variables are bulk ecosystem characteristics and have to be interpreted as such. It is for example not possible to infer within-canopy variations of a certain property.","category":"page"},{"location":"walkthrough/","page":"Walkthrough","title":"Walkthrough","text":"Please also keep in mind that the Bigleaf.jl package does NOT provide formulations for bottom-up modelling. The principle applied here is to use an inversion approach in which ecosystem properties are inferred top-down from the measured fluxes. Such an inversion can, in principle, be also be conducted with more complex models (e.g. sun/shade or canopy/soil models), but keep in mind that these approaches also require that the additional, site-specific parameters are adequately well known. ","category":"page"},{"location":"walkthrough/","page":"Walkthrough","title":"Walkthrough","text":"The use of more detailed models is not within the scope of the Bigleaf.jl package, but it is preferable to use such approaches when important assumptions of the \"big-leaf\" approach are not met. This is the case in particular when the ecosystem is sparsely covered with vegetation (low LAI, e.g. sparse crops, some savanna systems). ","category":"page"},{"location":"walkthrough/#Preparing-the-data","page":"Walkthrough","title":"Preparing the data","text":"","category":"section"},{"location":"walkthrough/","page":"Walkthrough","title":"Walkthrough","text":"In this tutorial, we will work with a dataset from the eddy covariance site Tharandt (DE-Tha), a spruce forest in Eastern Germany. The DataFrame DE_Tha_Jun_2014 is downloaded from the bigleaf  R package repository and contains half-hourly data of meteorological and flux measurements made in June 2014. For loading the RData into Julia, see the  source of this file. We give the data.frame a shorter name here.","category":"page"},{"location":"walkthrough/","page":"Walkthrough","title":"Walkthrough","text":"using Bigleaf\nusing DataFrames","category":"page"},{"location":"walkthrough/","page":"Walkthrough","title":"Walkthrough","text":"using Latexify\nusing DataDeps, Suppressor\nusing RData\nimport CodecBzip2, CodecXz\n#@suppress_err # error in github-actions: GitHubActionsLogger has no field stream\nregister(DataDep(\n    \"DE_Tha_Jun_2014.rda\",\n    \"downloading exampple dataset DE_Tha_Jun_2014 from bitbucket.org/juergenknauer/bigleaf\",\n    \"https://bitbucket.org/juergenknauer/bigleaf/raw/0ebe11626b4409305951e8add9f6436703c82584/data/DE_Tha_Jun_2014.rda\",\n    \"395f02e1a1a2d175ac7499c200d9d48b1cb58ff4755dfd2d7fe96fd18258d73c\"\n))\n#println(datadep\"DE_Tha_Jun_2014.rda\")\nENV[\"DATADEPS_ALWAYS_ACCEPT\"]=\"true\" # avoid question to download\nDE_Tha_Jun_2014 = first(values(load(joinpath(datadep\"DE_Tha_Jun_2014.rda/DE_Tha_Jun_2014.rda\"))))\nnothing","category":"page"},{"location":"walkthrough/","page":"Walkthrough","title":"Walkthrough","text":"tha = DE_Tha_Jun_2014\nmdtable(select(describe(tha), :variable, :eltype, :min, :max), latex=false) # hide","category":"page"},{"location":"walkthrough/","page":"Walkthrough","title":"Walkthrough","text":"And the first six rows of tha:","category":"page"},{"location":"walkthrough/","page":"Walkthrough","title":"Walkthrough","text":"mdtable(tha[1:6,:],latex=false) # hide","category":"page"},{"location":"walkthrough/","page":"Walkthrough","title":"Walkthrough","text":"More information on the data (e.g. meaning of column names and units) can be found at the  bigleaf R package.  For more information on the site see e.g. Grünwald & Bernhofer 2007. In addition, we will need some ancillary data for this site throughout this tutorial. To ensure consistency, we define them here at the beginning:","category":"page"},{"location":"walkthrough/","page":"Walkthrough","title":"Walkthrough","text":"LAI = 7.6   # leaf area index\nzh  = 26.5  # average vegetation height (m)\nzr  = 42    # sensor height (m)\nDl  = 0.01  # leaf characteristic dimension (m)\nnothing # hide","category":"page"},{"location":"walkthrough/#General-guidelines-on-package-usage","page":"Walkthrough","title":"General guidelines on package usage","text":"","category":"section"},{"location":"walkthrough/","page":"Walkthrough","title":"Walkthrough","text":"There are a few general guidelines that are important to consider when using the Bigleaf.jl package. ","category":"page"},{"location":"walkthrough/#Units","page":"Walkthrough","title":"Units","text":"","category":"section"},{"location":"walkthrough/","page":"Walkthrough","title":"Walkthrough","text":"It is imperative that variables are provided in the right units, as the plausibility of  the input units is not checked in most cases. The required units of the input arguments  can be found in the respective help file of the function. The good news is that units  do not change across functions. For example, pressure is always required in kPa,  and temperature always in °c.","category":"page"},{"location":"walkthrough/#Function-arguments","page":"Walkthrough","title":"Function arguments","text":"","category":"section"},{"location":"walkthrough/","page":"Walkthrough","title":"Walkthrough","text":"Most functions of Bigleaf.jl require a DataFrame, from which the required variables are extracted. This is usually the first argument of a function.  Most functions further provide default values for their arguments,  such that in many cases it is not necessary to provide them explicitly.","category":"page"},{"location":"walkthrough/","page":"Walkthrough","title":"Walkthrough","text":"The column names in the DataFrame should correspond to the argument names of the corresponding method that accespts each input individually.","category":"page"},{"location":"walkthrough/","page":"Walkthrough","title":"Walkthrough","text":"We can demonstrate the usage with a simple example:","category":"page"},{"location":"walkthrough/","page":"Walkthrough","title":"Walkthrough","text":"# explicit inputs\nTair, pressure, Rn, =  14.81, 97.71, 778.17 \npotential_ET(Tair, pressure, Rn, Val(:PriestleyTaylor))\n# DataFrame\npotential_ET(tha, Val(:PriestleyTaylor))\n# DataFrame with a few columns overwritten by user values\npotential_ET(transform(tha, :Tair => x -> 25.0; renamecols=false), Val(:PriestleyTaylor))\n# varying one input only\nTair_vec =  10.0:1.0:20.0\nDataFrame(potential_ET.(Tair_vec, pressure, Rn, Val(:PriestleyTaylor)))\nnothing # hide","category":"page"},{"location":"walkthrough/#Ground-heat-flux-and-storage-fluxes","page":"Walkthrough","title":"Ground heat flux and storage fluxes","text":"","category":"section"},{"location":"walkthrough/","page":"Walkthrough","title":"Walkthrough","text":"Many functions require the available energy (A), which is defined as (A = R_n - G - S,  all in textW m^-2), where R_n is the net radiation, G is the ground heat flux,  and S is the sum of all storage fluxes of the ecosystem  (see e.g. Leuning et al. 2012 for an overview). For some sites, G is not available,  and for most sites, only a few components of S are measured. ","category":"page"},{"location":"walkthrough/","page":"Walkthrough","title":"Walkthrough","text":"In Bigleaf.jl it is not a problem if G and/or S are missing (other than the results might be (slightly) biased), but special options exist for the treatment of missing S and G values. ","category":"page"},{"location":"walkthrough/","page":"Walkthrough","title":"Walkthrough","text":"Note that the default for G and S in the dataframe variant is missing (and assumed zero),  even if those columns are present in the DataFrame. You need to explictly pass those columns with the optional arguments: e.g. potential_ET(df, Val(:PriestleyTaylor); G = df.G)","category":"page"},{"location":"walkthrough/","page":"Walkthrough","title":"Walkthrough","text":"Note that in difference to the bigleaf R package missing entries in a provide vector are not relaced by zero by default.  You need to explitly use coalesce when specifying a ground heat flux for which missings should be replaced by zero: ;G = coalesce(df.G, zero(df.G))","category":"page"},{"location":"walkthrough/#Function-walkthrough","page":"Walkthrough","title":"Function walkthrough","text":"","category":"section"},{"location":"walkthrough/#Meteorological-variables","page":"Walkthrough","title":"Meteorological variables","text":"","category":"section"},{"location":"walkthrough/","page":"Walkthrough","title":"Walkthrough","text":"The Bigleaf.jl package provides calculation routines for a number of meteorological variables, which are basic to the calculation of many other variables. A few examples on their usage are given below:","category":"page"},{"location":"walkthrough/","page":"Walkthrough","title":"Walkthrough","text":"# Saturation vapor pressure (kPa) and slope of the saturation vapor pressure curve (kPa K-1)\nEsat_slope(25.0)","category":"page"},{"location":"walkthrough/","page":"Walkthrough","title":"Walkthrough","text":"# psychrometric constant (kPa K-1)\npsychrometric_constant(25.0,100.0) # Tair, pressure","category":"page"},{"location":"walkthrough/","page":"Walkthrough","title":"Walkthrough","text":"# air density (kg m-3)\nair_density(25.0,100.0) # Tair, pressure","category":"page"},{"location":"walkthrough/","page":"Walkthrough","title":"Walkthrough","text":"# dew point (degC)\ndew_point(25.0,1.0) # Tair, VPD","category":"page"},{"location":"walkthrough/","page":"Walkthrough","title":"Walkthrough","text":"# wetbulb temperature (degC)\nwetbulb_temp(25.0, 100.0, 1.0) # Tair, pressure, VPD","category":"page"},{"location":"walkthrough/","page":"Walkthrough","title":"Walkthrough","text":"# estimate atmospheric pressure from elevation (hypsometric equation)\npressure_from_elevation(500.0, 25.0) # elev, Tair","category":"page"},{"location":"walkthrough/","page":"Walkthrough","title":"Walkthrough","text":"There are several formulations describing the empirical function Esat(Tair). The following figure compares them at absole scale and as difference to the  #default method. The differences are small.","category":"page"},{"location":"walkthrough/","page":"Walkthrough","title":"Walkthrough","text":"#using DataFrames\n#Tair = 0:0.25:12\n##Tair = [10.0,20.0]\n#eform_def = Val(:Sonntag_1990)\n#Esat_def = Esat_from_Tair.(Tair; formula = eform_def)\n#eforms = (Val(:Sonntag_1990), Val(:Alduchov_1996), Val(:Allen_1998))\n#eform = eforms[2]\n#string.(eforms)\n#df = mapreduce(vcat, eforms) do eform \n#    Esat = Esat_from_Tair.(Tair; formula = eform)\n#    local dff # make sure to not override previous results\n#    dff = DataFrame(\n#        formula = eform, Tair = Tair, \n#        Esat = Esat,\n#        dEsat = Esat - Esat_def,\n#        )\n#end;\n##using Chain\n#using Pipe\n#using Plots, StatsPlots\n#dfw = @pipe df |> select(_, 1,2, :Esat) |> unstack(_, :formula, 3)\n#dfws = @pipe df |> select(_, 1,2, :dEsat) |> unstack(_, :formula, 3)\n#@df dfw plot(:Tair, cols(2:4), legend = :topleft, xlab=\"Tair (degC)\", #ylab=\"Esat (kPa)\")\n#savefig(\"Esat_abs.svg\")\n#@df dfws plot(:Tair, cols(2:4), legend = :topleft, xlab=\"Tair (degC)\", #ylab=\"Esat -ESat_Sonntag_1990 (kPa)\")\n#savefig(\"fig/Esat_rel.svg\")","category":"page"},{"location":"walkthrough/","page":"Walkthrough","title":"Walkthrough","text":"(Image: )","category":"page"},{"location":"walkthrough/","page":"Walkthrough","title":"Walkthrough","text":"(Image: )","category":"page"},{"location":"walkthrough/#Global-radiation","page":"Walkthrough","title":"Global radiation","text":"","category":"section"},{"location":"walkthrough/","page":"Walkthrough","title":"Walkthrough","text":"Potential radiation for given time and latitude:","category":"page"},{"location":"walkthrough/","page":"Walkthrough","title":"Walkthrough","text":"doy, hour = 160, 10.5\nlat, long = 51.0, 11.5\npotrad = potential_radiation(doy, hour, lat, long)","category":"page"},{"location":"walkthrough/","page":"Walkthrough","title":"Walkthrough","text":"Calculation is based on sun's altitude, one of the horizontal coordinates of its position.","category":"page"},{"location":"walkthrough/","page":"Walkthrough","title":"Walkthrough","text":"using Plots, StatsPlots, DataFrames, Dates, Pipe, Suppressor\nhours = 0:24\nlat,long = 51.0, 13.6 # Dresden Germany\n#deg2second = 24*3600/360\ndoy = 160\ndatetimes = DateTime(2021) .+Day(doy-1) .+ Hour.(hours) #.- Second(round(long*deg2second))\nres3 = @pipe calc_sun_position_hor.(datetimes, lat, long) |> DataFrame(_)\n@df res3 scatter(datetimes, cols([:altitude,:azimuth]), legend = :topleft, xlab=\"Date and Time\", ylab = \"rad\")","category":"page"},{"location":"walkthrough/","page":"Walkthrough","title":"Walkthrough","text":"The hour-angle at noon represents the difference to local time. In the following example solar time is about 55min ahead of local winter time.","category":"page"},{"location":"walkthrough/","page":"Walkthrough","title":"Walkthrough","text":"summernoon = DateTime(2021) +Day(doy-1) + Hour(12) \nsunpos = calc_sun_position_hor(summernoon, lat, long) \nsunpos.hourangle * 24*60/(2*π) # convert angle to minutes","category":"page"},{"location":"walkthrough/#Unit-interconversions","page":"Walkthrough","title":"Unit interconversions","text":"","category":"section"},{"location":"walkthrough/","page":"Walkthrough","title":"Walkthrough","text":"The package further provides a number of useful unit interconversions, which are straightforward to use (please make sure that the input variable is in the right unit, e_g. rH has to be between 0 and 1 and not in percent):","category":"page"},{"location":"walkthrough/","page":"Walkthrough","title":"Walkthrough","text":"# VPD to vapor pressure (e, kPa)\nVPD_to_e(2, 25)","category":"page"},{"location":"walkthrough/","page":"Walkthrough","title":"Walkthrough","text":"# vapor pressure to specific humidity (kg kg-1)\ne_to_q(1, 100)","category":"page"},{"location":"walkthrough/","page":"Walkthrough","title":"Walkthrough","text":"# relative humidity to VPD (kPa)\nrH_to_VPD(0.6, 25)","category":"page"},{"location":"walkthrough/","page":"Walkthrough","title":"Walkthrough","text":"# conductance from ms-1 to mol m-2 s-1\nms_to_mol(0.01, 25, 100) # mC, Tair, pressure","category":"page"},{"location":"walkthrough/","page":"Walkthrough","title":"Walkthrough","text":"# umol CO2 m-2 s-1 to g C m-2 d-1\numolCO2_to_gC(20)","category":"page"},{"location":"walkthrough/","page":"Walkthrough","title":"Walkthrough","text":"Many functions provide constant empirical parameters. Those can be changed by overriding the default values with  bigleaf_constants  and passing this Dictionary to the respective function.","category":"page"}]
}
