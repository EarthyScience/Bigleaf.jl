<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Index · Bigleaf.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://bgctw.github.io/Bigleaf.jl/autodocs/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">Bigleaf.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../walkthrough/">Walkthrough</a></li><li class="is-active"><a class="tocitem" href>Index</a><ul class="internal"><li class="toplevel"><a class="tocitem" href="#Autodocs"><span>Autodocs</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Index</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Index</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/bgctw/Bigleaf.jl/blob/master/docs/src/autodocs.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Index"><a class="docs-heading-anchor" href="#Index">Index</a><a id="Index-1"></a><a class="docs-heading-anchor-permalink" href="#Index" title="Permalink"></a></h1><ul><li><a href="#Bigleaf.ET_to_LE-Tuple{Any, Any}"><code>Bigleaf.ET_to_LE</code></a></li><li><a href="../metorological_variables/#Bigleaf.Esat_from_Tair"><code>Bigleaf.Esat_from_Tair</code></a></li><li><a href="#Bigleaf.Esat_from_Tair-Tuple{Any}"><code>Bigleaf.Esat_from_Tair</code></a></li><li><a href="#Bigleaf.Esat_from_Tair_deriv-Tuple{Any}"><code>Bigleaf.Esat_from_Tair_deriv</code></a></li><li><a href="#Bigleaf.Esat_slope-Tuple{Number}"><code>Bigleaf.Esat_slope</code></a></li><li><a href="../boundary_layer_conductance/#Bigleaf.Gb_Choudhury"><code>Bigleaf.Gb_Choudhury</code></a></li><li><a href="#Bigleaf.Gb_Choudhury-Tuple{}"><code>Bigleaf.Gb_Choudhury</code></a></li><li><a href="../boundary_layer_conductance/#Bigleaf.Gb_Su"><code>Bigleaf.Gb_Su</code></a></li><li><a href="#Bigleaf.Gb_Su-Tuple{Any, Any, Any}"><code>Bigleaf.Gb_Su</code></a></li><li><a href="#Bigleaf.Gb_Thom-Tuple{Union{Missing, Number}}"><code>Bigleaf.Gb_Thom</code></a></li><li><a href="../boundary_layer_conductance/#Bigleaf.Gb_Thom"><code>Bigleaf.Gb_Thom</code></a></li><li><a href="#Bigleaf.Gb_constant_kB1-Tuple{Any, Any}"><code>Bigleaf.Gb_constant_kB1</code></a></li><li><a href="../unit_conversions/#Bigleaf.LE_to_ET"><code>Bigleaf.LE_to_ET</code></a></li><li><a href="#Bigleaf.LE_to_ET-Tuple{Any, Any}"><code>Bigleaf.LE_to_ET</code></a></li><li><a href="../stability_correction/#Bigleaf.Monin_Obukhov_length"><code>Bigleaf.Monin_Obukhov_length</code></a></li><li><a href="#Bigleaf.Monin_Obukhov_length-NTuple{4, Any}"><code>Bigleaf.Monin_Obukhov_length</code></a></li><li><a href="#Bigleaf.PPFD_to_Rg"><code>Bigleaf.PPFD_to_Rg</code></a></li><li><a href="#Bigleaf.Reynolds_Number-NTuple{4, Any}"><code>Bigleaf.Reynolds_Number</code></a></li><li><a href="../surface_roughness/#Bigleaf.Reynolds_Number"><code>Bigleaf.Reynolds_Number</code></a></li><li><a href="../unit_conversions/#Bigleaf.Rg_to_PPFD"><code>Bigleaf.Rg_to_PPFD</code></a></li><li><a href="#Bigleaf.Rg_to_PPFD"><code>Bigleaf.Rg_to_PPFD</code></a></li><li><a href="#Bigleaf.VPD_to_e-Tuple{Any, Any}"><code>Bigleaf.VPD_to_e</code></a></li><li><a href="../unit_conversions/#Bigleaf.VPD_to_e"><code>Bigleaf.VPD_to_e</code></a></li><li><a href="#Bigleaf.VPD_to_q-Tuple{Any, Any, Any}"><code>Bigleaf.VPD_to_q</code></a></li><li><a href="#Bigleaf.VPD_to_rH-Tuple{Any, Any}"><code>Bigleaf.VPD_to_rH</code></a></li><li><a href="../aerodynamic_conductance/#Bigleaf.add_Ga!"><code>Bigleaf.add_Ga!</code></a></li><li><a href="#Bigleaf.add_Ga!-Union{Tuple{N}, Tuple{AbstractDataFrame, Vararg{Pair, N}}} where N"><code>Bigleaf.add_Ga!</code></a></li><li><a href="../boundary_layer_conductance/#Bigleaf.add_Gb!"><code>Bigleaf.add_Gb!</code></a></li><li><a href="#Bigleaf.add_Gb!-Union{Tuple{N}, Tuple{AbstractDataFrame, Vararg{Pair, N}}} where N"><code>Bigleaf.add_Gb!</code></a></li><li><a href="#Bigleaf.aerodynamic_conductance!-Tuple{Any}"><code>Bigleaf.aerodynamic_conductance!</code></a></li><li><a href="../aerodynamic_conductance/#Bigleaf.aerodynamic_conductance!"><code>Bigleaf.aerodynamic_conductance!</code></a></li><li><a href="#Bigleaf.air_density-Tuple{Any, Any}"><code>Bigleaf.air_density</code></a></li><li><a href="../metorological_variables/#Bigleaf.air_density"><code>Bigleaf.air_density</code></a></li><li><a href="#Bigleaf.bigleaf_constants-Tuple{}"><code>Bigleaf.bigleaf_constants</code></a></li><li><a href="../bigleaf_constants/#Bigleaf.bigleaf_constants"><code>Bigleaf.bigleaf_constants</code></a></li><li><a href="../global_radiation/#Bigleaf.calc_sun_position_MOD"><code>Bigleaf.calc_sun_position_MOD</code></a></li><li><a href="#Bigleaf.calc_sun_position_MOD-Tuple{Number}"><code>Bigleaf.calc_sun_position_MOD</code></a></li><li><a href="#Bigleaf.calc_sun_position_hor-Tuple{Dates.DateTime, Any, Any}"><code>Bigleaf.calc_sun_position_hor</code></a></li><li><a href="#Bigleaf.calc_sun_position_hor-Tuple{TimeZones.ZonedDateTime, Any, Any}"><code>Bigleaf.calc_sun_position_hor</code></a></li><li><a href="../global_radiation/#Bigleaf.calc_sun_position_hor"><code>Bigleaf.calc_sun_position_hor</code></a></li><li><a href="#Bigleaf.compute_Gb!-Tuple{AbstractDataFrame, Val{:Thom_1972}}"><code>Bigleaf.compute_Gb!</code></a></li><li><a href="../boundary_layer_conductance/#Bigleaf.compute_Gb!"><code>Bigleaf.compute_Gb!</code></a></li><li><a href="#Bigleaf.compute_Gb_quantities-Tuple{Any, Any}"><code>Bigleaf.compute_Gb_quantities</code></a></li><li><a href="#Bigleaf.compute_Ram-Tuple{Val{:wind_profile}, Union{Missing, Number}}"><code>Bigleaf.compute_Ram</code></a></li><li><a href="../aerodynamic_conductance/#Bigleaf.compute_Ram"><code>Bigleaf.compute_Ram</code></a></li><li><a href="../surface_conductance/#Bigleaf.decoupling"><code>Bigleaf.decoupling</code></a></li><li><a href="#Bigleaf.decoupling-Tuple{}"><code>Bigleaf.decoupling</code></a></li><li><a href="../metorological_variables/#Bigleaf.dew_point"><code>Bigleaf.dew_point</code></a></li><li><a href="#Bigleaf.dew_point-Tuple{Any, Any}"><code>Bigleaf.dew_point</code></a></li><li><a href="#Bigleaf.dew_point_from_e-Tuple{Any}"><code>Bigleaf.dew_point_from_e</code></a></li><li><a href="#Bigleaf.e_to_VPD-Tuple{Any, Any}"><code>Bigleaf.e_to_VPD</code></a></li><li><a href="#Bigleaf.e_to_q-Tuple{Any, Any}"><code>Bigleaf.e_to_q</code></a></li><li><a href="#Bigleaf.e_to_rH-Tuple{Any, Any}"><code>Bigleaf.e_to_rH</code></a></li><li><a href="#Bigleaf.equilibrium_imposed_ET-NTuple{5, Any}"><code>Bigleaf.equilibrium_imposed_ET</code></a></li><li><a href="../evapotranspiration/#Bigleaf.equilibrium_imposed_ET"><code>Bigleaf.equilibrium_imposed_ET</code></a></li><li><a href="#Bigleaf.extraterrestrial_radiation-Tuple{Dates.TimeType}"><code>Bigleaf.extraterrestrial_radiation</code></a></li><li><a href="#Bigleaf.extraterrestrial_radiation-Tuple{Number}"><code>Bigleaf.extraterrestrial_radiation</code></a></li><li><a href="../global_radiation/#Bigleaf.extraterrestrial_radiation"><code>Bigleaf.extraterrestrial_radiation</code></a></li><li><a href="#Bigleaf.frac_hour-Tuple{Type{var&quot;#s3&quot;} where var&quot;#s3&quot;&lt;:Dates.Period, Number}"><code>Bigleaf.frac_hour</code></a></li><li><a href="#Bigleaf.gC_to_umolCO2-Tuple{Any}"><code>Bigleaf.gC_to_umolCO2</code></a></li><li><a href="#Bigleaf.get_datetime_for_doy_hour"><code>Bigleaf.get_datetime_for_doy_hour</code></a></li><li><a href="#Bigleaf.get_growingseason-Tuple{Any, Any}"><code>Bigleaf.get_growingseason</code></a></li><li><a href="../filter_data/#Bigleaf.get_growingseason"><code>Bigleaf.get_growingseason</code></a></li><li><a href="#Bigleaf.get_nonoverlapping_periods-Tuple{DataFrame}"><code>Bigleaf.get_nonoverlapping_periods</code></a></li><li><a href="../unit_conversions/#Bigleaf.kg_to_mol"><code>Bigleaf.kg_to_mol</code></a></li><li><a href="#Bigleaf.kg_to_mol"><code>Bigleaf.kg_to_mol</code></a></li><li><a href="../metorological_variables/#Bigleaf.kinematic_viscosity"><code>Bigleaf.kinematic_viscosity</code></a></li><li><a href="#Bigleaf.kinematic_viscosity-Tuple{Any, Any}"><code>Bigleaf.kinematic_viscosity</code></a></li><li><a href="../metorological_variables/#Bigleaf.latent_heat_vaporization"><code>Bigleaf.latent_heat_vaporization</code></a></li><li><a href="#Bigleaf.latent_heat_vaporization-Tuple{Any}"><code>Bigleaf.latent_heat_vaporization</code></a></li><li><a href="#Bigleaf.mol_to_ms-Tuple{Any, Any, Any}"><code>Bigleaf.mol_to_ms</code></a></li><li><a href="#Bigleaf.moving_average-Tuple{Any, Any}"><code>Bigleaf.moving_average</code></a></li><li><a href="../unit_conversions/#Bigleaf.ms_to_mol"><code>Bigleaf.ms_to_mol</code></a></li><li><a href="#Bigleaf.ms_to_mol-Tuple{Any, Any, Any}"><code>Bigleaf.ms_to_mol</code></a></li><li><a href="../evapotranspiration/#Bigleaf.potential_ET"><code>Bigleaf.potential_ET</code></a></li><li><a href="#Bigleaf.potential_ET-Tuple{Val{:PriestleyTaylor}, Any, Any, Any}"><code>Bigleaf.potential_ET</code></a></li><li><a href="#Bigleaf.potential_radiation-Tuple{Dates.TimeType, Any, Any}"><code>Bigleaf.potential_radiation</code></a></li><li><a href="#Bigleaf.potential_radiation-NTuple{4, Any}"><code>Bigleaf.potential_radiation</code></a></li><li><a href="../global_radiation/#Bigleaf.potential_radiation"><code>Bigleaf.potential_radiation</code></a></li><li><a href="../metorological_variables/#Bigleaf.pressure_from_elevation"><code>Bigleaf.pressure_from_elevation</code></a></li><li><a href="#Bigleaf.pressure_from_elevation"><code>Bigleaf.pressure_from_elevation</code></a></li><li><a href="#Bigleaf.psychrometric_constant-Tuple{Any, Any}"><code>Bigleaf.psychrometric_constant</code></a></li><li><a href="../metorological_variables/#Bigleaf.psychrometric_constant"><code>Bigleaf.psychrometric_constant</code></a></li><li><a href="#Bigleaf.q_to_VPD-Tuple{Any, Any, Any}"><code>Bigleaf.q_to_VPD</code></a></li><li><a href="#Bigleaf.q_to_e-Tuple{Any, Any}"><code>Bigleaf.q_to_e</code></a></li><li><a href="#Bigleaf.rH_to_VPD-Tuple{Any, Any}"><code>Bigleaf.rH_to_VPD</code></a></li><li><a href="#Bigleaf.roughness_parameters-Tuple{Val{:canopy_height}, Any}"><code>Bigleaf.roughness_parameters</code></a></li><li><a href="../surface_roughness/#Bigleaf.roughness_parameters"><code>Bigleaf.roughness_parameters</code></a></li><li><a href="#Bigleaf.roughness_z0h-Tuple{Any, Any}"><code>Bigleaf.roughness_z0h</code></a></li><li><a href="../aerodynamic_conductance/#Bigleaf.roughness_z0h"><code>Bigleaf.roughness_z0h</code></a></li><li><a href="#Bigleaf.set_datetime_ydh!"><code>Bigleaf.set_datetime_ydh!</code></a></li><li><a href="../filter_data/#Bigleaf.setinvalid_afterprecip!"><code>Bigleaf.setinvalid_afterprecip!</code></a></li><li><a href="#Bigleaf.setinvalid_afterprecip!-Tuple{Any}"><code>Bigleaf.setinvalid_afterprecip!</code></a></li><li><a href="../filter_data/#Bigleaf.setinvalid_nongrowingseason!"><code>Bigleaf.setinvalid_nongrowingseason!</code></a></li><li><a href="#Bigleaf.setinvalid_nongrowingseason!-Tuple{Any, Any}"><code>Bigleaf.setinvalid_nongrowingseason!</code></a></li><li><a href="#Bigleaf.setinvalid_qualityflag!-Tuple{Any}"><code>Bigleaf.setinvalid_qualityflag!</code></a></li><li><a href="../filter_data/#Bigleaf.setinvalid_qualityflag!"><code>Bigleaf.setinvalid_qualityflag!</code></a></li><li><a href="#Bigleaf.setinvalid_range!-Union{Tuple{N}, Tuple{Any, Vararg{Pair, N}}} where N"><code>Bigleaf.setinvalid_range!</code></a></li><li><a href="../filter_data/#Bigleaf.setinvalid_range!"><code>Bigleaf.setinvalid_range!</code></a></li><li><a href="../stability_correction/#Bigleaf.stability_correction"><code>Bigleaf.stability_correction</code></a></li><li><a href="#Bigleaf.stability_correction-Tuple{Any}"><code>Bigleaf.stability_correction</code></a></li><li><a href="../stability_correction/#Bigleaf.stability_parameter"><code>Bigleaf.stability_parameter</code></a></li><li><a href="#Bigleaf.stability_parameter-Tuple{Any, Any, Any}"><code>Bigleaf.stability_parameter</code></a></li><li><a href="#Bigleaf.surface_conductance-Tuple{Val{:FluxGradient}, Any, Any, Any, Any}"><code>Bigleaf.surface_conductance</code></a></li><li><a href="../surface_conductance/#Bigleaf.surface_conductance"><code>Bigleaf.surface_conductance</code></a></li><li><a href="../unit_conversions/#Bigleaf.umolCO2_to_gC"><code>Bigleaf.umolCO2_to_gC</code></a></li><li><a href="#Bigleaf.umolCO2_to_gC-Tuple{Any}"><code>Bigleaf.umolCO2_to_gC</code></a></li><li><a href="#Bigleaf.virtual_temp-Tuple{Any, Any, Any}"><code>Bigleaf.virtual_temp</code></a></li><li><a href="../metorological_variables/#Bigleaf.virtual_temp"><code>Bigleaf.virtual_temp</code></a></li><li><a href="../metorological_variables/#Bigleaf.wetbulb_temp"><code>Bigleaf.wetbulb_temp</code></a></li><li><a href="#Bigleaf.wetbulb_temp-Tuple{Any, Any, Any}"><code>Bigleaf.wetbulb_temp</code></a></li><li><a href="#Bigleaf.wetbulb_temp_from_e_Tair_gamma-Tuple{Any, Any, Any}"><code>Bigleaf.wetbulb_temp_from_e_Tair_gamma</code></a></li><li><a href="#Bigleaf.wind_profile-Tuple{Number, Union{Missing, Number}, Any, Any, Any}"><code>Bigleaf.wind_profile</code></a></li><li><a href="../surface_roughness/#Bigleaf.wind_profile"><code>Bigleaf.wind_profile</code></a></li></ul><h1 id="Autodocs"><a class="docs-heading-anchor" href="#Autodocs">Autodocs</a><a id="Autodocs-1"></a><a class="docs-heading-anchor-permalink" href="#Autodocs" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.ET_to_LE-Tuple{Any, Any}" href="#Bigleaf.ET_to_LE-Tuple{Any, Any}"><code>Bigleaf.ET_to_LE</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">LE_to_ET(LE,Tair)
ET_to_LE(ET,Tair)</code></pre><p>Convert evaporative water flux from mass (ET=evapotranspiration)              to energy (LE=latent heat flux) units, or vice versa.</p><p><strong>Arguments</strong></p><ul><li>LE   Latent heat flux (W m-2)</li><li>ET   Evapotranspiration (kg m-2 s-1)</li><li>Tair Air temperature (deg C)</li></ul><p><strong>Details</strong></p><p>The conversions are given by:</p><ul><li><span>$ET = LE/\lambda$</span></li><li><span>$LE = \lambda ET$</span></li></ul><p>where <span>$\lambda$</span> is the latent heat of vaporization (J kg-1) as calculated by <a href="../metorological_variables/#Bigleaf.latent_heat_vaporization"><code>latent_heat_vaporization</code></a>.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># LE of 200 Wm-2 and air temperature of 25degC
ET = LE_to_ET(200,25)
≈(ET, 8.19e-5, atol =1e-7)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/unit_conversions.jl#L75-L103">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.Esat_from_Tair-Tuple{Any}" href="#Bigleaf.Esat_from_Tair-Tuple{Any}"><code>Bigleaf.Esat_from_Tair</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Esat_slope(Tair; Esat_formula, constants) 
Esat_from_Tair(Tair; Esat_formula, constants) 
Esat_from_Tair_deriv(Tair; Esat_formula, constants)</code></pre><p>Saturation Vapor Pressure (Esat) and Slope of the Esat Curve</p><p><strong>Arguemtns</strong></p><ul><li><code>Tair</code>:      Air temperature (deg C)</li><li><code>Esat_formula=Val(:Sonntag_1990)</code>:   Esat<em>formula to be used. Either   `Val(:Sonntag</em>1990)<code>(Default),</code>Val(:Alduchov<em>1996<code>, or</code>Val(:Allen</em>1998)`.</li><li><code>constants=bigleaf_constants()</code>: Dictionary with entry  :Pa2kPa </li></ul><p><strong>Details</strong></p><p>Esat (kPa) is calculated using the Magnus equation:</p><p><code>Esat = a * exp((b * Tair) / (c + Tair)) / 1000</code> where the coefficients a, b, c take different values depending on the Esat_formula use The default values are from Sonntag 1990 (a=611.2, b=17.62, c=243.12). This versi of the Magnus equation is recommended by the WMO (WMO 2008; p1.4-29). Alternativel parameter values determined by Alduchov &amp; Eskridge 1996 or Allen et al. 1998 can b used (see references). The slope of the Esat curve (<span>$\Delta$</span>) is calculated as the first derivative of the function:</p><p><span>$\Delta = {dEsat \over dTair}$</span></p><p><strong>Value</strong></p><ul><li><code>Esat_from_Tair</code>: Saturation vapor pressure (kPa)</li><li><code>Esat_from_Tair_deriv</code>: Slope of the saturation vapor pressure curve (kPa K-1)</li><li><code>Esat_slope</code>: A tuple of the two above values</li></ul><p><strong>References</strong></p><p>Sonntag D. 1990: Important new values of the physical constants of 1986, vapor  pressure formulations based on the ITS-90 and psychrometric formulae.  Zeitschrift fuer Meteorologie 70, 340-344.</p><p>World Meteorological Organization 2008: Guide to Meteorological Instruments and Methods of Observation (WMO-No.8). World Meteorological Organization, Geneva. 7th Edition,</p><p>Alduchov, O. A. &amp; Eskridge, R. E., 1996: Improved Magnus form approximation of  saturation vapor pressure. Journal of Applied Meteorology, 35, 601-609</p><p>Allen, R.G., Pereira, L.S., Raes, D., Smith, M., 1998: Crop evapotranspiration - Guidelines for computing crop water requirements - FAO irrigation and drainage paper 56, FAO, Rome.</p><pre><code class="language- hljs">Esat_from_Tair(20.0)          # Esat in kPa
Esat_from_Tair_deriv(20.0)    # its derivative to temperature in kPa K-1
Esat_slope(20.0)              # both as a tuple</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/unit_conversions.jl#L1-L52">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.Esat_from_Tair_deriv-Tuple{Any}" href="#Bigleaf.Esat_from_Tair_deriv-Tuple{Any}"><code>Bigleaf.Esat_from_Tair_deriv</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Esat_slope(Tair; Esat_formula, constants) 
Esat_from_Tair(Tair; Esat_formula, constants) 
Esat_from_Tair_deriv(Tair; Esat_formula, constants)</code></pre><p>Saturation Vapor Pressure (Esat) and Slope of the Esat Curve</p><p><strong>Arguemtns</strong></p><ul><li><code>Tair</code>:      Air temperature (deg C)</li><li><code>Esat_formula=Val(:Sonntag_1990)</code>:   Esat<em>formula to be used. Either   `Val(:Sonntag</em>1990)<code>(Default),</code>Val(:Alduchov<em>1996<code>, or</code>Val(:Allen</em>1998)`.</li><li><code>constants=bigleaf_constants()</code>: Dictionary with entry  :Pa2kPa </li></ul><p><strong>Details</strong></p><p>Esat (kPa) is calculated using the Magnus equation:</p><p><code>Esat = a * exp((b * Tair) / (c + Tair)) / 1000</code> where the coefficients a, b, c take different values depending on the Esat_formula use The default values are from Sonntag 1990 (a=611.2, b=17.62, c=243.12). This versi of the Magnus equation is recommended by the WMO (WMO 2008; p1.4-29). Alternativel parameter values determined by Alduchov &amp; Eskridge 1996 or Allen et al. 1998 can b used (see references). The slope of the Esat curve (<span>$\Delta$</span>) is calculated as the first derivative of the function:</p><p><span>$\Delta = {dEsat \over dTair}$</span></p><p><strong>Value</strong></p><ul><li><code>Esat_from_Tair</code>: Saturation vapor pressure (kPa)</li><li><code>Esat_from_Tair_deriv</code>: Slope of the saturation vapor pressure curve (kPa K-1)</li><li><code>Esat_slope</code>: A tuple of the two above values</li></ul><p><strong>References</strong></p><p>Sonntag D. 1990: Important new values of the physical constants of 1986, vapor  pressure formulations based on the ITS-90 and psychrometric formulae.  Zeitschrift fuer Meteorologie 70, 340-344.</p><p>World Meteorological Organization 2008: Guide to Meteorological Instruments and Methods of Observation (WMO-No.8). World Meteorological Organization, Geneva. 7th Edition,</p><p>Alduchov, O. A. &amp; Eskridge, R. E., 1996: Improved Magnus form approximation of  saturation vapor pressure. Journal of Applied Meteorology, 35, 601-609</p><p>Allen, R.G., Pereira, L.S., Raes, D., Smith, M., 1998: Crop evapotranspiration - Guidelines for computing crop water requirements - FAO irrigation and drainage paper 56, FAO, Rome.</p><pre><code class="language- hljs">Esat_from_Tair(20.0)          # Esat in kPa
Esat_from_Tair_deriv(20.0)    # its derivative to temperature in kPa K-1
Esat_slope(20.0)              # both as a tuple</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/unit_conversions.jl#L1-L52">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.Esat_slope-Tuple{Number}" href="#Bigleaf.Esat_slope-Tuple{Number}"><code>Bigleaf.Esat_slope</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Esat_slope(Tair; Esat_formula, constants) 
Esat_from_Tair(Tair; Esat_formula, constants) 
Esat_from_Tair_deriv(Tair; Esat_formula, constants)</code></pre><p>Saturation Vapor Pressure (Esat) and Slope of the Esat Curve</p><p><strong>Arguemtns</strong></p><ul><li><code>Tair</code>:      Air temperature (deg C)</li><li><code>Esat_formula=Val(:Sonntag_1990)</code>:   Esat<em>formula to be used. Either   `Val(:Sonntag</em>1990)<code>(Default),</code>Val(:Alduchov<em>1996<code>, or</code>Val(:Allen</em>1998)`.</li><li><code>constants=bigleaf_constants()</code>: Dictionary with entry  :Pa2kPa </li></ul><p><strong>Details</strong></p><p>Esat (kPa) is calculated using the Magnus equation:</p><p><code>Esat = a * exp((b * Tair) / (c + Tair)) / 1000</code> where the coefficients a, b, c take different values depending on the Esat_formula use The default values are from Sonntag 1990 (a=611.2, b=17.62, c=243.12). This versi of the Magnus equation is recommended by the WMO (WMO 2008; p1.4-29). Alternativel parameter values determined by Alduchov &amp; Eskridge 1996 or Allen et al. 1998 can b used (see references). The slope of the Esat curve (<span>$\Delta$</span>) is calculated as the first derivative of the function:</p><p><span>$\Delta = {dEsat \over dTair}$</span></p><p><strong>Value</strong></p><ul><li><code>Esat_from_Tair</code>: Saturation vapor pressure (kPa)</li><li><code>Esat_from_Tair_deriv</code>: Slope of the saturation vapor pressure curve (kPa K-1)</li><li><code>Esat_slope</code>: A tuple of the two above values</li></ul><p><strong>References</strong></p><p>Sonntag D. 1990: Important new values of the physical constants of 1986, vapor  pressure formulations based on the ITS-90 and psychrometric formulae.  Zeitschrift fuer Meteorologie 70, 340-344.</p><p>World Meteorological Organization 2008: Guide to Meteorological Instruments and Methods of Observation (WMO-No.8). World Meteorological Organization, Geneva. 7th Edition,</p><p>Alduchov, O. A. &amp; Eskridge, R. E., 1996: Improved Magnus form approximation of  saturation vapor pressure. Journal of Applied Meteorology, 35, 601-609</p><p>Allen, R.G., Pereira, L.S., Raes, D., Smith, M., 1998: Crop evapotranspiration - Guidelines for computing crop water requirements - FAO irrigation and drainage paper 56, FAO, Rome.</p><pre><code class="language- hljs">Esat_from_Tair(20.0)          # Esat in kPa
Esat_from_Tair_deriv(20.0)    # its derivative to temperature in kPa K-1
Esat_slope(20.0)              # both as a tuple</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/unit_conversions.jl#L1-L52">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.Gb_Choudhury-Tuple{}" href="#Bigleaf.Gb_Choudhury-Tuple{}"><code>Bigleaf.Gb_Choudhury</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Gb_Choudhury(; leafwidth, LAI, wind_zh, constants)
Gb_Choudhury!(df; leafwidth, LAI, wind_zh, constants)</code></pre><p>Estimate the canopy boundary layer conductance  for heat transfer according to Choudhury &amp; Monteith 1988.</p><p><strong>Arguments</strong></p><ul><li><code>df</code>               : DataFrame where <code>Gb_h</code> is to be added/updated</li><li><code>leafwidth</code>        : Leaf width (m)</li><li><code>LAI</code>              : One-sided leaf area index</li><li><code>wind_zh</code>          : Wind speed at canopy heihgt (m s-1), see <a href="../surface_roughness/#Bigleaf.wind_profile"><code>wind_profile</code></a> </li><li><code>constants=</code><a href="../bigleaf_constants/#Bigleaf.bigleaf_constants"><code>bigleaf_constants</code></a><code>()</code></li></ul><p><strong>Value</strong></p><p>see <a href="../boundary_layer_conductance/#Bigleaf.compute_Gb!"><code>compute_Gb!</code></a></p><p><strong>Details</strong></p><p>Boundary layer conductance according to Choudhury &amp; Monteith 1988 is given by:</p><p><span>$Gb_h = LAI \left( 2a/\alpha \sqrt{u(z_h)/w} (1-e^{-\alpha/2})\right)$</span></p><p>where <span>$\alpha$</span> is modeled as an empirical relation to LAI (McNaughton &amp; van den Hurk 1995):</p><p><span>$\alpha = 4.39 - 3.97 e^{-0.258 \, LAI}$</span></p><p><span>$w$</span> is leafwidth and <span>$u(zh)$</span> is the wind speed at the canopy surface.</p><p>It can be approximated from measured wind speed at sensor height zr and a wind extinction  coefficient <span>$\alpha$</span>: <span>$u(z_h) = u(z_r) / e^{\alpha(z_r/z_h -1)}$</span>. However, here (if not explicitly given) it is estimated by <a href="../surface_roughness/#Bigleaf.wind_profile"><code>wind_profile</code></a></p><p><strong>References</strong></p><ul><li>Choudhury, B. J., Monteith J_L., 1988: A four-layer model for the heat budget of homogeneous land surfaces. Q. J. R. Meteorol. Soc. 114, 373-398.</li><li>McNaughton, K. G., Van den Hurk, B<em>J</em>J_M., 1995: A &#39;Lagrangian&#39; revision of the resistors in the two-layer model for calculating the energy budget of a plant canopy. Boundary-Layer Meteorology 74, 261-288.</li><li>Hicks, B<em>B., Baldocchi, D</em>D., Meyers, T<em>P., Hosker, J</em>R., Matt, D_R., 1987: A preliminary multiple resistance routine for deriving dry deposition velocities from measured quantities. Water, Air, and Soil Pollution 36, 311-330.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/boundary_layer_conductance.jl#L207-L249">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.Gb_Su-Tuple{Any, Any, Any}" href="#Bigleaf.Gb_Su-Tuple{Any, Any, Any}"><code>Bigleaf.Gb_Su</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Gb_Su(Tair,pressure,ustar; wind_zh, Dl, fc, N=2, Cd=0.2, hs=0.01, constants)
Gb_Su!(df; wind_zh, Dl, fc=nothing, N=2, Cd=0.2, hs=0.01, LAI, constants)</code></pre><p>Estimate Boundary Layer Conductance to heat transfer using the physically based  formulation according to Su et al. 2001. </p><p><strong>Arguments</strong></p><ul><li><code>Tair</code>      : Air temperature (degC)</li><li><code>pressure</code>  : Atmospheric pressure (kPa)</li><li><code>ustar</code>     : Friction velocity (m s-1)</li><li><code>df</code>        : DataFrame or matrix containing the above variables</li><li><code>Dl</code>        : Leaf characteristic dimension (m)</li><li><code>fc</code>        : Fractional vegetation cover <a href="if not provided, calculated from LAI">0-1</a></li><li><code>LAI</code>       : One-sided leaf area index (-) - alternative to <code>fc</code>.</li><li><code>N</code>         : Number of leaf sides participating in heat exchange (defaults to 2)</li><li><code>Cd</code>        : Foliage drag coefficient (-)</li><li><code>hs</code>        : Roughness height of the soil (m)</li><li><code>constants=</code><a href="../bigleaf_constants/#Bigleaf.bigleaf_constants"><code>bigleaf_constants</code></a><code>()</code></li></ul><p><strong>Value</strong></p><p>see <a href="../boundary_layer_conductance/#Bigleaf.compute_Gb!"><code>compute_Gb!</code></a></p><p><strong>Details</strong></p><p>The formulation is based on the kB-1 model developed by Massman 1999.  Su et al. 2001 derived the following approximation:</p><p><span>$k_{B1} = (k C_d f_c^2) / (4C_t u^*/u(z_h)) + k_{Bs-1}(1 - f_c)^2$</span></p><p>If <span>$f_c$</span> (fractional vegetation cover) is missing, it is estimated from LAI: <span>$f_c = 1 - e^{-LAI/2}$</span></p><p>The wind speed at the top of the canopy is calculated using function <a href="../surface_roughness/#Bigleaf.wind_profile"><code>wind_profile</code></a>.</p><p>Ct is the heat transfer coefficient of the leaf (Massman 1999):</p><p><span>$C_t = P_r^{-2/3} R_{eh}^{-1/2}  N$</span></p><p>where <span>$P_r$</span> is the Prandtl number (set to 0.71),  and <span>$R_{eh}$</span> is the Reynolds number for leaves:</p><p><span>$R_{eh} = D_l \, wind(z_h) / v$</span></p><p>k<em>{Bs-1}, the k</em>{B-1} value for bare soil surface, is calculated according  to Su et al. 2001:</p><p><span>$k_{Bs-1} = 2.46(Re)^{0.25} - ln(7.4)$</span></p><p><strong>References</strong></p><ul><li>Su, Z., Schmugge, T., Kustas, W. &amp; Massman, W., 2001: An evaluation of two models for estimation of the roughness height for heat transfer between the land surface and the atmosphere. Journal of Applied Meteorology 40, 1933-1951.</li><li>Massman, W., 1999: A model study of kB H- 1 for vegetated surfaces using localized near-field&#39; Lagrangian theory. Journal of Hydrology 223, 27-43.</li><li>Hicks, B<em>B., Baldocchi, D</em>D., Meyers, T<em>P., Hosker, J</em>R., Matt, D_R., 1987:  A preliminary multiple resistance routine for deriving dry deposition velocities from measured quantities. Water, Air, and Soil Pollution 36, 311-330.</li></ul><pre><code class="language-julia hljs">using DataFrames
df = DataFrame(Tair=25,pressure=100,wind=[3,4,5],ustar=[0.5,0.6,0.65],H=[200,230,250]) 
zh = 25; zr = 40
z0m = roughness_parameters(
  Val(:wind_profile), df.ustar, df.wind, df.Tair, df.pressure, df.H; zh, zr).z0m 
wind_zh = wind_profile(zh, df, 0.7*zh, z0m)
compute_Gb!(df,Val(:Su_2001); wind_zh, Dl=0.01, LAI=5)
# the same meteorological conditions, but larger leaves
compute_Gb!(df,Val(:Su_2001); wind_zh, Dl=0.1,LAI=5)
# same conditions, large leaves, and sparse canopy cover (LAI = 1.5)
compute_Gb!(df,Val(:Su_2001); wind_zh, Dl=0.1,LAI=1.5)
≈(df.Gb_h[1], 0.0638, rtol=1e-3)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/boundary_layer_conductance.jl#L273-L348">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.Gb_Thom-Tuple{Union{Missing, Number}}" href="#Bigleaf.Gb_Thom-Tuple{Union{Missing, Number}}"><code>Bigleaf.Gb_Thom</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Gb_Thom(ustar; constants)
compute_Gb!(df, Val{:Thom_1972})</code></pre><p>Boundary Layer Conductance according to Thom 1972, an empirical formulation for the  for heat transfer based on a simple ustar (friction velocity) dependency.</p><p><strong>Arguments</strong></p><ul><li><code>ustar</code>     : Friction velocity (m s-1)</li><li><code>df</code>        : DataFrame with above variables</li><li><code>constants=</code><a href="../bigleaf_constants/#Bigleaf.bigleaf_constants"><code>bigleaf_constants</code></a><code>()</code></li></ul><p><strong>Details</strong></p><p>The empirical equation for Rb suggested by Thom 1972 is:</p><p><span>$Rb = 6.2 {u^*}^{-0.67}$</span></p><p>Gb (=1/Rb) for water vapor and heat are assumed to be equal in this package.</p><p><strong>Value</strong></p><p>see <a href="../boundary_layer_conductance/#Bigleaf.compute_Gb!"><code>compute_Gb!</code></a></p><p><strong>References</strong></p><ul><li>Thom, A., 1972: Momentum, mass and heat exchange of vegetation. Quarterly Journal of the Royal Meteorological Society 98, 124-134.</li><li>Hicks, B<em>B., Baldocchi, D</em>D., Meyers, T<em>P., Hosker, J</em>R., Matt, D_R., 1987: A preliminary multiple resistance routine for deriving dry deposition velocities from measured quantities. Water, Air, and Soil Pollution 36, 311-330.</li></ul><pre><code class="language- hljs">using DataFrames
df = DataFrame(ustar = SA[0.1,missing,0.3])
compute_Gb!(df, Val(:Thom_1972))
propertynames(df) == [:ustar, :Gb_h]</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/boundary_layer_conductance.jl#L144-L179">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.Gb_constant_kB1-Tuple{Any, Any}" href="#Bigleaf.Gb_constant_kB1-Tuple{Any, Any}"><code>Bigleaf.Gb_constant_kB1</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Gb_constant_kB1(ustar, kB_h; constants)
compute_Gb!(df, Val{:constant_kB1})</code></pre><p>Boundary Layer Conductance using constant kB-1 value for heat transfer.</p><p><strong>Arguments</strong></p><ul><li><code>ustar</code>     : Friction velocity (m s-1)</li><li><code>df</code>        : DataFrame with above variables</li><li><code>kB_h</code>      : kB-1 value for heat transfer</li><li><code>constants=</code><a href="../bigleaf_constants/#Bigleaf.bigleaf_constants"><code>bigleaf_constants</code></a><code>()</code></li></ul><p><strong>Details</strong></p><p>Rb<em>h computed by ``kB</em>h/(k * ustar)``, where k is the von Karman constant.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/boundary_layer_conductance.jl#L185-L199">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.LE_to_ET-Tuple{Any, Any}" href="#Bigleaf.LE_to_ET-Tuple{Any, Any}"><code>Bigleaf.LE_to_ET</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">LE_to_ET(LE,Tair)
ET_to_LE(ET,Tair)</code></pre><p>Convert evaporative water flux from mass (ET=evapotranspiration)              to energy (LE=latent heat flux) units, or vice versa.</p><p><strong>Arguments</strong></p><ul><li>LE   Latent heat flux (W m-2)</li><li>ET   Evapotranspiration (kg m-2 s-1)</li><li>Tair Air temperature (deg C)</li></ul><p><strong>Details</strong></p><p>The conversions are given by:</p><ul><li><span>$ET = LE/\lambda$</span></li><li><span>$LE = \lambda ET$</span></li></ul><p>where <span>$\lambda$</span> is the latent heat of vaporization (J kg-1) as calculated by <a href="../metorological_variables/#Bigleaf.latent_heat_vaporization"><code>latent_heat_vaporization</code></a>.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># LE of 200 Wm-2 and air temperature of 25degC
ET = LE_to_ET(200,25)
≈(ET, 8.19e-5, atol =1e-7)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/unit_conversions.jl#L75-L103">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.Monin_Obukhov_length-NTuple{4, Any}" href="#Bigleaf.Monin_Obukhov_length-NTuple{4, Any}"><code>Bigleaf.Monin_Obukhov_length</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Monin_Obukhov_length(Tair, pressure, ustar, H; constants)
Monin_Obukhov_length!(df;constants=bigleaf_constants())
Monin_Obukhov_length(df;constants=bigleaf_constants())</code></pre><p>calculates the Monin-Obukhov length.</p><p><strong>Arguments</strong></p><ul><li><code>Tair</code>      : Air temperature (degC)</li><li><code>pressure</code>  : Atmospheric pressure (kPa)</li><li><code>ustar</code>     : Friction velocity (m s-1)</li><li><code>H</code>         : Sensible heat flux (W m-2)</li><li><code>df</code>        : DataFrame containing the above variables</li></ul><p>optional</p><ul><li><code>constants=</code><a href="../bigleaf_constants/#Bigleaf.bigleaf_constants"><code>bigleaf_constants</code></a><code>()</code>: Dictionary with entries <ul><li><code>Kelvin</code> - conversion degree Celsius to Kelvin </li><li><code>cp</code> - specific heat of air for constant pressure (J K-1 1) </li><li><code>k</code> - von Karman constant (-) </li><li><code>g</code> - gravitational acceleration (m s-2)</li></ul></li></ul><p><strong>Details</strong></p><p>The Monin-Obukhov length (L) is given by:</p><p><span>$L = - (\rho * cp * ustar^3 * Tair) / (k * g * H)$</span></p><p>where <span>$\rho$</span> is air density (kg m-3).</p><p><strong>Note</strong></p><p>Note that L gets very small for very low ustar values with implications for subsequent functions using L as input. It is recommended to filter data and exclude low ustar values (ustar &lt; ~0.2) beforehand. </p><p><strong>Value</strong></p><p>Monin-Obukhov length L (m). The non-mutating DataFrame variant returns a vector, the mutating variant add or modifies column <code>:MOL</code>.</p><p><strong>References</strong></p><p>Foken, T, 2008: Micrometeorology. Springer, Berlin, Germany. </p><p><strong>See also</strong></p><p><a href="../stability_correction/#Bigleaf.stability_parameter"><code>stability_parameter</code></a></p><pre><code class="language- hljs">Monin_Obukhov_length(
  Tair=25,pressure=100,
  ustar=seq(0.2,1,0.1),H=seq(40,200,20))</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/stability_correction.jl#L1-L49">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.PPFD_to_Rg" href="#Bigleaf.PPFD_to_Rg"><code>Bigleaf.PPFD_to_Rg</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">Rg_to_PPFD(Rg,J_to_mol=4.6,frac_PAR=0.5)
PPFD_to_Rg(PPFD,J_to_mol=4.6,frac_PAR=0.5)</code></pre><p>Conversions between Global Radiation (W m-2) and Photosynthetic Photon Flux  Density (umol m-2 s-1)</p><p><strong>Arguments</strong></p><ul><li>Rg:       Global radiation = incoming short-wave radiation at the surface (W m-2)</li><li>PPFD:     Photosynthetic photon flux density (umol m-2 s-1)</li><li>J<em>to</em>mol: Conversion factor from J m-2 s-1 (= W m-2) to umol (quanta) m-2 s-1</li><li>frac_PAR: Fraction of incoming solar irradiance that is photosynthetical-           active radiation (PAR); defaults to 0.5</li></ul><p><strong>Details</strong></p><p>The conversion is given by:</p><p><span>$PPFD = Rg * frac_PAR * J_to_mol$</span></p><p>by default, the combined conversion factor (<code>frac_PAR * J_to_mol</code>) is 2.3</p><p><strong>Examples</strong></p><pre><code class="language- hljs"># convert a measured incoming short-wave radiation of 500 Wm-2 to
# PPFD in umol m-2 s-1 and backwards
Rg_to_PPFD(500)
PPFD_to_Rg(1150)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/unit_conversions.jl#L234-L262">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.Reynolds_Number-NTuple{4, Any}" href="#Bigleaf.Reynolds_Number-NTuple{4, Any}"><code>Bigleaf.Reynolds_Number</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Reynolds_Number(Tair,pressure,ustar,z0m; constants)</code></pre><p>calculates the Roughness Reynolds Number.</p><p><strong>Arguments</strong></p><ul><li><code>Tair</code>      : Air temperature (deg C)</li><li><code>pressure</code>  : Atmospheric pressure (kPa)</li><li><code>ustar</code>     : Friction velocity (m s-1)</li><li><code>z0m</code>       : Roughness length (m)</li></ul><p>optional</p><ul><li><code>constants=</code><a href="../bigleaf_constants/#Bigleaf.bigleaf_constants"><code>bigleaf_constants</code></a><code>()</code></li></ul><p><strong>Details</strong></p><p>The Roughness Reynolds Number is calculated as in Massman 1999a:      <span>$Re = z0m * ustar / v$</span>, where <code>v</code> is the kinematic viscosity (m2 s-1).</p><p><strong>Value</strong></p><p>Roughness Reynolds Number (-)</p><p><strong>References</strong></p><p>Massman, W_J., 1999a: A model study of kB H- 1 for vegetated surfaces using &#39;localized near-field&#39; Lagrangian theory. Journal of Hydrology 223, 27-43.</p><pre><code class="language-julia hljs">Tair,pressure,ustar,z0m = 25,100,0.5,0.5
R = Reynolds_Number(Tair,pressure,ustar,z0m)                             
≈(R, 15870, rtol=1e-3)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/surface_roughness.jl#L1-L32">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.Rg_to_PPFD" href="#Bigleaf.Rg_to_PPFD"><code>Bigleaf.Rg_to_PPFD</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">Rg_to_PPFD(Rg,J_to_mol=4.6,frac_PAR=0.5)
PPFD_to_Rg(PPFD,J_to_mol=4.6,frac_PAR=0.5)</code></pre><p>Conversions between Global Radiation (W m-2) and Photosynthetic Photon Flux  Density (umol m-2 s-1)</p><p><strong>Arguments</strong></p><ul><li>Rg:       Global radiation = incoming short-wave radiation at the surface (W m-2)</li><li>PPFD:     Photosynthetic photon flux density (umol m-2 s-1)</li><li>J<em>to</em>mol: Conversion factor from J m-2 s-1 (= W m-2) to umol (quanta) m-2 s-1</li><li>frac_PAR: Fraction of incoming solar irradiance that is photosynthetical-           active radiation (PAR); defaults to 0.5</li></ul><p><strong>Details</strong></p><p>The conversion is given by:</p><p><span>$PPFD = Rg * frac_PAR * J_to_mol$</span></p><p>by default, the combined conversion factor (<code>frac_PAR * J_to_mol</code>) is 2.3</p><p><strong>Examples</strong></p><pre><code class="language- hljs"># convert a measured incoming short-wave radiation of 500 Wm-2 to
# PPFD in umol m-2 s-1 and backwards
Rg_to_PPFD(500)
PPFD_to_Rg(1150)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/unit_conversions.jl#L234-L262">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.VPD_to_e-Tuple{Any, Any}" href="#Bigleaf.VPD_to_e-Tuple{Any, Any}"><code>Bigleaf.VPD_to_e</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">VPD_to_rH(VPD,Tair; ...)
H_to_VPD(rH,Tair; ...)
e_to_rH(e,Tair; ...)
VPD_to_e(VPD,Tair; ...)
e_to_VPD(e,Tair; ...)
e_to_q(e,pressure; ...)
q_to_e(q,pressure; ...)
q_to_VPD(q,Tair,pressure; ...)
VPD_to_q(VPD,Tair,pressure; ...)</code></pre><p>Conversion between vapor pressure (e), vapor pressure deficit (VPD),              specific humidity (q), and relative humidity (rH).</p><p><strong>Arguments</strong></p><ul><li>Tair:      Air temperature (deg C)</li><li>pressure:  Atmospheric pressure (kPa)</li><li>e:         Vapor pressure (kPa)</li><li>q:        Specific humidity (kg kg-1)</li><li>VPD:       Vapor pressure deficit (kPa)</li><li>rH:        Relative humidity (-)</li></ul><p>All functions accept the optional arguemtns:</p><ul><li><code>Esat_formula</code>: formula used in <a href="../metorological_variables/#Bigleaf.Esat_from_Tair"><code>Esat_from_Tair</code></a></li><li><code>constants</code>: dictionary from <a href="../bigleaf_constants/#Bigleaf.bigleaf_constants"><code>bigleaf_constants</code></a> with entries eps and Pa2kPa</li></ul><p><strong>Rreferences</strong></p><p>Foken, T, 2008: Micrometeorology_ Springer, Berlin, Germany.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/unit_conversions.jl#L153-L182">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.VPD_to_q-Tuple{Any, Any, Any}" href="#Bigleaf.VPD_to_q-Tuple{Any, Any, Any}"><code>Bigleaf.VPD_to_q</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">VPD_to_rH(VPD,Tair; ...)
H_to_VPD(rH,Tair; ...)
e_to_rH(e,Tair; ...)
VPD_to_e(VPD,Tair; ...)
e_to_VPD(e,Tair; ...)
e_to_q(e,pressure; ...)
q_to_e(q,pressure; ...)
q_to_VPD(q,Tair,pressure; ...)
VPD_to_q(VPD,Tair,pressure; ...)</code></pre><p>Conversion between vapor pressure (e), vapor pressure deficit (VPD),              specific humidity (q), and relative humidity (rH).</p><p><strong>Arguments</strong></p><ul><li>Tair:      Air temperature (deg C)</li><li>pressure:  Atmospheric pressure (kPa)</li><li>e:         Vapor pressure (kPa)</li><li>q:        Specific humidity (kg kg-1)</li><li>VPD:       Vapor pressure deficit (kPa)</li><li>rH:        Relative humidity (-)</li></ul><p>All functions accept the optional arguemtns:</p><ul><li><code>Esat_formula</code>: formula used in <a href="../metorological_variables/#Bigleaf.Esat_from_Tair"><code>Esat_from_Tair</code></a></li><li><code>constants</code>: dictionary from <a href="../bigleaf_constants/#Bigleaf.bigleaf_constants"><code>bigleaf_constants</code></a> with entries eps and Pa2kPa</li></ul><p><strong>Rreferences</strong></p><p>Foken, T, 2008: Micrometeorology_ Springer, Berlin, Germany.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/unit_conversions.jl#L153-L182">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.VPD_to_rH-Tuple{Any, Any}" href="#Bigleaf.VPD_to_rH-Tuple{Any, Any}"><code>Bigleaf.VPD_to_rH</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">VPD_to_rH(VPD,Tair; ...)
H_to_VPD(rH,Tair; ...)
e_to_rH(e,Tair; ...)
VPD_to_e(VPD,Tair; ...)
e_to_VPD(e,Tair; ...)
e_to_q(e,pressure; ...)
q_to_e(q,pressure; ...)
q_to_VPD(q,Tair,pressure; ...)
VPD_to_q(VPD,Tair,pressure; ...)</code></pre><p>Conversion between vapor pressure (e), vapor pressure deficit (VPD),              specific humidity (q), and relative humidity (rH).</p><p><strong>Arguments</strong></p><ul><li>Tair:      Air temperature (deg C)</li><li>pressure:  Atmospheric pressure (kPa)</li><li>e:         Vapor pressure (kPa)</li><li>q:        Specific humidity (kg kg-1)</li><li>VPD:       Vapor pressure deficit (kPa)</li><li>rH:        Relative humidity (-)</li></ul><p>All functions accept the optional arguemtns:</p><ul><li><code>Esat_formula</code>: formula used in <a href="../metorological_variables/#Bigleaf.Esat_from_Tair"><code>Esat_from_Tair</code></a></li><li><code>constants</code>: dictionary from <a href="../bigleaf_constants/#Bigleaf.bigleaf_constants"><code>bigleaf_constants</code></a> with entries eps and Pa2kPa</li></ul><p><strong>Rreferences</strong></p><p>Foken, T, 2008: Micrometeorology_ Springer, Berlin, Germany.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/unit_conversions.jl#L153-L182">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.add_Ga!-Union{Tuple{N}, Tuple{AbstractDataFrame, Vararg{Pair, N}}} where N" href="#Bigleaf.add_Ga!-Union{Tuple{N}, Tuple{AbstractDataFrame, Vararg{Pair, N}}} where N"><code>Bigleaf.add_Ga!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">add_Ga(Gb_h, Ga_m, Sc::Vararg{Pair,N}; constants)
add_Ga!(df::AbstractDataFrame, Sc; Gb_h = df.Gb_h, Ga_m = df.Ga.m, kwargs...)</code></pre><p>compute additional aerodynamic conductance quantities for given Schmidt-numbers</p><p><strong>Arguments</strong></p><ul><li><code>Gb_h</code>     : Boundary layer conductance for heat transfer (m s-1)</li><li><code>Ga_m</code>     : Aerodynamic conductance for momentum (m s-1)</li><li><code>Sc</code>       : several <code>Pair{Symbol,Number}</code> Output name and Schmidt number of               additional conductances to be calculated</li><li><code>df</code>       : DataFrame to add output columns               </li></ul><p>optional</p><ul><li><code>constants=</code><a href="../bigleaf_constants/#Bigleaf.bigleaf_constants"><code>bigleaf_constants</code></a><code>()</code>: Dictionary with entries <ul><li><code>Pr</code> - Prandtl number </li></ul></li></ul><p><strong>Details</strong></p><p>Aerodynamic conductance is calculated as</p><p><span>$G_{a_x} = 1/(1/G_{a_m} + 1/G_{b_x})$</span></p><p>where <code>Gb_x</code> is the Boundary layer conductance for other quantities x is calculated  based on boundary layer for heat transfer, Schmidt-Number, and  Prantl number, as documented in <a href="../boundary_layer_conductance/#Bigleaf.add_Gb!"><code>add_Gb!</code></a>.</p><p><strong>Value</strong></p><p>a NameTuple or <code>df</code> with keys <code>Ga_x</code> where <code>x</code> are the keys in <code>Sc</code> and  corresponding aerodynamic conductances (m s-1).</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">using DataFrames
df = DataFrame(Gb_h=[0.02, missing, 0.055], Ga_m = 1 ./ [0.03, 0.03, 0.03])
add_Ga!(df, :O2 =&gt; 0.84, :CH4 =&gt; 0.99)
propertynames(df)[3:4] == [:Ga_O2, :Ga_CH4]</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/aerodynamic_conductance.jl#L246-L284">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.add_Gb!-Union{Tuple{N}, Tuple{AbstractDataFrame, Vararg{Pair, N}}} where N" href="#Bigleaf.add_Gb!-Union{Tuple{N}, Tuple{AbstractDataFrame, Vararg{Pair, N}}} where N"><code>Bigleaf.add_Gb!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">add_Gb(Gb_h::Union{Missing,Number}, Sc::Vararg{Pair,N}; constants)
add_Gb!(df::AbstractDataFrame, Sc::Vararg{Pair,N}; Gb_h = df.Gb_h, kwargs...)</code></pre><p>compute boundary layer conductance for additional quantities for given Schmidt-numbers</p><p><strong>Arguments</strong></p><ul><li><code>Gb_h</code>     : Boundary layer conductance for heat transfer (m s-1)</li><li><code>Sc</code>       : several <code>Pair{Symbol,Number}</code> Output name and Schmidt number of               additional conductances to be calculated</li><li><code>df</code>       : DataFrame to add output columns               </li></ul><p>optional</p><ul><li><code>constants=</code><a href="../bigleaf_constants/#Bigleaf.bigleaf_constants"><code>bigleaf_constants</code></a><code>()</code>: Dictionary with entries <ul><li><code>Pr</code> - Prandtl number </li></ul></li></ul><p><strong>Details</strong></p><p>Boundary layer conductance for other quantities x is calculated  based on boundary layer for heat transfer as (Hicks et al. 1987):</p><p><span>$Gb_x = Gb_h / (Sc_x / Pr)^{0.67}$</span></p><p>where <code>Sc_x</code> is the Schmidt number of quantity x, and Pr is the Prandtl number (0.71).</p><p><strong>Value</strong></p><p>a NameTuple or <code>df</code> with keys <code>Gb_x</code> where <code>x</code> are the keys in <code>Sc</code> and  corresponding boundary layer conductances (m s-1).</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">using DataFrames
df = DataFrame(Gb_h=[0.02, missing, 0.055])
add_Gb!(df, :O2 =&gt; 0.84, :CH4 =&gt; 0.99)
propertynames(df)[2:3] == [:Gb_O2, :Gb_CH4]</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/boundary_layer_conductance.jl#L84-L120">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.aerodynamic_conductance!-Tuple{Any}" href="#Bigleaf.aerodynamic_conductance!-Tuple{Any}"><code>Bigleaf.aerodynamic_conductance!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">aerodynamic_conductance!(df; 
  Gb_model = Val(:Thom_1972), Ram_model = Val(:wind_zr),
  zr=nothing,zh=nothing, d = isnothing(zh) ? nothing : 0.7*zh,
  ...
  )</code></pre><p>Bulk aerodynamic conductance, including options for the boundary layer conductance formulation and stability correction functions.</p><p><strong>Arguments</strong></p><ul><li><code>df</code>: DataFrame with columns<ul><li><code>ustar</code>     : Friction velocity (m s-1)</li><li><code>wind</code>      : Wind speed at sensor height (m s-1)</li></ul></li><li><code>Gb_model</code>  : model for computing boundary layer conductance (see <a href="../boundary_layer_conductance/#Bigleaf.compute_Gb!"><code>compute_Gb!</code></a>)</li><li><code>Ram_model</code> : model for computing aerodynamic resistance (see <a href="../aerodynamic_conductance/#Bigleaf.compute_Ram"><code>compute_Ram</code></a>)</li><li><code>zh</code>        : canopy height (m)</li><li><code>zr</code>        : Instrument (reference) height (m)</li></ul><p>Further required columns of <code>df</code> and keyword argument depend on <code>Gb_model</code>   (see <a href="../boundary_layer_conductance/#Bigleaf.compute_Gb!"><code>compute_Gb!</code></a>) and <code>Ram_model</code> (see <a href="../aerodynamic_conductance/#Bigleaf.compute_Ram"><code>compute_Ram</code></a>).</p><p>If only columns <code>ustar</code> and <code>wind</code> are available, use default models  (<code>Val(:Thom_1972)</code> and <code>Val(:wind_zr)</code>).</p><p><strong>Details</strong></p><p>Aerodynamic conductance for heat (Ga_h) is calculated as:</p><p><span>$Ga_h = 1 / (Ra_m + Rb_h)$</span></p><p>where <span>$Ra_m$</span> is the aerodynamic resistance for momentum and <span>$Rb_h = 1/Gb_h$</span> the  (quasi-laminar) canopy boundary layer resistance (&#39;excess resistance&#39;) for heat.</p><p><code>Ra_m</code> is computed and described with <a href="../aerodynamic_conductance/#Bigleaf.compute_Ram"><code>compute_Ram</code></a> using model <code>Ram_model</code>.</p><p><code>Rb_h</code> is computed and described with 1/<a href="../boundary_layer_conductance/#Bigleaf.compute_Gb!"><code>compute_Gb!</code></a> using a given <code>Gb_model</code>.</p><p><strong>Value</strong></p><p>combined results of <a href="../boundary_layer_conductance/#Bigleaf.compute_Gb!"><code>compute_Gb!</code></a> and </p><ul><li><code>Ra_m</code>: Aerodynamic resistance for momentum transfer (s m-1)</li><li><code>Ga_m</code>: Aerodynamic conductance for momentum transfer (m s-1)</li><li><code>Ga_h</code>: Aerodynamic conductance for heat transfer (m s-1)</li><li><code>Ra_h</code>: Aerodynamic resistance for heat transfer (s m-1)</li><li><code>Ga_CO2</code>: Aerodynamic conductance for CO2 transfer (m s-1)</li></ul><p><strong>Note</strong></p><p>The roughness length for water and heat (z0h) can be computed by <a href="../aerodynamic_conductance/#Bigleaf.roughness_z0h"><code>roughness_z0h</code></a>.</p><p>TODO check Input variables such as LAI, Dl, or zh can be either constants, or vary with time, i.e. are vectors of the same length as <code>df</code>.</p><p>Note that boundary layer conductance to water vapor transfer (<code>Gb_w</code>) is often  assumed to equal <code>Gb_h</code>. This assumption is also made in <code>Bigleaf.jl</code>, for  example in the function <a href="../surface_conductance/#Bigleaf.surface_conductance"><code>surface_conductance</code></a>.</p><p>If the roughness length for momentum (<code>z0m</code>) is not provided as input, it is estimated  using <a href="../surface_roughness/#Bigleaf.roughness_parameters"><code>roughness_parameters</code></a>, which estimates a single <code>z0m</code>  value for the entire time period. If a varying <code>z0m</code> value  (e.g. across seasons or years) is required, <code>z0m</code> should be provided as input argument.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">using DataFrames
df = DataFrame(Tair=25,pressure=100,wind=[3,4,5],
  ustar=[0.5,0.6,0.65],H=[200,230,250])   
# simple calculation of Ga  
aerodynamic_conductance!(df;Gb_model=Val(:Thom_1972)) 
# calculation of Ram using a model derived from the logarithmic wind profile
aerodynamic_conductance!(df;Gb_model=Val(:Thom_1972),Ram_model = Val(:wind_profile), 
  zr=40,zh=25,d=17.5,z0m=2) 
# simple calculation of Ga, but a physically based canopy boundary layer model
aerodynamic_conductance!(df,Gb_model=Val(:Su_2001),
  zr=40,zh=25,d=17.5,Dl=0.05,N=2,fc=0.8)
all(isfinite.(df.psi_h))</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/aerodynamic_conductance.jl#L1-L81">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.air_density-Tuple{Any, Any}" href="#Bigleaf.air_density-Tuple{Any, Any}"><code>Bigleaf.air_density</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">air_density(Tair,pressure; ...)</code></pre><p>Air density of moist air from air temperature and pressure_</p><p><strong>Arguments</strong></p><ul><li>Tair:      Air temperature (deg C)</li><li>pressure:  Atmospheric pressure (kPa)</li></ul><p>optional </p><ul><li><code>constants=</code><a href="../bigleaf_constants/#Bigleaf.bigleaf_constants"><code>bigleaf_constants</code></a><code>()</code>: Dictionary with entries   Kelvin, kPa2Pa</li></ul><p><strong>Details</strong></p><p>Air density <span>$\rho$</span> is calculated as:</p><p><span>$\rho = {pressure \over Rd * Tair}$</span></p><p><strong>Value</strong></p><p>air density (kg m-3)</p><p><strong>Examples</strong></p><pre><code class="language- hljs"># air density at 25degC and standard pressure (101.325kPa)
air_density(25,101.325)</code></pre><p><strong>References</strong></p><p>Foken, T, 2008: Micrometeorology. Springer, Berlin, Germany.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/meteorological_variables.jl#L1-L29">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.bigleaf_constants-Tuple{}" href="#Bigleaf.bigleaf_constants-Tuple{}"><code>Bigleaf.bigleaf_constants</code></a> — <span class="docstring-category">Method</span></header><section><div><p>bigleaf_constants(;...)</p><p>Constants Used in the Bigleaf.jl Package</p><p>Return a Dictionary Dict{Symbol, Real}. Default values can be overridden by the named arguments:</p><ul><li>cp           Specific heat of air for constant pressure (J K-1 kg-1)</li><li>Rgas         Universal gas constant (J mol-1 K-1)</li><li>Rv           Gas constant of water vapor (J kg-1 K-1) (Stull 1988 p.641)</li><li>Rd           Gas constant of dry air (J kg-1 K-1) (Foken p. 245)</li><li>Md           Molar mass of dry air (kg mol-1)</li><li>Mw           Molar mass of water vapor (kg mol-1)</li><li>eps          Ratio of the molecular weight of water vapor to dry air (=Mw/Md)</li><li>g            Gravitational acceleration (m s-2)</li><li>solar_constant Solar constant (W m-2)</li><li>pressure0    Reference atmospheric pressure at sea level (Pa)</li><li>Tair0        Reference air temperature (K)</li><li>k            von Karman constant</li><li>Cmol         Molar mass of carbon (kg mol-1)</li><li>Omol         Molar mass of oxygen (kg mol-1)</li><li>H2Omol       Molar mass of water (kg mol-1)</li><li>sigma        Stefan-Boltzmann constant (W m-2 K-4)</li><li>Pr           Prandtl number</li><li>Sc_CO2       Schmidt number for CO2</li><li>Kelvin       Conversion degree Celsius to Kelvin</li><li>DwDc         Ratio of the molecular diffusivities for water vapor and CO2</li><li>days2seconds Seconds per day</li><li>kPa2Pa       Conversion kilopascal (kPa) to pascal (Pa)</li><li>Pa2kPa       Conversion pascal (Pa) to kilopascal (kPa)</li><li>umol2mol     Conversion micromole (umol) to mole (mol)</li><li>mol2umol     Conversion mole (mol) to micromole (umol)</li><li>kg2g         Conversion kilogram (kg) to gram (g)</li><li>g2kg         Conversion gram (g) to kilogram (kg)</li><li>kJ2J         Conversion kilojoule (kJ) to joule (J)</li><li>J2kJ         Conversion joule (J) to kilojoule (kJ)</li><li>se_median    Conversion standard error (SE) of the mean to SE of the median</li><li>frac2percent Conversion between fraction and percent</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/bigleaf_constants.jl#L1-L40">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.calc_sun_position_MOD-Tuple{Number}" href="#Bigleaf.calc_sun_position_MOD-Tuple{Number}"><code>Bigleaf.calc_sun_position_MOD</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">calc_sun_position_MOD(JD::Number)</code></pre><p>Compute the Sun position at the Julian Day <code>JD</code>.</p><p>Results are represented in the Mean Equinox of Date (MOD), i.e. accounting for precession but not for nutation and smaller pertubation of the polar axes, in spherical ecliptic and equatorial coordinates.  The algorithm was adapted from [Vallado 2013, p. 277-279].</p><p><strong>Arguments:</strong></p><ul><li><code>JD</code>: time given as Julian Day . </li></ul><p><strong>Value</strong></p><p><code>NamedTuple</code>: sun position where</p><ul><li>Ecliptic coordinates (1:3)<ul><li>λ: Ecliptic longitude of the Sun [rad].</li><li>β: Ecliptic latitude of the Sun [rad] is assumed 0.</li><li>r: Distance of the Sun from Earth [m].</li></ul></li><li>Equatorial coordinate (4:5)  <ul><li>α: ascention [rad]</li><li>δ: declination [rad]</li></ul></li><li>ϵ: Obliquity of the ecliptic [rad].</li></ul><p><strong>References</strong></p><ul><li>Vallado, D. A (2013). Fundamentals of Astrodynamics and Applications.      Microcosm Press, Hawthorne, CA.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/sun_position.jl#L58-L85">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.calc_sun_position_hor-Tuple{Dates.DateTime, Any, Any}" href="#Bigleaf.calc_sun_position_hor-Tuple{Dates.DateTime, Any, Any}"><code>Bigleaf.calc_sun_position_hor</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">calc_sun_position_hor(datetime, lat, long)</code></pre><p>Compute the Sun position at given time and observer coordinates in horizontal coordinates.</p><p><strong>Arguments:</strong></p><ul><li><code>datetime</code>: time: Either a <code>ZonedDateTime</code>, or <code>DateTime</code> assumed in UTC</li><li><code>lat</code>, <code>long</code>: latitude and longitude in degree</li></ul><p><strong>Value</strong></p><p><code>NamedTuple</code>: sun position with entries</p><ul><li><code>altitude</code>: angle above the horizon [rad].</li><li><code>azimuth</code>: angle ange the horizon plane eastwards of north [rad]</li><li><code>hourangle</code>: [rad] as output by AstroLib.eq2hor  Seems to represent time [day/2pi] after solar noon.   Value at local timezone noon provdes (local time - solar time).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/sun_position.jl#L1-L17">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.calc_sun_position_hor-Tuple{TimeZones.ZonedDateTime, Any, Any}" href="#Bigleaf.calc_sun_position_hor-Tuple{TimeZones.ZonedDateTime, Any, Any}"><code>Bigleaf.calc_sun_position_hor</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">calc_sun_position_hor(datetime, lat, long)</code></pre><p>Compute the Sun position at given time and observer coordinates in horizontal coordinates.</p><p><strong>Arguments:</strong></p><ul><li><code>datetime</code>: time: Either a <code>ZonedDateTime</code>, or <code>DateTime</code> assumed in UTC</li><li><code>lat</code>, <code>long</code>: latitude and longitude in degree</li></ul><p><strong>Value</strong></p><p><code>NamedTuple</code>: sun position with entries</p><ul><li><code>altitude</code>: angle above the horizon [rad].</li><li><code>azimuth</code>: angle ange the horizon plane eastwards of north [rad]</li><li><code>hourangle</code>: [rad] as output by AstroLib.eq2hor  Seems to represent time [day/2pi] after solar noon.   Value at local timezone noon provdes (local time - solar time).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/sun_position.jl#L1-L17">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.compute_Gb!-Tuple{AbstractDataFrame, Val{:Thom_1972}}" href="#Bigleaf.compute_Gb!-Tuple{AbstractDataFrame, Val{:Thom_1972}}"><code>Bigleaf.compute_Gb!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">compute_Gb!(df::AbstractDataFrame, approach; kwargs...)</code></pre><p>Estimate boundary layer conductance.</p><p><strong>Arguments</strong></p><ul><li><code>df</code>       : DataFrame with required variables (depend on approach)</li><li><code>approach</code> : one of<ul><li><code>Val(:Thom_1972)</code>: see <a href="../boundary_layer_conductance/#Bigleaf.Gb_Thom"><code>Gb_Thom</code></a></li><li><code>Val(:Choudhury_1988)</code>: see <a href="../boundary_layer_conductance/#Bigleaf.Gb_Choudhury"><code>Gb_Choudhury</code></a></li><li><code>Val(:Su_2001)</code>: see <a href="../boundary_layer_conductance/#Bigleaf.Gb_Su"><code>Gb_Su</code></a></li><li><code>Val(:constant_kB1)</code>: see <a href="#Bigleaf.Gb_constant_kB1-Tuple{Any, Any}"><code>Gb_constant_kB1</code></a></li></ul></li></ul><p>The different approaches require different variables to be present in <code>df</code> and different keyword arguments.</p><p><strong>Value</strong></p><p>updated DataFrame <code>df</code> with the following columns:</p><ul><li><code>Gb_h</code>: Boundary layer conductance for heat transfer (m s-1)</li></ul><p>To subsequently derived quantities see</p><ul><li><a href="#Bigleaf.compute_Gb_quantities-Tuple{Any, Any}"><code>compute_Gb_quantities</code></a> for Resistance, kB-1 constant, and CO2 conductance</li><li><a href="../boundary_layer_conductance/#Bigleaf.add_Gb!"><code>add_Gb!</code></a> for conductances of other species given their Schmidt numbers.</li></ul><p><strong>See also</strong></p><p><a href="../boundary_layer_conductance/#Bigleaf.Gb_Thom"><code>Gb_Thom</code></a>, <a href="../boundary_layer_conductance/#Bigleaf.Gb_Choudhury"><code>Gb_Choudhury</code></a>, <a href="../boundary_layer_conductance/#Bigleaf.Gb_Su"><code>Gb_Su</code></a>, <a href="#Bigleaf.Gb_constant_kB1-Tuple{Any, Any}"><code>Gb_constant_kB1</code></a>,  <a href="../aerodynamic_conductance/#Bigleaf.aerodynamic_conductance!"><code>aerodynamic_conductance!</code></a></p><pre><code class="language-julia hljs">using DataFrames
df = DataFrame(wind=[3,4,5], ustar=[0.5,0.6,0.65]) 
compute_Gb!(df, Val(:Thom_1972))
≈(df.Gb_h[1], 0.102, rtol=1e-2)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/boundary_layer_conductance.jl#L1-L37">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.compute_Gb_quantities-Tuple{Any, Any}" href="#Bigleaf.compute_Gb_quantities-Tuple{Any, Any}"><code>Bigleaf.compute_Gb_quantities</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">compute_Gb_quantities(Gb_h)
compute_Gb_quantities!(df:::AbstractDataFrame)</code></pre><p>Based on boundary layer conductance for heat, compute derived quantities.</p><p><strong>Arguments</strong></p><ul><li><code>Gb_h</code> : Boundary layer conductance for heat transfer (m s-1)</li><li><code>df</code>   : DataFrame with above columns</li><li><code>constants=</code><a href="../bigleaf_constants/#Bigleaf.bigleaf_constants"><code>bigleaf_constants</code></a><code>()</code>: entries <code>Sc_CO2</code> and <code>Pr</code></li></ul><p><strong>Value</strong></p><p>NamedTuple with entries</p><ul><li><code>Gb_h</code>: Boundary layer conductance for heat transfer (m s-1)</li><li><code>Rb_h</code>: Boundary layer resistance for heat transfer (s m-1)</li><li><code>kB_h</code>: kB-1 parameter for heat transfer</li><li><code>Gb_CO2</code>: Boundary layer conductance for CO2 (m s-1). </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/boundary_layer_conductance.jl#L54-L71">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.compute_Ram-Tuple{Val{:wind_profile}, Union{Missing, Number}}" href="#Bigleaf.compute_Ram-Tuple{Val{:wind_profile}, Union{Missing, Number}}"><code>Bigleaf.compute_Ram</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">compute_Ram(::Val{:wind_profile}, ustar; 
  zr, d, z0m, psi_h, constants=bigleaf_constants())
compute_Ram!(df, method::Val{:wind_profile};  
  zr, d, z0m, psi_h = df.psi_h, kwargs...)

compute_Ram(::Val{:wind_zr}, ustar, wind)
compute_Ram!(df, method::Val{:wind_zr}; kwargs...)</code></pre><p>Estimate bulk aerodynamic conductance.</p><p><strong>Arguments</strong></p><ul><li><code>ustar</code>          : Friction velocity (m s-1)</li><li><code>df</code>             : DataFrame with above columns</li><li><code>zr</code>             : Instrument (reference) height (m)</li><li><code>d</code>              : Zero-plane displacement height (-), can be estimated using                      <a href="../surface_roughness/#Bigleaf.roughness_parameters"><code>roughness_parameters</code></a></li><li><code>z0m</code>            : Roughness length for momentum (m). Can be estimated using                     from <a href="../surface_roughness/#Bigleaf.roughness_parameters"><code>roughness_parameters</code></a>  </li><li><code>psi_h</code>          : the value of the stability function for heat and water vapor (-)                    see <a href="../stability_correction/#Bigleaf.stability_correction"><code>stability_correction</code></a></li></ul><p><strong>Details</strong></p><p>The aerodynamic resistance for momentum <span>$R_{a_m}$</span> is given by (<code>Ram_method = Val(:wind_zr)</code>):</p><p><span>$R_{a_m} = u/{u^*}^2$</span></p><p>Where u is the horizontal wind velocity.  Note that this formulation accounts for changes in atmospheric stability, and does not  require an additional stability correction function. </p><p>An alternative method to calculate <span>$Ra_m$</span> is provided (<code>Ram_method = Val(:wind_profile)</code>):</p><p><span>$R_{a_m} = (ln((z_r - d)/z_{0m}) - \psi_h) / (k \, u^*)$</span></p><p>If the roughness parameters <code>z0m</code> and <code>d</code> are unknown, they can be estimated using <a href="../surface_roughness/#Bigleaf.roughness_parameters"><code>roughness_parameters</code></a>. The argument <code>stab_formulation</code> determines the stability  correction function used to account for the effect of atmospheric stability on <code>Ra_m</code>  (<code>Ra_m</code> is lower for unstable and higher for stable stratification). Stratification is based  on a stability parameter <code>zeta</code> <span>$\zeta=(z-d/L)$</span>, where <code>z</code> is the height,  <code>d</code> the zero-plane displacement height, and <code>L</code> the Monin-Obukhov length, calculated with  <a href="../stability_correction/#Bigleaf.Monin_Obukhov_length"><code>Monin_Obukhov_length</code></a> The stability correction function is chosen by the argument <code>stab_formulation</code>.  Options are <code>Val(:Dyer_1970)</code> and <code>Val(:Businger_1971)</code> and <code>Val(:no_stability_correction)</code>.</p><p><strong>Note</strong></p><p>For adding aerodynamic conductance for other species see <a href="../aerodynamic_conductance/#Bigleaf.add_Ga!"><code>add_Ga!</code></a>.</p><p><strong>Value</strong></p><p>Aerodynamic resistance for momentum transfer (s m-1) (<span>$Ra_m$</span>)</p><p><strong>References</strong></p><ul><li>Verma, S., 1989: Aerodynamic resistances to transfers of heat, mass and momentum. In: Estimation of areal evapotranspiration, IAHS Pub, 177, 13-20.</li><li>Verhoef, A., De Bruin, H., Van Den Hurk, B., 1997: Some practical notes on the parameter kB-1 for sparse vegetation. Journal of Applied Meteorology, 36, 560-572.</li><li>Hicks, B<em>B., Baldocchi, D</em>D., Meyers, T<em>P., Hosker, J</em>R., Matt, D_R., 1987: A preliminary multiple resistance routine for deriving dry deposition velocities from measured quantities. Water, Air, and Soil Pollution 36, 311-330.</li><li>Monteith, J<em>L., Unsworth, M</em>H., 2008: Principles of environmental physics. Third Edition. Elsevier Academic Press, Burlington, USA. </li></ul><p><strong>See also</strong></p><p><a href="../aerodynamic_conductance/#Bigleaf.aerodynamic_conductance!"><code>aerodynamic_conductance!</code></a>, <a href="../aerodynamic_conductance/#Bigleaf.add_Ga!"><code>add_Ga!</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/aerodynamic_conductance.jl#L156-L221">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.decoupling-Tuple{}" href="#Bigleaf.decoupling-Tuple{}"><code>Bigleaf.decoupling</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">TODO; implement decoupling.</code></pre><p>This stub is there to satisfy links im Help-pages.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/evapotranspiration.jl#L320-L324">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.dew_point-Tuple{Any, Any}" href="#Bigleaf.dew_point-Tuple{Any, Any}"><code>Bigleaf.dew_point</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">dew_point(Tair,VPD; ...)
dew_point_from_e(ea; ...)</code></pre><p>Calculate the dew point, the temperature to which air must be               cooled to become saturated (i<em>e</em> e = Esat(Td))</p><p><strong>Arguments</strong></p><ul><li>Tair:     Air temperature (degC)</li><li>VPD:      Vapor pressure deficit (kPa)</li><li>ea:       actual water vapor pressure (kPa)</li></ul><p>optional</p><ul><li>accuracy = 1e-03: Accuracy of the result (deg C)</li><li><code>Esat_formula</code>: formula used in <a href="../metorological_variables/#Bigleaf.Esat_from_Tair"><code>Esat_from_Tair</code></a></li><li><code>constants=</code><a href="../bigleaf_constants/#Bigleaf.bigleaf_constants"><code>bigleaf_constants</code></a><code>()</code>: Dictionary with entries    Pa2kPa </li></ul><p><strong>Details</strong></p><p>Dew point temperature (Td) is defined by the temperature for which saturaed vapour pressure equals current vapour pressure, i.e. below which  water would start to condensate.</p><p><span>$e = Esat(Td)$</span></p><p>where e is vapor pressure of the air and Esat is the vapor pressure deficit.          This equation is solved for Td by optimization.</p><p><strong>Value</strong></p><p>dew point temperature (degC)</p><p><strong>References</strong></p><p>Monteith J.L., Unsworth M.H., 2008: Principles of Environmental Physics.             3rd edition. Academic Press, London.</p><p><strong>Examples</strong></p><pre><code class="language- hljs">Tair = 20.0
VPD = 1.5
Td = dew_point(Tair, VPD; accuracy = 1e-2)                
(e = VPD_to_e(VPD,Tair), esat_Td = Esat_from_Tair(Td))</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/meteorological_variables.jl#L212-L254">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.dew_point_from_e-Tuple{Any}" href="#Bigleaf.dew_point_from_e-Tuple{Any}"><code>Bigleaf.dew_point_from_e</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">dew_point(Tair,VPD; ...)
dew_point_from_e(ea; ...)</code></pre><p>Calculate the dew point, the temperature to which air must be               cooled to become saturated (i<em>e</em> e = Esat(Td))</p><p><strong>Arguments</strong></p><ul><li>Tair:     Air temperature (degC)</li><li>VPD:      Vapor pressure deficit (kPa)</li><li>ea:       actual water vapor pressure (kPa)</li></ul><p>optional</p><ul><li>accuracy = 1e-03: Accuracy of the result (deg C)</li><li><code>Esat_formula</code>: formula used in <a href="../metorological_variables/#Bigleaf.Esat_from_Tair"><code>Esat_from_Tair</code></a></li><li><code>constants=</code><a href="../bigleaf_constants/#Bigleaf.bigleaf_constants"><code>bigleaf_constants</code></a><code>()</code>: Dictionary with entries    Pa2kPa </li></ul><p><strong>Details</strong></p><p>Dew point temperature (Td) is defined by the temperature for which saturaed vapour pressure equals current vapour pressure, i.e. below which  water would start to condensate.</p><p><span>$e = Esat(Td)$</span></p><p>where e is vapor pressure of the air and Esat is the vapor pressure deficit.          This equation is solved for Td by optimization.</p><p><strong>Value</strong></p><p>dew point temperature (degC)</p><p><strong>References</strong></p><p>Monteith J.L., Unsworth M.H., 2008: Principles of Environmental Physics.             3rd edition. Academic Press, London.</p><p><strong>Examples</strong></p><pre><code class="language- hljs">Tair = 20.0
VPD = 1.5
Td = dew_point(Tair, VPD; accuracy = 1e-2)                
(e = VPD_to_e(VPD,Tair), esat_Td = Esat_from_Tair(Td))</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/meteorological_variables.jl#L212-L254">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.e_to_VPD-Tuple{Any, Any}" href="#Bigleaf.e_to_VPD-Tuple{Any, Any}"><code>Bigleaf.e_to_VPD</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">VPD_to_rH(VPD,Tair; ...)
H_to_VPD(rH,Tair; ...)
e_to_rH(e,Tair; ...)
VPD_to_e(VPD,Tair; ...)
e_to_VPD(e,Tair; ...)
e_to_q(e,pressure; ...)
q_to_e(q,pressure; ...)
q_to_VPD(q,Tair,pressure; ...)
VPD_to_q(VPD,Tair,pressure; ...)</code></pre><p>Conversion between vapor pressure (e), vapor pressure deficit (VPD),              specific humidity (q), and relative humidity (rH).</p><p><strong>Arguments</strong></p><ul><li>Tair:      Air temperature (deg C)</li><li>pressure:  Atmospheric pressure (kPa)</li><li>e:         Vapor pressure (kPa)</li><li>q:        Specific humidity (kg kg-1)</li><li>VPD:       Vapor pressure deficit (kPa)</li><li>rH:        Relative humidity (-)</li></ul><p>All functions accept the optional arguemtns:</p><ul><li><code>Esat_formula</code>: formula used in <a href="../metorological_variables/#Bigleaf.Esat_from_Tair"><code>Esat_from_Tair</code></a></li><li><code>constants</code>: dictionary from <a href="../bigleaf_constants/#Bigleaf.bigleaf_constants"><code>bigleaf_constants</code></a> with entries eps and Pa2kPa</li></ul><p><strong>Rreferences</strong></p><p>Foken, T, 2008: Micrometeorology_ Springer, Berlin, Germany.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/unit_conversions.jl#L153-L182">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.e_to_q-Tuple{Any, Any}" href="#Bigleaf.e_to_q-Tuple{Any, Any}"><code>Bigleaf.e_to_q</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">VPD_to_rH(VPD,Tair; ...)
H_to_VPD(rH,Tair; ...)
e_to_rH(e,Tair; ...)
VPD_to_e(VPD,Tair; ...)
e_to_VPD(e,Tair; ...)
e_to_q(e,pressure; ...)
q_to_e(q,pressure; ...)
q_to_VPD(q,Tair,pressure; ...)
VPD_to_q(VPD,Tair,pressure; ...)</code></pre><p>Conversion between vapor pressure (e), vapor pressure deficit (VPD),              specific humidity (q), and relative humidity (rH).</p><p><strong>Arguments</strong></p><ul><li>Tair:      Air temperature (deg C)</li><li>pressure:  Atmospheric pressure (kPa)</li><li>e:         Vapor pressure (kPa)</li><li>q:        Specific humidity (kg kg-1)</li><li>VPD:       Vapor pressure deficit (kPa)</li><li>rH:        Relative humidity (-)</li></ul><p>All functions accept the optional arguemtns:</p><ul><li><code>Esat_formula</code>: formula used in <a href="../metorological_variables/#Bigleaf.Esat_from_Tair"><code>Esat_from_Tair</code></a></li><li><code>constants</code>: dictionary from <a href="../bigleaf_constants/#Bigleaf.bigleaf_constants"><code>bigleaf_constants</code></a> with entries eps and Pa2kPa</li></ul><p><strong>Rreferences</strong></p><p>Foken, T, 2008: Micrometeorology_ Springer, Berlin, Germany.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/unit_conversions.jl#L153-L182">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.e_to_rH-Tuple{Any, Any}" href="#Bigleaf.e_to_rH-Tuple{Any, Any}"><code>Bigleaf.e_to_rH</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">VPD_to_rH(VPD,Tair; ...)
H_to_VPD(rH,Tair; ...)
e_to_rH(e,Tair; ...)
VPD_to_e(VPD,Tair; ...)
e_to_VPD(e,Tair; ...)
e_to_q(e,pressure; ...)
q_to_e(q,pressure; ...)
q_to_VPD(q,Tair,pressure; ...)
VPD_to_q(VPD,Tair,pressure; ...)</code></pre><p>Conversion between vapor pressure (e), vapor pressure deficit (VPD),              specific humidity (q), and relative humidity (rH).</p><p><strong>Arguments</strong></p><ul><li>Tair:      Air temperature (deg C)</li><li>pressure:  Atmospheric pressure (kPa)</li><li>e:         Vapor pressure (kPa)</li><li>q:        Specific humidity (kg kg-1)</li><li>VPD:       Vapor pressure deficit (kPa)</li><li>rH:        Relative humidity (-)</li></ul><p>All functions accept the optional arguemtns:</p><ul><li><code>Esat_formula</code>: formula used in <a href="../metorological_variables/#Bigleaf.Esat_from_Tair"><code>Esat_from_Tair</code></a></li><li><code>constants</code>: dictionary from <a href="../bigleaf_constants/#Bigleaf.bigleaf_constants"><code>bigleaf_constants</code></a> with entries eps and Pa2kPa</li></ul><p><strong>Rreferences</strong></p><p>Foken, T, 2008: Micrometeorology_ Springer, Berlin, Germany.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/unit_conversions.jl#L153-L182">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.equilibrium_imposed_ET-NTuple{5, Any}" href="#Bigleaf.equilibrium_imposed_ET-NTuple{5, Any}"><code>Bigleaf.equilibrium_imposed_ET</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">equilibrium_imposed_ET(Tair,pressure,VPD,Gs, Rn; ...)
equilibrium_imposed_ET!(df; ...)</code></pre><p>Evapotranspiration (ET) split up into imposed ET and equilibrium ET.</p><p><strong>Argumens</strong></p><ul><li><code>Tair</code>      : Air temperature (deg C)</li><li><code>pressure</code>  : Atmospheric pressure (kPa)</li><li><code>VPD</code>       : Air vapor pressure deficit (kPa)</li><li><code>Gs</code>        : surface conductance to water vapor (m s-1)</li><li><code>Rn</code>        : Net radiation (W m-2)</li></ul><p>optional : </p><ul><li><code>G=0</code>       : Ground heat flux (W m-2)</li><li><code>S=0</code>       : Sum of all storage fluxes (W m-2)</li><li><code>Esat_formula=Val(:Sonntag_1990)</code>: formula used in <a href="../metorological_variables/#Bigleaf.Esat_from_Tair"><code>Esat_from_Tair</code></a></li><li><code>constants=</code><a href="../bigleaf_constants/#Bigleaf.bigleaf_constants"><code>bigleaf_constants</code></a><code>()</code>: pysical constants (cp, eps)</li></ul><p><strong>Details</strong></p><p>Total evapotranspiration can be written in the form (Jarvis &amp; McNaughton 6):</p><p><span>$ET = \Omega \mathit{ET}_{eq} + (1 - \Omega) \mathit{ET}_{imp}$</span></p><p>where <span>$\Omega$</span> is the decoupling coefficient as calculated from <a href="../surface_conductance/#Bigleaf.decoupling"><code>decoupling</code></a>. <code>ET_eq</code> is the equilibrium evapotranspiration i.e., the ET rate that would occur under uncoupled conditions, where the budget is dominated by radiation (when Ga -&gt; 0):</p><p><span>$ET_{eq} = (\Delta \, (R_n - G - S) \, \lambda) / ( \Delta \gamma)$</span></p><p>where <span>$\Delta$</span> is the slope of the saturation vapor pressur(kPa K-1), <span>$\lambda$</span> is the latent heat of vaporization (J kg-1), and <span>$\gamma$</span> is the psychrometric constant (kPa K-1). <code>ET_imp</code> is the imposed evapotranspiration rate, the ET rate that would occur under fully coupled conditions (when Ga -&gt; inf):</p><p><span>$ET_{imp} = (\rho \, c_p \, \mathit{VPD} ~ G_s \, \lambda) / \gamma$</span></p><p>where <span>$\rho$</span> is the air density (kg m-3).</p><p><strong>Value</strong></p><p>A <code>NamedTuple</code> or <code>DataFrame</code> with the following columns:</p><ul><li><code>ET_eq</code>: Equilibrium ET (kg m-2 s-1)</li><li><code>ET_imp</code>: Imposed ET (kg m-2 s-1)</li><li><code>LE_eq</code>: Equilibrium LE (W m-2)</li><li><code>LE_imp</code>: Imposed LE (W m-2)      </li></ul><p><strong>References</strong></p><ul><li>Jarvis, P<em>G., McNaughton, K</em>G., 1986: Stomatal control of transpiration: scaling up from leaf to region. Advances in Ecological Rese1-49.</li><li>Monteith, J<em>L., Unsworth, M</em>H., 2008: Principles of ironmPhysics. 3rd edition. Academic Press, London. </li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">Tair,pressure,Rn, VPD, Gs = 20.0,100.0,50.0, 0.5, 0.01
ET_eq, ET_imp, LE_eq, LE_imp = equilibrium_imposed_ET(Tair,pressure,VPD,Gs, Rn)    
≈(ET_eq, 1.399424e-05; rtol = 1e-5)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/evapotranspiration.jl#L234-L295">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.extraterrestrial_radiation-Tuple{Dates.TimeType}" href="#Bigleaf.extraterrestrial_radiation-Tuple{Dates.TimeType}"><code>Bigleaf.extraterrestrial_radiation</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">extraterrestrial_radiation(doy::Number; ...)
extraterrestrial_radiation(datetime::TimeType; ...)</code></pre><p>Compute the extraterrestrial solar radiation with the eccentricity correction. Computation follows Lanini, 2010 (Master thesis, Bern University).</p><p><strong>Arguments</strong></p><ul><li>doy: integer vector with day of year (DoY)</li></ul><p>optional </p><ul><li><code>constants=</code><a href="../bigleaf_constants/#Bigleaf.bigleaf_constants"><code>bigleaf_constants</code></a><code>()</code>: Dictionary with entries <ul><li>solar_constant</li></ul></li><li><code>year</code>=2030: year to create timestamps. Due to precession results slightly change across decades.   </li></ul><p><strong>Value</strong></p><p>numeric vector of extraterrestrial radiation (W_m-2)</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">ex_rad = extraterrestrial_radiation(1)
≈(ex_rad, 1414, atol = 1)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/potential_radiation.jl#L1-L27">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.extraterrestrial_radiation-Tuple{Number}" href="#Bigleaf.extraterrestrial_radiation-Tuple{Number}"><code>Bigleaf.extraterrestrial_radiation</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">extraterrestrial_radiation(doy::Number; ...)
extraterrestrial_radiation(datetime::TimeType; ...)</code></pre><p>Compute the extraterrestrial solar radiation with the eccentricity correction. Computation follows Lanini, 2010 (Master thesis, Bern University).</p><p><strong>Arguments</strong></p><ul><li>doy: integer vector with day of year (DoY)</li></ul><p>optional </p><ul><li><code>constants=</code><a href="../bigleaf_constants/#Bigleaf.bigleaf_constants"><code>bigleaf_constants</code></a><code>()</code>: Dictionary with entries <ul><li>solar_constant</li></ul></li><li><code>year</code>=2030: year to create timestamps. Due to precession results slightly change across decades.   </li></ul><p><strong>Value</strong></p><p>numeric vector of extraterrestrial radiation (W_m-2)</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">ex_rad = extraterrestrial_radiation(1)
≈(ex_rad, 1414, atol = 1)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/potential_radiation.jl#L1-L27">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.frac_hour-Tuple{Type{var&quot;#s3&quot;} where var&quot;#s3&quot;&lt;:Dates.Period, Number}" href="#Bigleaf.frac_hour-Tuple{Type{var&quot;#s3&quot;} where var&quot;#s3&quot;&lt;:Dates.Period, Number}"><code>Bigleaf.frac_hour</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">frac_hour(float::Number)
frac_hour(period::Type{&lt;:Period}, float::Number)</code></pre><p>Create a period in given type (defaults to <code>Nanosecond</code>) from fractional hours.</p><pre><code class="language-julia hljs">using Dates
frac_hour(1+1/60) == Hour(1) + Minute(1)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/util.jl#L19-L32">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.gC_to_umolCO2-Tuple{Any}" href="#Bigleaf.gC_to_umolCO2-Tuple{Any}"><code>Bigleaf.gC_to_umolCO2</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">umolCO2_to_gC(CO2_flux; constants=bigleaf_constants())
gC_to_umolCO2(C_flux; constants=bigleaf_constants())</code></pre><p>Convert CO2 quantities from (umol CO2 m-2 s-1) to (g C m-2 d-1) and vice versa.</p><p><strong>Arguments</strong></p><ul><li>CO2_flux  CO2 flux (umol CO2 m-2 s-1)</li><li>C_flux    Carbon (C) flux (gC m-2 d-1)</li><li><code>constants</code>: dictionary from <a href="../bigleaf_constants/#Bigleaf.bigleaf_constants"><code>bigleaf_constants</code></a> with entries: Cmol, umol2mol, mol2umol, kg2g, g2kg, says2seconds</li></ul><p><strong>Examples</strong></p><pre><code class="language- hljs">umolCO2_to_gC(20)  # gC m-2 d-1</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/unit_conversions.jl#L279-L296">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.get_datetime_for_doy_hour" href="#Bigleaf.get_datetime_for_doy_hour"><code>Bigleaf.get_datetime_for_doy_hour</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_datetime_for_doy_hour(doy, hour=12; year = 2030)</code></pre><p>Create DateTime for given day<em>of</em>year and hour. Hour defaults to noon and year to 2030, a near future where earth axis  precession does not differ too much from year where the function  is called. Fractional hours can be provided.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">get_datetime_for_doy_hour(2; year = 2021)
# output
2021-01-02T12:00:00</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/potential_radiation.jl#L92-L106">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.get_growingseason-Tuple{Any, Any}" href="#Bigleaf.get_growingseason-Tuple{Any, Any}"><code>Bigleaf.get_growingseason</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_growingseason(GPPd, tGPP; ws=15, min_int=5, warngap=true)</code></pre><p>Filters annual time series for growing season based on smoothed daily GPP data.</p><p><strong>Arguments</strong></p><ul><li><code>GPPd</code>:    daily GPP (any unit) </li><li><code>tGPP</code>:    GPP threshold (fraction of 95th percentile of the GPP time series).              Takes values between 0 and 1. </li></ul><p>optional               </p><ul><li><code>ws</code>:      window size used for GPP time series smoothing</li><li><code>min_int</code>: minimum time interval in days for a given state of growing season</li><li><code>warngap</code>: set to false to suppress warning on too few non-missing data</li></ul><p><strong>Details</strong></p><p>The basic idea behind the growing season filter is that vegetation is  considered to be active when its carbon uptake (GPP) is above a specified  threshold, which is defined relative to the peak GPP (95th percentile)  observed in the year.  The GPP-threshold is calculated as:</p><p><span>$GPP_{threshold} = quantile(GPPd,0.95)*tGPP$</span></p><p>GPPd time series are smoothed with a moving average to avoid fluctuations  in the delineation of the growing season. The window size defaults to 15  days, but depending on the ecosystem, other values can be appropriate. </p><p>The argument <code>min_int</code> serves to avoid short fluctuations in the  status growing season vs. no growing season by defining a minimum length of the status. If a time interval shorter than <code>min_int</code> is labeled as growing season or non-growing season, it is changed to the status of  the neighboring values, i.e its opposite.</p><p><strong>Value</strong></p><p>A NamedTuple with entries</p><ul><li><code>is_growingseason</code>: a <code>BitVector</code> of the same length as the input GPPd in which <code>false</code>  indicate no growing season (dormant season) and <code>true</code> indicate growing season.</li><li><code>GPPd_smoothed</code>: smoothed GPPd</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/filter_data.jl#L193-L231">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.get_nonoverlapping_periods-Tuple{DataFrame}" href="#Bigleaf.get_nonoverlapping_periods-Tuple{DataFrame}"><code>Bigleaf.get_nonoverlapping_periods</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_nonoverlapping_periods(dfo::DataFrame)</code></pre><p>Get non-overlapping periods.</p><p><strong>Arguments</strong></p><ul><li><code>dfo</code>: DataFrame with columns <code>p_start</code> and <code>p_end</code> sorted by increasing <code>p_start</code></li></ul><p><strong>Value</strong></p><ul><li>DataFrame with columns <code>p_start</code> and <code>p_end</code> with <code>p_start[i] &gt; p_end[i-1]</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/util.jl#L70-L80">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.kg_to_mol" href="#Bigleaf.kg_to_mol"><code>Bigleaf.kg_to_mol</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">kg_to_mol(mass, molarMass=bigleaf_constants()[:H2Omol])</code></pre><p>Conversion between Mass (kg) and Molar Units (mol).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/unit_conversions.jl#L270-L274">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.kinematic_viscosity-Tuple{Any, Any}" href="#Bigleaf.kinematic_viscosity-Tuple{Any, Any}"><code>Bigleaf.kinematic_viscosity</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">kinematic_viscosity(Tair,pressure; ...)</code></pre><p>Calculate the kinematic viscosity of air.</p><p><strong>Parameters</strong></p><ul><li>Tair      Air temperature (deg C)</li><li>pressure  Atmospheric pressure (kPa)</li></ul><p>optional </p><ul><li><code>constants=</code><a href="../bigleaf_constants/#Bigleaf.bigleaf_constants"><code>bigleaf_constants</code></a><code>()</code>: Dictionary with entries    Kelvin, pressure0, Tair0, kPa2Pa</li></ul><p><strong>Details</strong></p><p>Eq where v is the kinematic viscosity of the air (m2 s-1),           given by (Massman 1999b):</p><p><span>$v = 1.327 * 10^-5(pressure0/pressure)(Tair/Tair0)^{1.81}$</span></p><p><strong>Value</strong></p><p>kinematic viscosity of air (m2 s-1)</p><p><strong>References</strong></p><p>Massman, W.J., 1999b: Molecular diffusivities of Hg vapor in air,              O2 and N2 near STP and the kinematic viscosity and thermal diffusivity             of air near STP. Atmospheric Environment 33, 453-457.      </p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">Tair,pressure = 25,100
vis = kinematic_viscosity(Tair,pressure)
≈(vis, 1.58e-5, atol =1e-7)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/meteorological_variables.jl#L323-L358">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.latent_heat_vaporization-Tuple{Any}" href="#Bigleaf.latent_heat_vaporization-Tuple{Any}"><code>Bigleaf.latent_heat_vaporization</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">latent_heat_vaporization(Tair)</code></pre><p>Latent heat of vaporization as a function of air temperature using </p><p><span>$\lambda = (2.501 - 0.00237 \, Tair) 10^6$</span>.</p><p><strong>Arguments:</strong></p><ul><li>Tair:  Air temperature (deg C)</li></ul><p><strong>Value</strong></p><p><span>$\lambda$</span>: Latent heat of vaporization (J kg-1) </p><p><strong>References</strong></p><ul><li>Stull, B<em>, 1988: An Introduction to Boundary Layer Meteorology (p</em>641)           Kluwer Academic Publishers, Dordrecht, Netherlands            </li><li>Foken, T, 2008: Micrometeorology_ Springer, Berlin, Germany</li></ul><pre><code class="language- hljs">latent_heat_vaporization.(5:5:45)        </code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/meteorological_variables.jl#L125-L148">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.mol_to_ms-Tuple{Any, Any, Any}" href="#Bigleaf.mol_to_ms-Tuple{Any, Any, Any}"><code>Bigleaf.mol_to_ms</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">ms_to_mol(G_ms,Tair,pressure; constants=bigleaf_constants())
mol_to_ms(G_mol,Tair,pressure; constants=bigleaf_constants())</code></pre><p>Converts conductances from mass (m s-1) to molar units (mol m-2 s-1), or vice versa</p><p><strong>Details</strong></p><p>The conversions are given by</p><ul><li><span>$G_{mol} = G_{ms}  \, pressure / (Rgas  Tair)$</span></li><li><span>$G_{ms} = G_{mol}  \, (Rgas  Tair) / pressure$</span></li></ul><p>where Tair is in Kelvin and pressure in Pa (converted from kPa internally).</p><p><strong>References</strong></p><p>Jones, H<em>G</em> 1992_ Plants and microclimate: a quantitative approach to    environmental plant physiology_   2nd Edition<em>, Cambridge University Press, Cambridge</em> 428 </p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">G_ms,Tair,pressure = 0.005,25,100
rmol = ms_to_mol(G_ms,Tair,pressure)
≈(rmol, 0.2017, atol =1e-4)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/unit_conversions.jl#L114-L140">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.moving_average-Tuple{Any, Any}" href="#Bigleaf.moving_average-Tuple{Any, Any}"><code>Bigleaf.moving_average</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">moving_average(vs,n; nmin = n ÷ 2)</code></pre><p>Compute the moving average over a vector allowing for missings.</p><p><strong>Arguments</strong></p><ul><li>vs: numeric vector to average over</li><li>n: window size: number of items to average</li><li>nmin: minimum number of non-missing records</li></ul><p>Values outside the edges are assumed missing.    </p><p>If the number of non-missing records within a window is smaller than nmin then the averaged value is assumed missing. This avoids average at edges of  periods with many missings to be very sensitive to the edge values.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/util.jl#L42-L57">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.ms_to_mol-Tuple{Any, Any, Any}" href="#Bigleaf.ms_to_mol-Tuple{Any, Any, Any}"><code>Bigleaf.ms_to_mol</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">ms_to_mol(G_ms,Tair,pressure; constants=bigleaf_constants())
mol_to_ms(G_mol,Tair,pressure; constants=bigleaf_constants())</code></pre><p>Converts conductances from mass (m s-1) to molar units (mol m-2 s-1), or vice versa</p><p><strong>Details</strong></p><p>The conversions are given by</p><ul><li><span>$G_{mol} = G_{ms}  \, pressure / (Rgas  Tair)$</span></li><li><span>$G_{ms} = G_{mol}  \, (Rgas  Tair) / pressure$</span></li></ul><p>where Tair is in Kelvin and pressure in Pa (converted from kPa internally).</p><p><strong>References</strong></p><p>Jones, H<em>G</em> 1992_ Plants and microclimate: a quantitative approach to    environmental plant physiology_   2nd Edition<em>, Cambridge University Press, Cambridge</em> 428 </p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">G_ms,Tair,pressure = 0.005,25,100
rmol = ms_to_mol(G_ms,Tair,pressure)
≈(rmol, 0.2017, atol =1e-4)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/unit_conversions.jl#L114-L140">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.potential_ET-Tuple{Val{:PriestleyTaylor}, Any, Any, Any}" href="#Bigleaf.potential_ET-Tuple{Val{:PriestleyTaylor}, Any, Any, Any}"><code>Bigleaf.potential_ET</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">potential_ET(::Val{:PriestleyTaylor}, Tair, pressure, Rn; G=0.0, S=0.0, ...)
potential_ET(::Val{:PriestleyTaylor}, Tair, pressure, Rn, G, S; ...)

potential_ET(::Val{:PenmanMonteith}, Tair, pressure, Rn, VPD, Ga_h;
  G=zero(Tair),S=zero(Tair), ...)
fpotential_ET(::Val{:PenmanMonteith}, Tair, pressure, Rn, VPD, Ga_h, G, S; ...)

potential_ET!(df, approach; ...)</code></pre><p>Potential evapotranspiration according to Priestley &amp; Taylor 1972 or the Penman-Monteith equation with a prescribed surface conductance.</p><p><strong>Arguments</strong></p><ul><li><code>Tair</code>:      Air temperature (degC)</li><li><code>pressure</code>:  Atmospheric pressure (kPa)</li><li><code>Rn</code>:        Net radiation (W m-2)</li><li><code>VPD</code>:       Vapor pressure deficit (kPa)</li><li><code>Ga</code>:        Aerodynamic conductance to heat/water vapor (m s-1)</li><li><code>df</code>:        DataFrame with the above variables</li><li><code>approach</code>:  Approach used: Either <code>Val(:PriestleyTaylor)</code>  or <code>Val(:PenmanMonteith)</code>.</li></ul><p>optional:</p><ul><li><code>G=0.0</code>:         Ground heat flux (W m-2). Defaults to zero.</li><li><code>S=0.0</code>:         Sum of all storage fluxes (W m-2) . Defaults to zero.</li><li><code>constants=</code><a href="../bigleaf_constants/#Bigleaf.bigleaf_constants"><code>bigleaf_constants</code></a><code>()</code>: physical constants (cp, eps, Rd, Rgas)</li></ul><p>for <code>PriestleyTaylor</code>:</p><ul><li><code>alpha = 1.26</code>:   Priestley-Taylor coefficient</li></ul><p>for PenmanMonteith:</p><ul><li><code>Gs_pot = 0.6</code>:    Potential/maximum surface conductance (mol m-2 s-1); </li><li><code>Esat_formula</code>: formula used in <a href="../metorological_variables/#Bigleaf.Esat_from_Tair"><code>Esat_from_Tair</code></a></li></ul><p><strong>Details</strong></p><p>Potential evapotranspiration is calculated according to Priestley &amp; Taylor, 1972 (<code>approach = Val(:PriestleyTaylor)</code>:</p><p><span>$\mathit{LE}_{pot} = (\alpha \, \Delta \, (Rn - G - S)) / (\Delta + \gamma)$</span></p><p><span>$\alpha$</span> is the Priestley-Taylor coefficient, <span>$\Delta$</span> is the slope  of the saturation vapor pressure curve (kPa K-1), and <span>$\gamma$</span> is the  psychrometric constant (kPa K-1).</p><p>If <code>approach = Val(:PenmanMonteith)</code>, potential evapotranspiration is calculated according to the Penman-Monteith equation:</p><p><span>$\mathit{LE}_{pot} = (\Delta \, (R_n - G - S) + \rho \, c_p \, \mathit{VPD} \; G_a) /  (\Delta + \gamma \, (1 + G_a/G_{s pot})$</span></p><p>where <span>$\Delta$</span> is the slope of the saturation vapor pressure curve (kPa K-1), <span>$\rho$</span> is the air density (kg m-3),  and <span>$\gamma$</span> is the psychrometric constant (kPa K-1). The value of <span>$G_{s pot}$</span> is typically a maximum value of <span>$G_s$</span> observed at the site,  e.g. the <span>$90^{th}$</span> percentile of <span>$G_s$</span> within the growing season.</p><p>Ground heat flux and storage heat flux <code>G</code> or <code>S</code> are provided as optional  arguments. In the input-explicit variants, they default to zero. In the data-frame arguments, they default to missing, which results in assuming them to be zero which is displayed in a log-message. Note that in difference ot the bigleaf R package, you explitly need to care for missing values (see examples).</p><p><strong>Value</strong></p><p>NamedTuple with the following entries:</p><ul><li><code>ET_pot</code>: Potential evapotranspiration (kg m-2 s-1)</li><li><code>LE_pot</code>: Potential latent heat flux (W m-2)</li></ul><p><strong>References</strong></p><ul><li>Priestley, C<em>H</em>B., Taylor, R_J., 1972: On the assessment of surface heat flux and evaporation using large-scale parameters. Monthly Weather Review 100, 81-92.  </li><li>Allen, R<em>G., Pereira L</em>S., Raes D., Smith M., 1998: Crop evapotranspiration - Guidelines for computing crop water requirements - FAO Irrigation and drainage paper 56.</li><li>Novick, K_A., et al. 2016: The increasing importance of atmospheric demand for ecosystem water and carbon fluxes. Nature Climate Change 6, 1023 - 1027.</li></ul><p><strong>See also</strong></p><p><a href="../surface_conductance/#Bigleaf.surface_conductance"><code>surface_conductance</code></a></p><p><strong>Examples</strong></p><p>Calculate potential ET of a surface that receives a net radiation of 500 Wm-2 using Priestley-Taylor:</p><pre><code class="language-julia hljs">Tair, pressure, Rn = 30.0,100.0,500.0
ET_pot, LE_pot = potential_ET(Val(:PriestleyTaylor), Tair, pressure, Rn)    
≈(ET_pot, 0.000204; rtol = 1e-2)</code></pre><p>Calculate potential ET for a surface with known Gs (0.5 mol m-2 s-1) and Ga (0.1 m s-1) using Penman-Monteith:</p><pre><code class="language-julia hljs">Tair, pressure, Rn = 30.0,100.0,500.0
VPD, Ga_h, Gs_pot = 2.0, 0.1, 0.5
ET_pot, LE_pot = potential_ET(
  Val(:PenmanMonteith), Tair,pressure,Rn,VPD, Ga_h; Gs_pot)    
# now cross-check with the inverted equation
Gs_ms, Gs_mol = surface_conductance(
  Val(:PenmanMonteith), Tair,pressure,VPD,LE_pot,Rn,Ga_h)
Gs_mol ≈ Gs_pot</code></pre><p>DataFrame variant with explicitly replacing missings using <code>coalesce.</code>:</p><pre><code class="language-julia hljs">using DataFrames
df = DataFrame(
  Tair = 20.0:1.0:30.0,pressure = 100.0, Rn = 500.0, G = 105.0, VPD = 2.0, 
  Ga_h = 0.1) 
allowmissing!(df, Cols(:G)); df.G[1] = missing
#
# need to provide G explicitly
df_ET = potential_ET!(copy(df), Val(:PriestleyTaylor); G = df.G)    
ismissing(df_ET.ET_pot[1])
#
# use coalesce to replace missing values by zero
df_ET = potential_ET!(
  copy(df), Val(:PriestleyTaylor); G = coalesce.(df.G, zero(df.G)))    
!ismissing(df_ET.ET_pot[1])</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/evapotranspiration.jl#L1-L124">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.potential_radiation-NTuple{4, Any}" href="#Bigleaf.potential_radiation-NTuple{4, Any}"><code>Bigleaf.potential_radiation</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">potential_radiation(datetime, lat, long)
potential_radiation(doy, hour, lat, long; timezone,year)</code></pre><p>Compute potential radiation for given geolocation and time.</p><p>Because potential radiation does not change across years  (for a given location and daytime and day of year), time can be specified alternatively by doy and hour.</p><p><strong>Arguments</strong></p><ul><li>datetime:  UTC timestamp.</li><li>lat:       Latitude (decimal degrees)</li><li>long:      Longitude (decimal degrees)</li><li>doy:       day of year (integer starting from 1)</li><li>hour:      hour within the day (0.0 .. 24.0 float)</li></ul><p>optional     </p><ul><li>timezone:  Timezone for doy and hour, defaults to &quot;GMT+x&quot;  nearest to given longitude.</li><li>year: specific year for doy and hour</li></ul><p><strong>Value</strong></p><p>vector of potential radiation (W m-2)</p><p><strong>Examples</strong></p><pre><code class="language- hljs"># assume hours in the GMT+x that is closest to given longitude
potrad = potential_radiation(160, 10.5, 51.0, 11.5)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/potential_radiation.jl#L42-L71">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.potential_radiation-Tuple{Dates.TimeType, Any, Any}" href="#Bigleaf.potential_radiation-Tuple{Dates.TimeType, Any, Any}"><code>Bigleaf.potential_radiation</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">potential_radiation(datetime, lat, long)
potential_radiation(doy, hour, lat, long; timezone,year)</code></pre><p>Compute potential radiation for given geolocation and time.</p><p>Because potential radiation does not change across years  (for a given location and daytime and day of year), time can be specified alternatively by doy and hour.</p><p><strong>Arguments</strong></p><ul><li>datetime:  UTC timestamp.</li><li>lat:       Latitude (decimal degrees)</li><li>long:      Longitude (decimal degrees)</li><li>doy:       day of year (integer starting from 1)</li><li>hour:      hour within the day (0.0 .. 24.0 float)</li></ul><p>optional     </p><ul><li>timezone:  Timezone for doy and hour, defaults to &quot;GMT+x&quot;  nearest to given longitude.</li><li>year: specific year for doy and hour</li></ul><p><strong>Value</strong></p><p>vector of potential radiation (W m-2)</p><p><strong>Examples</strong></p><pre><code class="language- hljs"># assume hours in the GMT+x that is closest to given longitude
potrad = potential_radiation(160, 10.5, 51.0, 11.5)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/potential_radiation.jl#L42-L71">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.pressure_from_elevation" href="#Bigleaf.pressure_from_elevation"><code>Bigleaf.pressure_from_elevation</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">pressure_from_elevation(elev,Tair,VPD=missing;...)</code></pre><p>An estimate of mean pressure at a given elevation as predicted by the              hypsometric equation.</p><p><strong>Arguments</strong></p><ul><li>elev:      Elevation a<em>s</em>l_ (m)</li><li>Tair:      Air temperature (deg C)</li><li>VPD:       Vapor pressure deficit (kPa); optional</li></ul><p>optional </p><ul><li><code>constants=</code><a href="../bigleaf_constants/#Bigleaf.bigleaf_constants"><code>bigleaf_constants</code></a><code>()</code>: Dictionary with entries    Kelvin, pressure0, Rd, g, Pa2kPa</li></ul><p><strong>Details</strong></p><p>Atmospheric pressure is approximated by the hypsometric equation:</p><p><span>$pressure = pressure_0 / (exp(g * elevation / (Rd Temp)))$</span></p><p>The hypsometric equation gives an estimate of the standard pressure       at a given altitude.       If VPD is provided, humidity correction is applied and the       virtual temperature instead of air temperature is used_ VPD is        internally converted to specific humidity.</p><p><strong>Value</strong></p><p>Atmospheric pressure (kPa)</p><p><strong>References</strong></p><p>Stull B_, 1988: An Introduction to Boundary Layer Meteorology.             Kluwer Academic Publishers, Dordrecht, Netherlands.</p><p><strong>Examples</strong></p><pre><code class="language- hljs"># mean pressure at 500m altitude at 25 deg C and VPD of 1 kPa
pressure_from_elevation(500,25,1)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/meteorological_variables.jl#L37-L74">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.psychrometric_constant-Tuple{Any, Any}" href="#Bigleaf.psychrometric_constant-Tuple{Any, Any}"><code>Bigleaf.psychrometric_constant</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">psychrometric_constant(Tair,pressure; ...)</code></pre><p>Computes the psychrometric &#39;constant&#39;.</p><p><strong>Argumens</strong></p><ul><li>Tair:      Air temperature (deg C)</li><li>pressure:  Atmospheric pressure (kPa)</li></ul><p>optional </p><ul><li><code>constants=</code><a href="../bigleaf_constants/#Bigleaf.bigleaf_constants"><code>bigleaf_constants</code></a><code>()</code>: Dictionary with entries    cp, eps</li></ul><p><strong>Details</strong></p><p>The psychrometric constant (<span>$\gamma$</span>) is given as:</p><p><span>$\gamma = cp * pressure / (eps * \lambda)$</span></p><p>where <span>$\lambda$</span> is the latent heat of vaporization (J kg-1),   as calculated from <a href="../metorological_variables/#Bigleaf.latent_heat_vaporization"><code>latent_heat_vaporization</code></a>.</p><p><strong>Value</strong></p><p>the psychrometric constant (kPa K-1)</p><p><strong>References</strong></p><p>Monteith J.L., Unsworth M.H., 2008: Principles of Environmental Physics.             3rd Edition. Academic Press, London.</p><p><strong>Examples</strong></p><pre><code class="language- hljs">psychrometric_constant.(5.0:5.0:25.0, 100)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/meteorological_variables.jl#L88-L119">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.q_to_VPD-Tuple{Any, Any, Any}" href="#Bigleaf.q_to_VPD-Tuple{Any, Any, Any}"><code>Bigleaf.q_to_VPD</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">VPD_to_rH(VPD,Tair; ...)
H_to_VPD(rH,Tair; ...)
e_to_rH(e,Tair; ...)
VPD_to_e(VPD,Tair; ...)
e_to_VPD(e,Tair; ...)
e_to_q(e,pressure; ...)
q_to_e(q,pressure; ...)
q_to_VPD(q,Tair,pressure; ...)
VPD_to_q(VPD,Tair,pressure; ...)</code></pre><p>Conversion between vapor pressure (e), vapor pressure deficit (VPD),              specific humidity (q), and relative humidity (rH).</p><p><strong>Arguments</strong></p><ul><li>Tair:      Air temperature (deg C)</li><li>pressure:  Atmospheric pressure (kPa)</li><li>e:         Vapor pressure (kPa)</li><li>q:        Specific humidity (kg kg-1)</li><li>VPD:       Vapor pressure deficit (kPa)</li><li>rH:        Relative humidity (-)</li></ul><p>All functions accept the optional arguemtns:</p><ul><li><code>Esat_formula</code>: formula used in <a href="../metorological_variables/#Bigleaf.Esat_from_Tair"><code>Esat_from_Tair</code></a></li><li><code>constants</code>: dictionary from <a href="../bigleaf_constants/#Bigleaf.bigleaf_constants"><code>bigleaf_constants</code></a> with entries eps and Pa2kPa</li></ul><p><strong>Rreferences</strong></p><p>Foken, T, 2008: Micrometeorology_ Springer, Berlin, Germany.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/unit_conversions.jl#L153-L182">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.q_to_e-Tuple{Any, Any}" href="#Bigleaf.q_to_e-Tuple{Any, Any}"><code>Bigleaf.q_to_e</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">VPD_to_rH(VPD,Tair; ...)
H_to_VPD(rH,Tair; ...)
e_to_rH(e,Tair; ...)
VPD_to_e(VPD,Tair; ...)
e_to_VPD(e,Tair; ...)
e_to_q(e,pressure; ...)
q_to_e(q,pressure; ...)
q_to_VPD(q,Tair,pressure; ...)
VPD_to_q(VPD,Tair,pressure; ...)</code></pre><p>Conversion between vapor pressure (e), vapor pressure deficit (VPD),              specific humidity (q), and relative humidity (rH).</p><p><strong>Arguments</strong></p><ul><li>Tair:      Air temperature (deg C)</li><li>pressure:  Atmospheric pressure (kPa)</li><li>e:         Vapor pressure (kPa)</li><li>q:        Specific humidity (kg kg-1)</li><li>VPD:       Vapor pressure deficit (kPa)</li><li>rH:        Relative humidity (-)</li></ul><p>All functions accept the optional arguemtns:</p><ul><li><code>Esat_formula</code>: formula used in <a href="../metorological_variables/#Bigleaf.Esat_from_Tair"><code>Esat_from_Tair</code></a></li><li><code>constants</code>: dictionary from <a href="../bigleaf_constants/#Bigleaf.bigleaf_constants"><code>bigleaf_constants</code></a> with entries eps and Pa2kPa</li></ul><p><strong>Rreferences</strong></p><p>Foken, T, 2008: Micrometeorology_ Springer, Berlin, Germany.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/unit_conversions.jl#L153-L182">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.rH_to_VPD-Tuple{Any, Any}" href="#Bigleaf.rH_to_VPD-Tuple{Any, Any}"><code>Bigleaf.rH_to_VPD</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">VPD_to_rH(VPD,Tair; ...)
H_to_VPD(rH,Tair; ...)
e_to_rH(e,Tair; ...)
VPD_to_e(VPD,Tair; ...)
e_to_VPD(e,Tair; ...)
e_to_q(e,pressure; ...)
q_to_e(q,pressure; ...)
q_to_VPD(q,Tair,pressure; ...)
VPD_to_q(VPD,Tair,pressure; ...)</code></pre><p>Conversion between vapor pressure (e), vapor pressure deficit (VPD),              specific humidity (q), and relative humidity (rH).</p><p><strong>Arguments</strong></p><ul><li>Tair:      Air temperature (deg C)</li><li>pressure:  Atmospheric pressure (kPa)</li><li>e:         Vapor pressure (kPa)</li><li>q:        Specific humidity (kg kg-1)</li><li>VPD:       Vapor pressure deficit (kPa)</li><li>rH:        Relative humidity (-)</li></ul><p>All functions accept the optional arguemtns:</p><ul><li><code>Esat_formula</code>: formula used in <a href="../metorological_variables/#Bigleaf.Esat_from_Tair"><code>Esat_from_Tair</code></a></li><li><code>constants</code>: dictionary from <a href="../bigleaf_constants/#Bigleaf.bigleaf_constants"><code>bigleaf_constants</code></a> with entries eps and Pa2kPa</li></ul><p><strong>Rreferences</strong></p><p>Foken, T, 2008: Micrometeorology_ Springer, Berlin, Germany.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/unit_conversions.jl#L153-L182">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.roughness_parameters-Tuple{Val{:canopy_height}, Any}" href="#Bigleaf.roughness_parameters-Tuple{Val{:canopy_height}, Any}"><code>Bigleaf.roughness_parameters</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">roughness_parameters(::Val{:canopy_height}    , zh; frac_d=0.7, frac_z0m=0.1)
roughness_parameters(::Val{:canopy_height_LAI}, zh, LAI; cd=0.2, hs=0.01)
roughness_parameters(::Val{:wind_profile}     , ustar, wind, psi_m; 
  zh, zr, d = 0.7*zh, constants)

roughness_parameters(method::Val{:wind_profile}, utar, wind, Tair, pressure, H; 
  zh, zr, d = 0.7*zh, stab_formulation=Val(:Dyer_1970), constants)
roughness_parameters(method::Val{:wind_profile}, df::DFTable; ...)</code></pre><p>A approximations of the two roughness parameters displacement height (d) and roughness length for momentum (z0m).</p><p><strong>Arguments</strong></p><ul><li><code>zh</code>        : Vegetation height (m)          </li><li><code>constants=</code><a href="../bigleaf_constants/#Bigleaf.bigleaf_constants"><code>bigleaf_constants</code></a><code>()</code>: </li></ul><p>By canopy height:</p><ul><li><code>frac_d</code>    : Fraction of displacement height on canopy height (-)</li><li><code>frac_z0m</code>  : Fraction of roughness length on canopy height (-)</li></ul><p>By canopy height and LAI</p><ul><li><code>LAI</code>       : Leaf area index (-) </li><li><code>cd</code>        : Mean drag coefficient for individual leaves. Defaults to 0.2. </li><li><code>hs</code>        : roughness length of the soil surface (m). </li></ul><p>By wind profile</p><ul><li><code>wind</code>      : Wind speed at height zr (m s-1)</li><li><code>ustar</code>     : Friction velocity (m s-1)</li><li><code>zr</code>        : Instrument (reference) height (m)</li><li><code>d</code>         : Zero-plane displacement height (-)</li><li><code>psi_m</code>     : value of the stability function for heat, see <a href="../stability_correction/#Bigleaf.stability_correction"><code>stability_correction</code></a></li></ul><p>Another variant estimates of <code>psi_m</code> by <a href="../stability_correction/#Bigleaf.stability_correction"><code>stability_correction</code></a>, which requires further input arguments. For convenience, these arguments can be provided using a DataFrame, however, the result then is not type stable.</p><p><strong>Details</strong></p><p>The two main roughness parameters, the displacement height (d) and the roughness length for momentum (z0m) can be estimated from simple empirical relationships with canopy height (zh). If <code>method = Val(:canopy_height)</code>, the following formulas are used:  </p><p><span>$d = frac_d * zh$</span></p><p><span>$z0m = frac_{z0m} * zh$</span></p><p>where <span>$frac_d$</span> defaults to 0.7 and <span>$frac_{z0m}$</span> to 0.1.</p><p>Alternatively, d and z0m can be estimated from both canopy height and LAI (If <code>method = Val(:canopy_height_LAI)</code>). Based on data from Shaw &amp; Pereira 1982, Choudhury &amp; Monteith 1988 proposed  the following semi-empirical relations:</p><p><span>$X = cd * LAI$</span></p><p><span>$d = 1.1 * zh * ln(1 + X^{1/4})$</span> </p><p><span>$z0m = hs + 0.3 * zh * X^{1/2}$</span>   for <span>$0 &lt;= X &lt;= 0.2$</span></p><p><span>$z0m = hs * zh * (1 - d/zh)$</span>   for <span>$0.2 &lt; X$</span> </p><p>If <code>method = Val(:wind_profile)</code>, z0m is estimated by solving the wind speed profile for z0m:</p><p><span>$z0m = median((zr - d) * exp(-k*wind / ustar - psi_m)$</span></p><p>By default, d in this equation is fixed to 0.7*zh, but can be set to any other value.   </p><p><strong>Value</strong></p><p>a NamedTuple with the following components:</p><ul><li><code>d</code>: Zero-plane displacement height (m)</li><li><code>z0m</code>: Roughness length for momentum (m)</li><li><code>z0m_se</code>: Only if <code>method = wind_profile</code>: Standard Error of the median for z0m (m)</li></ul><p><strong>References</strong></p><ul><li>Choudhury, B. J., Monteith J_L., 1988: A four-layer model for the heat budget of homogeneous land surfaces. Q. J. R. Meteorol. Soc. 114, 373-398.</li><li>Shaw, R. H., Pereira, A., 1982: Aerodynamic roughness of a plant canopy:  a numerical experiment. Agricultural Meteorology, 26, 51-65.</li></ul><p><strong>See also</strong></p><p><a href="#Bigleaf.wind_profile"><code>wind_profile</code></a></p><pre><code class="language-julia hljs">using DataFrames
# estimate d and z0m from canopy height for a dense (LAI=5) and open (LAI=2) canopy
zh = 25.0
roughness_parameters(Val(:canopy_height_LAI),zh,5)
roughness_parameters(Val(:canopy_height_LAI),zh,2)   
   
# fix d to 0.7*zh and estimate z0m from the wind profile
df = DataFrame(Tair=[25,25,25],pressure=100,wind=[3,4,5],ustar=[0.5,0.6,0.65],H=200)
roughness_parameters(Val(:wind_profile),df;zh,zr=40,d=0.7*zh)

# assume d = 0.8*zh
rp = roughness_parameters(Val(:wind_profile),df;zh,zr=40,d=0.8*zh)
≈(rp.z0m, 0.55, rtol=0.1)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/surface_roughness.jl#L39-L143">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.roughness_z0h-Tuple{Any, Any}" href="#Bigleaf.roughness_z0h-Tuple{Any, Any}"><code>Bigleaf.roughness_z0h</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">roughness_z0h(z0m, kB_h)</code></pre><p><strong>Arguments</strong></p><ul><li><code>z0m</code> : Roughness length for momentum (m). Can be calculated          by <a href="../surface_roughness/#Bigleaf.roughness_parameters"><code>roughness_parameters</code></a>.</li><li><code>kB_h</code> : kB-1 parameter, Output of <a href="../aerodynamic_conductance/#Bigleaf.aerodynamic_conductance!"><code>aerodynamic_conductance!</code></a>          </li></ul><p><strong>Details</strong></p><p>The roughness length for water and heat (z0h) is calculated from the  relationship (e.g. Verma 1989):</p><p><span>${k_B}_h = ln(z_{0m}/z_{0h})$</span> </p><p>it follows:</p><p><span>$z_{0h} = z_{0m} / e^{k_{B_h}}$</span></p><p><strong>References</strong></p><p>Verma, S., 1989: Aerodynamic resistances to transfers of heat, mass and momentum.   In: Estimation of areal evapotranspiration, IAHS Pub, 177, 13-20.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/aerodynamic_conductance.jl#L131-L152">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.set_datetime_ydh!" href="#Bigleaf.set_datetime_ydh!"><code>Bigleaf.set_datetime_ydh!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">set_datetime_ydh!(df, timezone = tz&quot;UTC+0&quot;; 
    year = df.year, doy = df.doy, hour = df.hour)</code></pre><p>Update column DateTime column datetime according to year, dayOfYear, and fractional hour.</p><p><strong>Value</strong></p><p><code>df</code> with updated or added column <code>:datetime</code> moved to the first position.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/util.jl#L106-L114">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.setinvalid_afterprecip!-Tuple{Any}" href="#Bigleaf.setinvalid_afterprecip!-Tuple{Any}"><code>Bigleaf.setinvalid_afterprecip!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">setinvalid_afterprecip!(df; min_precip = 0.01, hours_after = 24.0)</code></pre><p>Set records after precipitation to false in <code>:valid</code> column.</p><p><strong>Arguments</strong></p><ul><li>df: DataFrame with columns <code>:datetime</code> and <code>:precip</code> sorted by <code>:datetime</code>  in increasing order.</li></ul><p>optional:</p><ul><li><code>min_precip</code> (in mm per timestep): minimum precip to be considered effective precipitation.</li><li><code>hours_after</code>: time after the precipitation event to be considered invalid</li></ul><p><strong>Value</strong></p><p><code>df</code> with modified column <code>:valid</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/filter_data.jl#L275-L290">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.setinvalid_nongrowingseason!-Tuple{Any, Any}" href="#Bigleaf.setinvalid_nongrowingseason!-Tuple{Any, Any}"><code>Bigleaf.setinvalid_nongrowingseason!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">setinvalid_nongrowingseason!(df, tGPP; kwargs...)</code></pre><p>Set non-growseason to false in :valid column.</p><p><strong>Arguments</strong></p><ul><li><code>df</code>: DataFrame with columns <code>:GPP</code> and <code>:datetime</code></li><li><code>tGPP</code>: scalar threshold of daily GPP (see <a href="#Bigleaf.get_growingseason"><code>get_growingseason</code></a>)</li></ul><p>optional:</p><ul><li><code>update_GPPd</code>: set to true additionally update <code>:GPPd_smoothed</code> column to results from <a href="#Bigleaf.get_growingseason"><code>get_growingseason</code></a></li><li>and others passed to <a href="#Bigleaf.get_growingseason"><code>get_growingseason</code></a></li></ul><p><strong>Value</strong></p><p>df with modified columns :valid and if  <code>:GPPd_smoothed</code>,  where all non-growing season records are set to false.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/filter_data.jl#L155-L171">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.setinvalid_qualityflag!-Tuple{Any}" href="#Bigleaf.setinvalid_qualityflag!-Tuple{Any}"><code>Bigleaf.setinvalid_qualityflag!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">setinvalid_qualityflag!(df; 
  vars=[&quot;LE&quot;,&quot;H&quot;,&quot;NEE&quot;,&quot;Tair&quot;,&quot;VPD&quot;,&quot;wind&quot;],
  qc_suffix=&quot;_qc&quot;,
  good_quality_threshold = 1.0,
  missing_qc_as_bad = true,
  setvalmissing = true, 
)</code></pre><p>Set records with quality flags indicating problems to false in :valid column. </p><p><strong>Arguments</strong></p><ul><li>df: DataFrame with column :GPP</li></ul><p>optional</p><ul><li><code>vars=[&quot;LE&quot;,&quot;H&quot;,&quot;NEE&quot;,&quot;Tair&quot;,&quot;VPD&quot;,&quot;wind&quot;]</code>: columns to theck for quality</li><li><code>qc_suffix=&quot;_qc&quot;</code>: naming of the corresponding quality-flag column</li><li><code>good_quality_threshold = 1.0</code>: threshold in quality flag up to which data is considered good quality</li><li><code>missing_qc_as_bad = true</code>: set to false to not mark records with missing  quality flag as invalid</li><li><code>setvalmissing = true</code>: set to false to prevent replacing values in value column  corresponding to problematic quality flag to missing.</li></ul><p><strong>Value</strong></p><p>df with modified :valid and value columns. </p><p><strong>Example</strong></p><pre><code class="language-julia hljs">using DataFrames
df = DataFrame(
  NEE = 1:3, NEE_qc = [1,1,2],
  GPP = 10:10:30, GPP_qc = [1,missing,1])
setinvalid_qualityflag!(df; vars = [&quot;NEE&quot;, &quot;GPP&quot;])
df.valid == [true, false, false]
ismissing(df.GPP[2]) &amp;&amp; ismissing(df.NEE[3])</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/filter_data.jl#L1-L39">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.setinvalid_range!-Union{Tuple{N}, Tuple{Any, Vararg{Pair, N}}} where N" href="#Bigleaf.setinvalid_range!-Union{Tuple{N}, Tuple{Any, Vararg{Pair, N}}} where N"><code>Bigleaf.setinvalid_range!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">setinvalid_range!(df, var_ranges...; setvalmissing = true, ...)</code></pre><p>Set records with values outside specified ranges to false in :valid column. </p><p>If their is no limit towards small or large values, supply <code>-Inf</code> or <code>Inf</code> as the minimum or maximum respectively. If there were false values in the :value column before, they are kept false. In addition, set values outside ranges to missing.</p><p><strong>Arguments</strong></p><ul><li><code>df</code>: DataFrame with column :GPP</li><li><code>var_ranges</code>: Pair <code>Varname_symbol =&gt; (min,max)</code>: closed valid interval for  respective column </li></ul><p>optional</p><ul><li>setvalmissing: set to false to prevent replacing values in value column outside ranges to missing.</li></ul><p><strong>Value</strong></p><p>df with modified :valid and value columns. </p><pre><code class="language-julia hljs">using DataFrames
df = DataFrame(NEE = [missing, 2,3], GPP = 10:10:30)
setinvalid_range!(df, :NEE =&gt; (-2.0,4.0), :GPP =&gt; (8.0,28.0))
df.valid == [false, true, false]
ismissing(df.GPP[3])</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/filter_data.jl#L95-L123">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.stability_correction-Tuple{Any}" href="#Bigleaf.stability_correction-Tuple{Any}"><code>Bigleaf.stability_correction</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">stability_correction(zeta; 
  stab_formulation=Val(:Dyer_1970))
stability_correction(z,d, Tair,pressure,ustar,H; constants,
  stab_formulation=Val(:Dyer_1970))
stability_correction!(df; zeta, z, d; 
  stab_formulation=Val(:Dyer_1970), constants = bigleaf_constants())</code></pre><p>Integrated Stability Correction Functions for Heat and Momentum</p><p><strong>Arguments</strong></p><ul><li><code>zeta</code>             : Stability parameter zeta (-)</li><li><code>Tair</code>,<code>pressure</code>,<code>ustar</code>,<code>H</code> : see <a href="../stability_correction/#Bigleaf.Monin_Obukhov_length"><code>Monin_Obukhov_length</code></a></li><li><code>z</code>,<code>d</code>            : see <a href="../stability_correction/#Bigleaf.stability_parameter"><code>stability_parameter</code></a></li><li><code>df</code>  : DataFrame containting the variables required by <a href="../stability_correction/#Bigleaf.Monin_Obukhov_length"><code>Monin_Obukhov_length</code></a></li><li><code>stab_formulation</code> : Formulation for the stability function. Either            <code>Val(:Dyer_1970)</code>, or <code>Val(:Businger_1971)</code> or <code>Val(:no_stability_correction)</code></li></ul><p>In the second and third form computes <code>zeta</code> by <a href="../stability_correction/#Bigleaf.stability_parameter"><code>stability_parameter</code></a> and <a href="../stability_correction/#Bigleaf.Monin_Obukhov_length"><code>Monin_Obukhov_length</code></a> and requires respective arguments.</p><p><strong>Details</strong></p><p>These dimensionless values are needed to correct deviations from the exponential wind profile under non-neutral conditions. The functions give the integrated form of the universal functions. They depend on the value of the stability parameter <span>$\zeta$</span>, a function of heigh <code>z</code>, which can be calculated from the function <a href="../stability_correction/#Bigleaf.stability_parameter"><code>stability_parameter</code></a>. The integration of the universal functions is:</p><p><span>$\psi = -x * zeta$</span> </p><p>for stable atmospheric conditions (<span>$\zeta$</span> &gt;= 0), and</p><p><span>$\psi = 2 * log( (1 + y(zeta)) / 2)$</span></p><p>for unstable atmospheric conditions (<span>$\zeta$</span> &lt; 0).</p><p>The different formulations differ in their value of x and y.</p><p><strong>Value</strong></p><p>a NamedTuple with the following columns:</p><ul><li><code>psi_h</code>: the value of the stability function for heat and water vapor (-)</li><li><code>psi_m</code>: the value of the stability function for momentum (-)</li></ul><p><strong>References</strong></p><ul><li>Dyer, A_J., 1974: A review of flux-profile relationships.  Boundary-Layer Meteorology 7, 363-372.</li><li>Dyer, A. J., Hicks, B_B., 1970: Flux-Gradient relationships in the constant flux layer. Quart. J. R. Meteorol. Soc. 96, 715-721.</li><li>Businger, J_A., Wyngaard, J. C., Izumi, I., Bradley, E. F., 1971: Flux-Profile relationships in the atmospheric surface layer.  J. Atmospheric Sci. 28, 181-189.</li><li>Paulson, C_A., 1970: The mathematical representation of wind speed and temperature profiles in the unstable atmospheric surface layer. Journal of Applied Meteorology 9, 857-861. Foken, T, 2008: Micrometeorology. Springer, Berlin, Germany.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">using DataFrames
zeta = -2:0.5:0.5
df2 = DataFrame(stability_correction.(zeta; stab_formulation=Val(:Businger_1971)))                         
propertynames(df2) == [:psi_h, :psi_m]</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/stability_correction.jl#L129-L196">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.stability_parameter-Tuple{Any, Any, Any}" href="#Bigleaf.stability_parameter-Tuple{Any, Any, Any}"><code>Bigleaf.stability_parameter</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">stability_parameter(z,d,MOL)
stability_parameter(z,d,Tair, pressure, ustar, H; constants)
stability_parameter!(df::AbstractDataFrame; z,d, MOL=nothing, constants)</code></pre><p>calculates stability parameter &quot;zeta&quot;, a parameter characterizing stratification in the  lower atmosphere.</p><p><strong>Arguments</strong></p><ul><li><code>z</code>   : height (m)</li><li><code>d</code>   : Zero-plane displacement height (m)</li><li><code>MOL</code> : Monin-Obukhov-length L (m)</li><li><code>df</code>  : DataFrame containting the variables required by <a href="../stability_correction/#Bigleaf.Monin_Obukhov_length"><code>Monin_Obukhov_length</code></a></li></ul><p>optional</p><ul><li><code>constants=</code><a href="../bigleaf_constants/#Bigleaf.bigleaf_constants"><code>bigleaf_constants</code></a><code>()</code></li></ul><p>In the second variant and if <code>MOL=nothing</code> in the DataFrame variants, MOL is computed by  <a href="../stability_correction/#Bigleaf.Monin_Obukhov_length"><code>Monin_Obukhov_length</code></a>.</p><p><strong>Details</strong></p><p>The stability parameter <span>$\zeta$</span> is given by:</p><p><span>$\zeta = (z - d) / L$</span></p><p>where L is the Monin-Obukhov length (m), calculated by <a href="../stability_correction/#Bigleaf.Monin_Obukhov_length"><code>Monin_Obukhov_length</code></a>. The displacement height can  be estimated from the function <a href="../surface_roughness/#Bigleaf.roughness_parameters"><code>roughness_parameters</code></a>.</p><p><strong>Value</strong></p><p><span>$\zeta$</span>: stability parameter (-). The nonmutainting DataFrame variant returns a vector. The mutating variant modifies or adds column [<code>:zeta</code>].</p><pre><code class="language-julia hljs">using DataFrames
df = DataFrame(Tair=25, pressure=100, ustar=0.2:0.1:1.0, H=40:20:200)
z=40;d=15
zeta = stability_parameter.(z,d, df.Tair, df.pressure, df.ustar, df.H)
all(zeta .&lt; 0)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/stability_correction.jl#L63-L104">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.surface_conductance-Tuple{Val{:FluxGradient}, Any, Any, Any, Any}" href="#Bigleaf.surface_conductance-Tuple{Val{:FluxGradient}, Any, Any, Any, Any}"><code>Bigleaf.surface_conductance</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">  surface_conductance(::Val{:FluxGradient},   Tair,pressure,VPD,LE; constants)
  surface_conductance(::Val{:PenmanMonteith}, Tair,pressure,VPD,LE,Rn,Ga_h; 
        G = 0.0, S = 0.0, Esat_formula=Val(:Sonntag_1990), constants)

  surface_conductance!(df, method::Val{:FluxGradient}; kwargs...)
  surface_conductance!(df, method::Val{:PenmanMonteith}; G = 0.0, S = 0.0, kwargs...)</code></pre><p>Calculate surface conductance to water vapor from the inverted Penman-Monteith equation  or from a simple flux-gradient approach.</p><p><strong>Arguments</strong></p><ul><li><code>Tair</code>      : Air temperature (deg C)</li><li><code>pressure</code>  : Atmospheric pressure (kPa)</li><li><code>Rn</code>        : Net radiation (W m-2)</li><li><code>df</code>        : DataFrame with above variables</li><li><code>constants=</code><a href="../bigleaf_constants/#Bigleaf.bigleaf_constants"><code>bigleaf_constants</code></a><code>()</code>: Dictionary with physical constants</li></ul><p>additional for PenmanMonteith</p><ul><li><code>LE</code>        : Latent heat flux (W m-2)</li><li><code>VPD</code>       : Vapor pressure deficit (kPa)</li><li><code>Ga_h</code>      : Aerodynamic conductance towater vapor (m s-1), assumed equal to that of heat</li><li><code>G=0.0</code>     : Ground heat flux (W m-2), defaults to zero</li><li><code>S=0.0</code>     : Sum of all storage fluxes (W m-2), defaults to zero</li><li><code>Esat_formula=Val(:Sonntag_1990)</code>: formula used in <a href="../metorological_variables/#Bigleaf.Esat_from_Tair"><code>Esat_from_Tair</code></a></li></ul><p><strong>Details</strong></p><p>For <code>Val(:PenmanMonteith)</code>, surface conductance (Gs) in m s-1  is calculated from the inverted Penman-Monteith equation:</p><p><span>$G_s = ( LE \. G_a \, \gamma ) / ( \Delta \, A + \rho \, c_p \, G_a \, VPD -  LE \, (\Delta + \gamma ))$</span></p><p>Where <span>$\gamma$</span> is the psychrometric constant (kPa K-1), <span>$\Delta$</span> is the slope of the  saturation vapor pressure curve (kPa K^-1), and <span>$\rho$</span> is air density (kg m-3). Available energy (A) is defined as <span>$A = R_n - G - S$</span>. </p><p>Ground heat flux and total storage flux can be provided as scalars or vectors of the lenght of the DataFrame in the DataFrame variant. While the bigleaf R package by default converts any missings in <code>G</code> and <code>S</code> to 0, in <code>Bigleaf.jl</code> the caller must take care, e.g. by using <code>G = coalesce(myGvector, 0.0)</code>.</p><p>For <code>Val(:FluxGradient)</code>, Gs (in mol m-2 s-1) is calculated from VPD and ET only:</p><p><span>$Gs = ET/p \, VPD$</span></p><p>where ET is in mol m-2 s-1 and p is pressure.  Note that this formulation assumes fully coupled conditions (i.e. Ga = inf). This formulation is equivalent to the inverted form of Eq.6 in McNaughton &amp; Black 1973:</p><p><span>$Gs = LE \, \gamma / (\rho \, c_p \, VPD)$</span></p><p>which gives Gs in m s-1. Note that Gs &gt; Gc (canopy conductance) under conditions  when a significant fraction of ET comes from interception or soil evaporation. </p><p>If <code>pressure</code> is not available, it can be approximated by elevation using the  function <a href="../metorological_variables/#Bigleaf.pressure_from_elevation"><code>pressure_from_elevation</code></a></p><p><strong>Value</strong></p><p>NamedTuple with entries: </p><ul><li>Gs_ms: Surface conductance in m s-1</li><li>Gs_mol: Surface conductance in mol m-2 s-1</li></ul><p><strong>References</strong></p><ul><li>Monteith, J., 1965: Evaporation and environment. In Fogg, G. E. (Ed.), The state and movement of water in living organisms (pp.205-234). 19th Symp. Soc. Exp. Biol., Cambridge University Press, Cambridge</li><li>McNaughton, K<em>G., Black, T</em>A., 1973: A study of evapotranspiration from a Douglas Fir forest using the energy balance approach. Water Resources Research 9, 1579-1590.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">Tair,pressure,VPD,LE,Rn,Ga_h,G = (14.8, 97.7, 1.08, 183.0, 778.0, 0.116, 15.6)
Gs = surface_conductance(Val(:PenmanMonteith), Tair,pressure,VPD,LE,Rn,Ga_h;G)
isapprox(Gs.Gs_mol, 0.28, atol=0.1)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/surface_conductance.jl#L1-L80">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.umolCO2_to_gC-Tuple{Any}" href="#Bigleaf.umolCO2_to_gC-Tuple{Any}"><code>Bigleaf.umolCO2_to_gC</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">umolCO2_to_gC(CO2_flux; constants=bigleaf_constants())
gC_to_umolCO2(C_flux; constants=bigleaf_constants())</code></pre><p>Convert CO2 quantities from (umol CO2 m-2 s-1) to (g C m-2 d-1) and vice versa.</p><p><strong>Arguments</strong></p><ul><li>CO2_flux  CO2 flux (umol CO2 m-2 s-1)</li><li>C_flux    Carbon (C) flux (gC m-2 d-1)</li><li><code>constants</code>: dictionary from <a href="../bigleaf_constants/#Bigleaf.bigleaf_constants"><code>bigleaf_constants</code></a> with entries: Cmol, umol2mol, mol2umol, kg2g, g2kg, says2seconds</li></ul><p><strong>Examples</strong></p><pre><code class="language- hljs">umolCO2_to_gC(20)  # gC m-2 d-1</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/unit_conversions.jl#L279-L296">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.virtual_temp-Tuple{Any, Any, Any}" href="#Bigleaf.virtual_temp-Tuple{Any, Any, Any}"><code>Bigleaf.virtual_temp</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">virtual_temp(Tair,pressure,VPD; ...)</code></pre><p>Virtual temperature, defined as the temperature at which dry air would have the same              density as moist air at its actual temperature.</p><p><strong>Arguments</strong></p><ul><li><code>Tair</code>:      Air temperature (deg C)</li><li><code>pressure</code>:  Atmospheric pressure (kPa)</li><li><code>VPD</code>:       Vapor pressure deficit (kPa)</li><li><code>Esat_formula</code>: formula used in <a href="../metorological_variables/#Bigleaf.Esat_from_Tair"><code>Esat_from_Tair</code></a></li></ul><p>optional </p><ul><li><code>constants=</code><a href="../bigleaf_constants/#Bigleaf.bigleaf_constants"><code>bigleaf_constants</code></a><code>()</code>: Dictionary with entries <ul><li>:Kelvin - conversion degree Celsius to Kelvin</li><li>:eps - ratio of the molecular weight of water vapor to dry air (-) </li></ul></li></ul><p><strong>Details</strong></p><p>The virtual temperature is given by:</p><p><code>Tv = Tair / (1 - (1 - eps) e/pressure)</code></p><p>where Tair is in Kelvin (converted internally)_ Likewise, VPD is converted   to actual vapor pressure (e in kPa) with <a href="../unit_conversions/#Bigleaf.VPD_to_e"><code>VPD_to_e</code></a> internally.</p><p><strong>Value</strong></p><p>virtual temperature (deg C)</p><p><strong>References</strong></p><ul><li>Monteith J.L., Unsworth M.H., 2008: Principles of Environmental Physics.           3rd edition. Academic Press, London.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">Tair,pressure,VPD = 25,100,1.5
vt = virtual_temp(Tair,pressure,VPD)  
≈(vt, 26.9, atol =0.1)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/meteorological_variables.jl#L273-L312">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.wetbulb_temp-Tuple{Any, Any, Any}" href="#Bigleaf.wetbulb_temp-Tuple{Any, Any, Any}"><code>Bigleaf.wetbulb_temp</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">wetbulb_temp(Tair, pressure, VPD; ...)</code></pre><p>Calculate the wet bulb temperature, i<em>e</em> the temperature              that the air would have if it was saturated</p><p><strong>Arguments</strong></p><ul><li>Tair:      Air temperature (deg C)</li><li>pressure:  Atmospheric pressure (kPa)</li><li>VPD:       Vapor pressure deficit (kPa)</li></ul><p>optional</p><ul><li>accuracy:  Accuracy of the result (deg C)</li><li><code>Esat_formula</code>: formula used in <a href="../metorological_variables/#Bigleaf.Esat_from_Tair"><code>Esat_from_Tair</code></a></li><li><code>constants=</code><a href="../bigleaf_constants/#Bigleaf.bigleaf_constants"><code>bigleaf_constants</code></a><code>()</code>: Dictionary with entries     cp, eps,Pa2kPa</li></ul><p><strong>Details</strong></p><p>Wet-bulb temperature (Tw) is calculated from the following expression:</p><p><span>$e = Esat(Tw) - gamma* (Tair - Tw)$</span></p><p>The equation is optimized for Tw. Actual vapor pressure e (kPa) is calculated from VPD using <a href="../unit_conversions/#Bigleaf.VPD_to_e"><code>VPD_to_e</code></a>. The psychrometric constant gamma (kPa K-1) is calculated using <a href="../metorological_variables/#Bigleaf.psychrometric_constant"><code>psychrometric_constant</code></a>.</p><p><strong>Value</strong></p><p>wet-bulb temperature (degC)</p><p><strong>References</strong></p><p>Monteith J.L., Unsworth M.H., 2008: Principles of Environmental Physics.             3rd edition. Academic Press, London.</p><p><strong>Examples</strong></p><pre><code class="language- hljs">wetbulb_temp.([20,25.0], 100, [1,1.6])             </code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/meteorological_variables.jl#L156-L193">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.wetbulb_temp_from_e_Tair_gamma-Tuple{Any, Any, Any}" href="#Bigleaf.wetbulb_temp_from_e_Tair_gamma-Tuple{Any, Any, Any}"><code>Bigleaf.wetbulb_temp_from_e_Tair_gamma</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">wetbulb_temp(Tair, pressure, VPD; ...)</code></pre><p>Calculate the wet bulb temperature, i<em>e</em> the temperature              that the air would have if it was saturated</p><p><strong>Arguments</strong></p><ul><li>Tair:      Air temperature (deg C)</li><li>pressure:  Atmospheric pressure (kPa)</li><li>VPD:       Vapor pressure deficit (kPa)</li></ul><p>optional</p><ul><li>accuracy:  Accuracy of the result (deg C)</li><li><code>Esat_formula</code>: formula used in <a href="../metorological_variables/#Bigleaf.Esat_from_Tair"><code>Esat_from_Tair</code></a></li><li><code>constants=</code><a href="../bigleaf_constants/#Bigleaf.bigleaf_constants"><code>bigleaf_constants</code></a><code>()</code>: Dictionary with entries     cp, eps,Pa2kPa</li></ul><p><strong>Details</strong></p><p>Wet-bulb temperature (Tw) is calculated from the following expression:</p><p><span>$e = Esat(Tw) - gamma* (Tair - Tw)$</span></p><p>The equation is optimized for Tw. Actual vapor pressure e (kPa) is calculated from VPD using <a href="../unit_conversions/#Bigleaf.VPD_to_e"><code>VPD_to_e</code></a>. The psychrometric constant gamma (kPa K-1) is calculated using <a href="../metorological_variables/#Bigleaf.psychrometric_constant"><code>psychrometric_constant</code></a>.</p><p><strong>Value</strong></p><p>wet-bulb temperature (degC)</p><p><strong>References</strong></p><p>Monteith J.L., Unsworth M.H., 2008: Principles of Environmental Physics.             3rd edition. Academic Press, London.</p><p><strong>Examples</strong></p><pre><code class="language- hljs">wetbulb_temp.([20,25.0], 100, [1,1.6])             </code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/meteorological_variables.jl#L156-L193">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bigleaf.wind_profile-Tuple{Number, Union{Missing, Number}, Any, Any, Any}" href="#Bigleaf.wind_profile-Tuple{Number, Union{Missing, Number}, Any, Any, Any}"><code>Bigleaf.wind_profile</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">wind_profile(z::Number, ustar, d, z0m, psi_m = zero(z); constants)
wind_profile(z, df::AbstractDataFrame, d, z0m, psi_m::AbstractVector; constants)
wind_profile(z, df::DFTable, d, z0m; psi_m = nothing,
  stab_formulation = Val(:Dyer_1970), constants)</code></pre><p>Wind speed at a given height above the canopy estimated from single-level measurements of wind speed.</p><p><strong>Arguments</strong></p><ul><li><code>z</code>         : Height above ground for which wind speed is calculated.</li><li><code>ustar</code>     : Friction velocity (m s-1)</li><li><code>d</code>         : Zero-plane displacement height (-)</li><li><code>z0m</code>       : Roughness length (m)</li><li><code>constants=</code><a href="../bigleaf_constants/#Bigleaf.bigleaf_constants"><code>bigleaf_constants</code></a><code>()</code></li></ul><p>For DataFrame variant with supplying stability_parameter</p><ul><li><code>df</code>:         : DataFrame with columns <ul><li><code>ustar</code>     : Friction velocity (m s-1)</li></ul></li><li><code>psi_m</code>     : value of the stability function for heat, see <a href="../stability_correction/#Bigleaf.stability_correction"><code>stability_correction</code></a> Pass <code>psi_m = 0.0</code> to neglect stability correction.</li></ul><p>For DataFrame varinat where psi_m is to be estimated</p><ul><li>additional columns in <code>df</code>:<ul><li><code>Tair</code>, <code>pressure</code>, <code>H</code> : see <a href="../stability_correction/#Bigleaf.stability_correction"><code>stability_correction</code></a></li></ul></li></ul><p><strong>Details</strong></p><p>The underlying assumption is the existence of a logarithmic wind profile above the height d + z0m (the height at which wind speed mathematically reaches zero according to the Monin-Obhukov similarity theory). In this case, the wind speed at a given height z is given by:</p><p><span>$u(z) = (ustar/k) * (ln((z - d) / z0m) - \psi_m$</span></p><p>The roughness parameters zero-plane displacement height (d) and roughness length (z0m) can be approximated from <a href="#Bigleaf.roughness_parameters"><code>roughness_parameters</code></a>.  <span>$\psi_m$</span> is the stability correction. Set it to zero (not recommended) to neglect statbility correction. By default it is estimated from wind profile using <a href="../stability_correction/#Bigleaf.stability_correction"><code>stability_correction</code></a></p><p><strong>Note</strong></p><p>Note that this equation is only valid for z &gt;= d + z0m, and it is not  meaningful to calculate values closely above d + z0m. All values in <code>heights</code> smaller than d + z0m will return 0. </p><p><strong>Value</strong></p><p>wind speed at given height <code>z</code>. </p><p><strong>References</strong></p><ul><li>Monteith, J<em>L., Unsworth, M</em>H., 2008: Principles of Environmental Physics. 3rd edition. Academic Press, London. </li><li>Newman, J<em>F., Klein, P</em>M., 2014: The impacts of atmospheric stability on the accuracy of wind speed extrapolation methods. Resources 3, 81-105.</li></ul><p><strong>See also</strong></p><p><a href="#Bigleaf.roughness_parameters"><code>roughness_parameters</code></a></p><pre><code class="language-julia hljs">using DataFrames
heights = 18:2:40  # heights above ground for which to calculate wind speed
df = DataFrame(Tair=25,pressure=100,wind=[3,4,5],ustar=[0.5,0.6,0.65],H=[200,230,250]) 
zr=40;zh=25;d=16
# z0m and MOL are independent of height, compute before
MOL = Monin_Obukhov_length.(df.Tair, df.pressure, df.ustar, df.H)
z0m = roughness_parameters(
  Val(:wind_profile), df.ustar, df.wind, df.Tair, df.pressure, df.H; zh, zr).z0m 
ws = map(heights) do z
  wind_profile(z,df,d,z0m; MOL)
end
using Plots # plot wind profiles for the three rows in df
plot(first.(ws), heights, ylab = &quot;height (m)&quot;, xlab = &quot;wind speed (m/s)&quot;, legend=:topleft)
plot!(getindex.(ws, 2), heights)
plot!(getindex.(ws, 3), heights)
nothing
# output</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/Bigleaf.jl/blob/84cf017af90e93570ceaa3314cc90d1ba89f81eb/src/surface_roughness.jl#L201-L277">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../filter_data/">« -</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.10 on <span class="colophon-date" title="Monday 15 November 2021 08:25">Monday 15 November 2021</span>. Using Julia version 1.6.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
